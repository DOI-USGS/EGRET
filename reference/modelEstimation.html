<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This one function does three things. 
1) a jack-knife cross-validation of a WRTDS model in which it augments the Sample data frame in the eList,
2) fits the WRTDS model creating the surfaces matrix and places it in the eList
(the surfaces matrix expresses the estimated concentration as a function of discharge and time), and 
3) estimates the daily values of concentration and flux, and flow normalized concentration and 
flux and places these in the Daily data frame in the eList. 
It returns a named list with the following dataframes: Daily, INFO, Sample, and the matrix: surfaces."><title>Estimation process for the WRTDS (Weighted Regressions on Time, Discharge, and Season) — modelEstimation • EGRET</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Estimation process for the WRTDS (Weighted Regressions on Time, Discharge, and Season) — modelEstimation"><meta property="og:description" content="This one function does three things. 
1) a jack-knife cross-validation of a WRTDS model in which it augments the Sample data frame in the eList,
2) fits the WRTDS model creating the surfaces matrix and places it in the eList
(the surfaces matrix expresses the estimated concentration as a function of discharge and time), and 
3) estimates the daily values of concentration and flux, and flow normalized concentration and 
flux and places these in the Daily data frame in the eList. 
It returns a named list with the following dataframes: Daily, INFO, Sample, and the matrix: surfaces."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://www.usgs.gov/" class="external-link"><img src="logo.png" id="logo" alt="Home" style="padding: 0px 50px 0px 0px;"></a>
    <a class="navbar-brand me-2" href="../index.html">EGRET</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.7.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Overview.html">Overview and Updates</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/EGRET.html">Introduction</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Help Pages</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Enhancements.html">Enhancements</a>
    <a class="dropdown-item" href="../articles/WRTDSK.html">WRTDS Kalman</a>
    <a class="dropdown-item" href="../articles/parallel.html">Running in Parallel</a>
    <a class="dropdown-item" href="../articles/rResid.html">Random Residuals</a>
    <a class="dropdown-item" href="../articles/SeasonalFraction.html">Seasonal Analysis</a>
    <a class="dropdown-item" href="../articles/streamflow_trend.html">Daily Streamflow Trends</a>
    <a class="dropdown-item" href="../articles/TrendsByMonth.html">Trends by month</a>
    <a class="dropdown-item" href="../articles/AlternativeQMethod.html">Alternative Q Method</a>
    <a class="dropdown-item" href="../articles/Annual_Hydrograph_Timing.html">Annual_Hydrograph_Timing</a>
    <a class="dropdown-item" href="../articles/units.html">Custom Units</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/References_WRTDS.html">Bibliograpy</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://code.usgs.gov/water/EGRET">
    <span class="fa fa-gitlab fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimation process for the WRTDS (Weighted Regressions on Time, Discharge, and Season)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/EGRET/blob/HEAD/R/modelEstimation.R" class="external-link"><code>R/modelEstimation.R</code></a></small>
      <div class="d-none name"><code>modelEstimation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This one function does three things. 
1) a jack-knife cross-validation of a WRTDS model in which it augments the Sample data frame in the eList,
2) fits the WRTDS model creating the surfaces matrix and places it in the eList
(the surfaces matrix expresses the estimated concentration as a function of discharge and time), and 
3) estimates the daily values of concentration and flux, and flow normalized concentration and 
flux and places these in the Daily data frame in the eList. 
It returns a named list with the following dataframes: Daily, INFO, Sample, and the matrix: surfaces.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelEstimation</span><span class="op">(</span><span class="va">eList</span>, windowY <span class="op">=</span> <span class="fl">7</span>, windowQ <span class="op">=</span> <span class="fl">2</span>, windowS <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  minNumObs <span class="op">=</span> <span class="fl">100</span>, minNumUncen <span class="op">=</span> <span class="fl">50</span>, edgeAdjust <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  run.parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>eList</dt>
<dd><p>named list with at least the INFO, Daily, and Sample dataframes</p></dd>


<dt>windowY</dt>
<dd><p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p></dd>


<dt>windowQ</dt>
<dd><p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p></dd>


<dt>windowS</dt>
<dd><p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p></dd>


<dt>minNumObs</dt>
<dd><p>numeric specifying the minimum number of observations required to run the weighted regression, default is 100</p></dd>


<dt>minNumUncen</dt>
<dd><p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p></dd>


<dt>edgeAdjust</dt>
<dd><p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p></dd>


<dt>verbose</dt>
<dd><p>logical specifying whether or not to display progress message</p></dd>


<dt>run.parallel</dt>
<dd><p>logical to run WRTDS in parallel or not</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>eList named list with INFO, Daily, and Sample dataframes, along with the surfaces matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="va">Choptank_eList</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu">modelEstimation</span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  first step running estCrossVal may take about 1 minute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  estCrossVal % complete:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 	1 	2 	3 	4 	5 	6 	7 	8 	9 	10 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 	12 	13 	14 	15 	16 	17 	18 	19 	20 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 	22 	23 	24 	25 	26 	27 	28 	29 	30 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 	32 	33 	34 	35 	36 	37 	38 	39 	40 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 	42 	43 	44 	45 	46 	47 	48 	49 	50 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 	52 	53 	54 	55 	56 	57 	58 	59 	60 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 	62 	63 	64 	65 	66 	67 	68 	69 	70 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 	72 	73 	74 	75 	76 	77 	78 	79 	80 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 	82 	83 	84 	85 	86 	87 	88 	89 	90 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 	92 	93 	94 	95 	96 	97 	98 	99 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Next step running  estSurfaces with survival regression:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Survival regression (% complete):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 	1 	2 	3 	4 	5 	6 	7 	8 	9 	10 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 	12 	13 	14 	15 	16 	17 	18 	19 	20 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 	22 	23 	24 	25 	26 	27 	28 	29 	30 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 	32 	33 	34 	35 	36 	37 	38 	39 	40 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 	42 	43 	44 	45 	46 	47 	48 	49 	50 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 	52 	53 	54 	55 	56 	57 	58 	59 	60 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 	62 	63 	64 	65 	66 	67 	68 	69 	70 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 	72 	73 	74 	75 	76 	77 	78 	79 	80 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 	82 	83 	84 	85 	86 	87 	88 	89 	90 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 	92 	93 	94 	95 	96 	97 	98 	99 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Survival regression: Done</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer></footer></div> <!-- / div for your main content-->

<!-- BEGIN USGS Footer Template -->

<footer class="footer"><div class="tmp-container">
		<!-- .footer-wrap -->
			<!-- .footer-doi -->
			<div class="footer-doi">
				<!-- footer nav links -->
				<ul class="menu nav"><li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/privacy" class="external-link">DOI Privacy Policy</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/policies-and-notices" class="external-link">Legal</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/accessibility-and-us-geological-survey" class="external-link">Accessibility</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/sitemap" class="external-link">Site Map</a></li>
					<li class="last leaf menu-links menu-level-1"><a href="https://answers.usgs.gov/" class="external-link">Contact USGS</a></li>
				</ul><!--/ footer nav links --></div>
			<!-- /.footer-doi -->

			<hr><!-- .footer-utl-links --><div class="footer-doi">
			<ul class="menu nav"><li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/" class="external-link">U.S. Department of the Interior</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doioig.gov/" class="external-link">DOI Inspector General</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/" class="external-link">White House</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/omb/management/egov/" class="external-link">E-gov</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doi.gov/pmb/eeo/no-fear-act" class="external-link">No Fear Act</a></li>
				<li class="last leaf menu-links menu-level-1"><a href="https://www.usgs.gov/about/organization/science-support/foia" class="external-link">FOIA</a></li>
			</ul></div>			
		<!-- /.footer-utl-links -->
		<!-- .footer-social-links -->
		<div class="footer-social-links">
			<ul class="social"><li class="follow">Follow</li>
				<li class="twitter">
					<a href="https://twitter.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-twitter-square"><span class="only">Twitter</span></i>
					</a>
				</li>
				<li class="facebook">
					<a href="https://facebook.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-facebook-square"><span class="only">Facebook</span></i>
					</a>
				</li>
				<li class="github">
					<a href="https://github.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-github"><span class="only">GitHub</span></i>
					</a>
				</li>
				<li class="flickr">
					<a href="https://flickr.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-flickr"><span class="only">Flickr</span></i>
					</a>
				</li>
				<li class="youtube">
					<a href="http://youtube.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-youtube-play"><span class="only">YouTube</span></i>
					</a>
				</li>
				<li class="instagram">
					<a href="https://instagram.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-instagram"><span class="only">Instagram</span></i>
					</a>
				</li>
			</ul></div>
		<!-- /.footer-social-links -->
	</div>
		<!-- /.footer-wrap -->	
</footer><!-- END USGS Footer Template- --><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKQR8KP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
  </body><!-- closing div for body --></html>

