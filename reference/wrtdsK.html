<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>WRTDS-Kalman — WRTDSKalman • EGRET</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="WRTDS-Kalman — WRTDSKalman" />
<meta property="og:description" content="Thi function uses an autoregressive model to produce more accurate 
estimates of concentration and flux" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRET</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.5.0001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Overview.html">Overview and Updates</a>
</li>
<li>
  <a href="../articles/EGRET.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function Help Pages</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Enhancements.html">Enhancements</a>
    </li>
    <li>
      <a href="../articles/WRTDSK.html">WRTDS Kalman</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running in Parallel</a>
    </li>
    <li>
      <a href="../articles/rResid.html">Random Residuals</a>
    </li>
    <li>
      <a href="../articles/SeasonalFraction.html">Seasonal Analysis</a>
    </li>
    <li>
      <a href="../articles/streamflow_trend.html">Daily Streamflow Trends</a>
    </li>
    <li>
      <a href="../articles/TrendsByMonth.html">Trends by month</a>
    </li>
    <li>
      <a href="../articles/AlternativeQMethod.html">Alternative Q Method</a>
    </li>
    <li>
      <a href="../articles/Annual_Hydrograph_Timing.html">Annual_Hydrograph_Timing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/References_WRTDS.html">Bibliograpy</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/EGRET">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>WRTDS-Kalman</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/EGRET/blob/master/R/kalman_functions.R'><code>R/kalman_functions.R</code></a></small>
    <div class="hidden name"><code>wrtdsK.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Thi function uses an autoregressive model to produce more accurate 
estimates of concentration and flux</p>
    </div>

    <pre class="usage"><span class='fu'>WRTDSKalman</span><span class='op'>(</span><span class='va'>eList</span>, rho <span class='op'>=</span> <span class='fl'>0.9</span>, niter <span class='op'>=</span> <span class='fl'>200</span>, seed <span class='op'>=</span> <span class='cn'>NA</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eList</th>
      <td><p>named list with the INFO, Daily, and Sample dataframes and surfaces matrix</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>numeric the lag one autocorrelation. Default is 0.9.</p></td>
    </tr>
    <tr>
      <th>niter</th>
      <td><p>number of iterations. Default is 200.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>integer value. Defaults to NA, which will not change the current seed.
Setting the seed to any given value can be used to create repeatable output.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical specifying whether or not to display progress message</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes an existing eList 
Including the estimated model (the surfaces object in the eList)
And produces the daily WRTDSKalman estimates of concentration and flux
These generated estimates are called genConc and genFlux</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>eList</span> <span class='op'>&lt;-</span> <span class='va'>Choptank_eList</span>
<span class='va'>eList</span> <span class='op'>&lt;-</span> <span class='fu'>WRTDSKalman</span><span class='op'>(</span><span class='va'>eList</span>, niter <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; % complete:
#&gt; 10 	
#&gt; 20 	
#&gt; 30 	
#&gt; 40 	
#&gt; 50 	
#&gt; 60 	
#&gt; 70 	
#&gt; 80 	
#&gt; 90 	
#&gt; 100 	</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>eList</span><span class='op'>$</span><span class='va'>Daily</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Date                  Q                 Julian          Month       
#&gt;  Min.   :1979-10-01   Min.   :  0.00991   Min.   :47389   Min.   : 1.000  
#&gt;  1st Qu.:1987-09-30   1st Qu.:  0.93446   1st Qu.:50311   1st Qu.: 4.000  
#&gt;  Median :1995-09-30   Median :  2.40693   Median :53233   Median : 7.000  
#&gt;  Mean   :1995-09-30   Mean   :  4.08658   Mean   :53233   Mean   : 6.523  
#&gt;  3rd Qu.:2003-09-30   3rd Qu.:  4.61565   3rd Qu.:56154   3rd Qu.:10.000  
#&gt;  Max.   :2011-09-30   Max.   :246.35656   Max.   :59076   Max.   :12.000  
#&gt;                                                                           
#&gt;       Day           DecYear        MonthSeq     Qualifier        
#&gt;  Min.   :  1.0   Min.   :1980   Min.   :1558   Length:11688      
#&gt;  1st Qu.: 93.0   1st Qu.:1988   1st Qu.:1654   Class :character  
#&gt;  Median :184.0   Median :1996   Median :1750   Mode  :character  
#&gt;  Mean   :183.8   Mean   :1996   Mean   :1749                     
#&gt;  3rd Qu.:275.0   3rd Qu.:2004   3rd Qu.:1845                     
#&gt;  Max.   :366.0   Max.   :2012   Max.   :1941                     
#&gt;                                                                  
#&gt;        i              LogQ                Q7                Q30          
#&gt;  Min.   :    1   Min.   :-4.61412   Min.   : 0.01808   Min.   : 0.09606  
#&gt;  1st Qu.: 2923   1st Qu.:-0.06779   1st Qu.: 0.98704   1st Qu.: 1.16949  
#&gt;  Median : 5844   Median : 0.87835   Median : 2.55661   Median : 2.86850  
#&gt;  Mean   : 5844   Mean   : 0.76616   Mean   : 4.08569   Mean   : 4.08160  
#&gt;  3rd Qu.: 8766   3rd Qu.: 1.52945   3rd Qu.: 4.93017   3rd Qu.: 5.69169  
#&gt;  Max.   :11688   Max.   : 5.50678   Max.   :84.00395   Max.   :25.47478  
#&gt;                                     NA's   :6          NA's   :29        
#&gt;       yHat                 SE            ConcDay          FluxDay        
#&gt;  Min.   :-1.790952   Min.   :0.1347   Min.   :0.1776   Min.   :   1.643  
#&gt;  1st Qu.:-0.004236   1st Qu.:0.2191   1st Qu.:1.0357   1st Qu.:  98.013  
#&gt;  Median : 0.130934   Median :0.2504   Median :1.1959   Median : 250.088  
#&gt;  Mean   : 0.120318   Mean   :0.2689   Mean   :1.1978   Mean   : 366.085  
#&gt;  3rd Qu.: 0.258944   3rd Qu.:0.3029   3rd Qu.:1.3551   3rd Qu.: 484.360  
#&gt;  Max.   : 0.661543   Max.   :0.6146   Max.   :1.9666   Max.   :5519.450  
#&gt;                                                                          
#&gt;      FNConc           FNFlux          GenFlux             GenConc     
#&gt;  Min.   :0.8352   Min.   : 77.55   Min.   :    1.636   Min.   :0.049  
#&gt;  1st Qu.:1.0540   1st Qu.:169.71   1st Qu.:   95.432   1st Qu.:1.003  
#&gt;  Median :1.2067   Median :318.61   Median :  248.006   Median :1.201  
#&gt;  Mean   :1.2004   Mean   :362.71   Mean   :  377.880   Mean   :1.216  
#&gt;  3rd Qu.:1.3314   3rd Qu.:538.44   3rd Qu.:  500.892   3rd Qu.:1.416  
#&gt;  Max.   :1.6882   Max.   :943.75   Max.   :11927.056   Max.   :2.430  
#&gt;                                                                       </div><div class='input'>
<span class='co'>#All flux values in AnnualResults are expressed as a rate in kg/day</span>
<span class='va'>AnnualResults</span> <span class='op'>&lt;-</span> <span class='fu'><a href='setupYears.html'>setupYears</a></span><span class='op'>(</span><span class='va'>eList</span><span class='op'>$</span><span class='va'>Daily</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>AnnualResults</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    DecYear        Q      Conc     Flux    FNConc   FNFlux   GenConc  GenFlux
#&gt; 1 1980.249 4.251937 0.9485403 316.0491 1.0027237 291.2176 0.9630666 320.5489
#&gt; 2 1981.249 2.217248 1.0351962 184.6712 0.9988918 296.7260 0.9890243 170.7100
#&gt; 3 1982.249 3.046039 1.0361327 269.6309 0.9931881 300.7424 1.0908030 289.0504
#&gt; 4 1983.249 4.986713 1.0072716 363.8563 0.9931768 305.5898 1.0318667 369.7267
#&gt; 5 1984.249 5.718146 0.9901927 437.3007 1.0017255 312.2260 1.0295013 449.6796
#&gt; 6 1985.249 1.517457 1.0571854 133.9210 1.0165324 318.5007 1.0415097 130.4003
#&gt;   PeriodLong PeriodStart
#&gt; 1         12          10
#&gt; 2         12          10
#&gt; 3         12          10
#&gt; 4         12          10
#&gt; 5         12          10
#&gt; 6         12          10</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Hirsch, Laura DeCicco.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


