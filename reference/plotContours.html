<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration) — plotContours • EGRET</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration) — plotContours" />
<meta property="og:description" content="These plots are normally used for plotting the estimated concentration surface (whatSurface=3) but can be used to explore the 
estimated surfaces for the log of concentration or for the standard error (in log space) which is what determines the bias correction. 
The plots are often more interpretable when the time limits are only about 4 years apart.
To explore changes over a long time period it is best to do this multiple times, for various time slices of 4 years (for example) or to use the function plotDiffContours.
Although there are a lot of optional arguments to this function, most are set to a logical default.
Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRET</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/EGRET.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function Help Pages</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Enhancements.html">Enhancements</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running in Parallel</a>
    </li>
    <li>
      <a href="../articles/rResid.html">Random Residuals</a>
    </li>
    <li>
      <a href="../articles/SeasonalFraction.html">Seasonal Analysis</a>
    </li>
    <li>
      <a href="../articles/streamflow_trend.html">Daily Streamflow Trends</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bibliograpy
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/References_WRTDS.html">WRTDS</a>
    </li>
    <li>
      <a href="../articles/References_Extend.html">Extending Methods</a>
    </li>
    <li>
      <a href="../articles/References_Region.html">Regional Studies</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/EGRET">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration)</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/EGRET/blob/master/R/plotContours.R'><code>R/plotContours.R</code></a></small>
    <div class="hidden name"><code>plotContours.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These plots are normally used for plotting the estimated concentration surface (whatSurface=3) but can be used to explore the 
estimated surfaces for the log of concentration or for the standard error (in log space) which is what determines the bias correction. 
The plots are often more interpretable when the time limits are only about 4 years apart.
To explore changes over a long time period it is best to do this multiple times, for various time slices of 4 years (for example) or to use the function <code>plotDiffContours</code>.</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.</p>
    </div>

    <pre class="usage"><span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>, <span class='no'>yearEnd</span>, <span class='kw'>qBottom</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>qTop</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>whatSurface</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>qUnit</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>span</span> <span class='kw'>=</span> <span class='fl'>60</span>,
  <span class='kw'>pval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>printTitle</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>vert1</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>vert2</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>tcl</span> <span class='kw'>=</span> <span class='fl'>0.03</span>, <span class='kw'>flowDuration</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>customPar</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>yTicks</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>tick.lwd</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>usgsStyle</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>cex.main</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cex.axis</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>color.palette</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"white"</span>, <span class='st'>"gray"</span>, <span class='st'>"blue"</span>, <span class='st'>"red"</span>)),
  <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eList</th>
      <td><p>named list with at least the Daily and INFO dataframes, and surfaces matrix</p></td>
    </tr>
    <tr>
      <th>yearStart</th>
      <td><p>numeric value for the starting date for the graph, expressed as decimal year (typically whole number such as 1989.0)</p></td>
    </tr>
    <tr>
      <th>yearEnd</th>
      <td><p>numeric value for the ending date for the graph, expressed as decimal year, (for example 1993.0)</p></td>
    </tr>
    <tr>
      <th>qBottom</th>
      <td><p>numeric value for the bottom edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a "pretty" lower limit nearest to the 5% of discharge.  If yTicks are specified, then the first value of yTicks becomes the lowest discharge shown on the figure.</p></td>
    </tr>
    <tr>
      <th>qTop</th>
      <td><p>numeric value for the top edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a "pretty" upper limit nearest to the 95% of discharge. If yTicks are specified, then the last value of yTicks becomes the highest discharge shown on the figure.</p></td>
    </tr>
    <tr>
      <th>whatSurface</th>
      <td><p>numeric value, can only accept 1, 2, or 3;  whatSurface=1 is yHat (log concentration), whatSurface=2 is SE (standard error of log concentration), and whatSurface=3 is ConcHat (unbiased estimate of concentration), default = 3.</p></td>
    </tr>
    <tr>
      <th>qUnit</th>
      <td><p>object of qUnit class. <code><a href='printqUnitCheatSheet.html'>printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p></td>
    </tr>
    <tr>
      <th>contourLevels</th>
      <td><p>numeric vector containing the contour levels for the contour plot, arranged in ascending order, default is NA (which causes the contour levels to be set automatically, based on the data)</p></td>
    </tr>
    <tr>
      <th>span</th>
      <td><p>numeric, it is the half-width (in days) of the smoothing window for computing the flow duration information, default = 60</p></td>
    </tr>
    <tr>
      <th>pval</th>
      <td><p>numeric, the probability value for the lower flow frequency line on the graph</p></td>
    </tr>
    <tr>
      <th>printTitle</th>
      <td><p>logical variable if TRUE title is printed, if FALSE not printed</p></td>
    </tr>
    <tr>
      <th>vert1</th>
      <td><p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert1&lt;yearEnd, default is NA (vertical line is not drawn)</p></td>
    </tr>
    <tr>
      <th>vert2</th>
      <td><p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert2&lt;yearEnd, default is NA (vertical line is not drawn)</p></td>
    </tr>
    <tr>
      <th>horiz</th>
      <td><p>numeric, the location in discharge for a black horizontal line on the figure, qBottom&lt;vert1&lt;qTop, default is NA (no horizontal line is drawn)</p></td>
    </tr>
    <tr>
      <th>tcl</th>
      <td><p>numeric, length of tick marks in inches, default is 0.03</p></td>
    </tr>
    <tr>
      <th>flowDuration</th>
      <td><p>logical variable if TRUE plot the flow duration lines (5 and 95 flow percentiles), if FALSE do not plot them, default = TRUE</p></td>
    </tr>
    <tr>
      <th>customPar</th>
      <td><p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins.</p></td>
    </tr>
    <tr>
      <th>yTicks</th>
      <td><p>vector of yTick labels and marks that will be plotted in log space. (for example yTicks = c(3, 5, 10, 20, 50, 100, 200, 400). The first and last values determine the range of the y axis. If NA, the tick marks will be automatically generated.</p></td>
    </tr>
    <tr>
      <th>tick.lwd</th>
      <td><p>line width for axis ticks, default is 1</p></td>
    </tr>
    <tr>
      <th>usgsStyle</th>
      <td><p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS complience. It will only change automatically
generated labels.</p></td>
    </tr>
    <tr>
      <th>lwd</th>
      <td><p>numeric, line width of flowDuration curve, default is 2</p></td>
    </tr>
    <tr>
      <th>cex.main</th>
      <td><p>magnification to be used for main titles relative to the current setting of cex</p></td>
    </tr>
    <tr>
      <th>cex.axis</th>
      <td><p>magnification to be used for axis annotation relative to the current setting of cex</p></td>
    </tr>
    <tr>
      <th>color.palette</th>
      <td><p>a function that creates a color palette for the contour plot. Default goes from white to gray to blue to red 
using the function <code><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette(c("white","gray","blue","red"))</a></code>. A few preset options are heat.colors, topo.colors, and terrain.colors.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>yearStart</span> <span class='kw'>&lt;-</span> <span class='fl'>2001</span>
<span class='no'>yearEnd</span> <span class='kw'>&lt;-</span> <span class='fl'>2010</span>
<span class='no'>qBottom</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>qTop</span><span class='kw'>&lt;-</span> <span class='fl'>22</span>
<span class='no'>clevel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>3.5</span>,<span class='fl'>0.5</span>)
<span class='no'>eList</span> <span class='kw'>&lt;-</span> <span class='no'>Choptank_eList</span>
<span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>, <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>)</div><div class='img'><img src='plotContours-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='kw'>qBottom</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>qTop</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>)</div><div class='img'><img src='plotContours-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>yTicksModified</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>,<span class='fl'>1</span>,<span class='fl'>10</span>,<span class='fl'>25</span>)
<span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>,
      <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>,<span class='kw'>yTicks</span><span class='kw'>=</span><span class='no'>yTicksModified</span>,<span class='kw'>flowDuration</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='plotContours-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>colors</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"white"</span>,<span class='st'>"red"</span>))
<span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>,
       <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>,<span class='kw'>yTicks</span><span class='kw'>=</span><span class='no'>yTicksModified</span>,
       <span class='kw'>color.palette</span><span class='kw'>=</span><span class='no'>colors</span>,<span class='kw'>flowDuration</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='plotContours-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>colors2</span> <span class='kw'>&lt;-</span> <span class='no'>heat.colors</span> <span class='co'># Some other options: topo.colors, terrain.colors, cm.colors</span>
<span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>,
       <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>,<span class='kw'>color.palette</span><span class='kw'>=</span><span class='no'>colors2</span>,<span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>flowDuration</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='plotContours-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>,
       <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>,<span class='kw'>cex.axis</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>flowDuration</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='plotContours-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>5</span>,<span class='fl'>8</span>))
<span class='fu'>plotContours</span>(<span class='no'>eList</span>, <span class='no'>yearStart</span>,<span class='no'>yearEnd</span>,<span class='no'>qBottom</span>,<span class='no'>qTop</span>,
       <span class='kw'>contourLevels</span> <span class='kw'>=</span> <span class='no'>clevel</span>,<span class='kw'>customPar</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>printTitle</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>flowDuration</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='plotContours-7.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Hirsch, Laura DeCicco.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


