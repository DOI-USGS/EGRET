<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EGRET">
<title>Introduction to the EGRET package • EGRET</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to the EGRET package">
<meta property="og:description" content="EGRET">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://www.usgs.gov/" class="external-link"><img src="logo.png" id="logo" alt="Home" style="padding: 0px 50px 0px 0px;"></a>
    <a class="navbar-brand me-2" href="../index.html">EGRET</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.7.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Overview.html">Overview and Updates</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/EGRET.html">Introduction</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function Help Pages</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Enhancements.html">Enhancements</a>
    <a class="dropdown-item" href="../articles/WRTDSK.html">WRTDS Kalman</a>
    <a class="dropdown-item" href="../articles/parallel.html">Running in Parallel</a>
    <a class="dropdown-item" href="../articles/rResid.html">Random Residuals</a>
    <a class="dropdown-item" href="../articles/SeasonalFraction.html">Seasonal Analysis</a>
    <a class="dropdown-item" href="../articles/streamflow_trend.html">Daily Streamflow Trends</a>
    <a class="dropdown-item" href="../articles/TrendsByMonth.html">Trends by month</a>
    <a class="dropdown-item" href="../articles/AlternativeQMethod.html">Alternative Q Method</a>
    <a class="dropdown-item" href="../articles/Annual_Hydrograph_Timing.html">Annual_Hydrograph_Timing</a>
    <a class="dropdown-item" href="../articles/units.html">Custom Units</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/References_WRTDS.html">Bibliograpy</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://code.usgs.gov/water/EGRET">
    <span class="fa fa-gitlab fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to the EGRET package</h1>
                        <h4 data-toc-skip class="author">Robert M.
Hirsch and Laura DeCicco</h4>
            
            <h4 data-toc-skip class="date">2019-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/EGRET/blob/HEAD/vignettes/EGRET.Rmd" class="external-link"><code>vignettes/EGRET.Rmd</code></a></small>
      <div class="d-none name"><code>EGRET.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>EGRET includes statistics and graphics for streamflow history, water
quality trends, and the statistical modeling algorithm Weighted
Regressions on Time, Discharge, and Season (WRTDS). Please see the
official EGRET User Guide <span class="citation">Robert M. Hirsch and De
Cicco (<a href="#ref-hirsch_user_2015" role="doc-biblioref">2015</a>)</span> for more information on the EGRET
package:</p>
<p><a href="https://doi.org/10.3133/tm4A10" class="external-link">https://doi.org/10.3133/tm4A10</a></p>
<p>For information on getting started in R, downloading and installing
the package, see the <a href="#new-to-r">New to R</a> section.</p>
<p>The best ways to learn about the WRTDS approach is to read the User
Guide and two journal articles. These articles are available, for free,
from the journals in which they were published.</p>
<p>The first relates to nitrate and total phosphorus data for 9 rivers
draining to Chesapeake Bay. The URL is <span class="citation">Robert M.
Hirsch, Moyer, and Archfield (<a href="#ref-hirsch_weighted_2010" role="doc-biblioref">2010</a>)</span>: <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1752-1688.2010.00482.x" class="external-link">https://onlinelibrary.wiley.com/doi/full/10.1111/j.1752-1688.2010.00482.x</a>.</p>
<p>The second is an application to nitrate data for 8 monitoring sites
on the Mississippi River or its major tributaries <span class="citation">Sprague, Hirsch, and Aulenbach (<a href="#ref-sprague_nitrate_2011" role="doc-biblioref">2011</a>)</span>.
The URL is: <a href="https://pubs.acs.org/doi/abs/10.1021/es201221s" class="external-link">https://pubs.acs.org/doi/abs/10.1021/es201221s</a></p>
<p>This vignette assumes that you understand the concepts underlying
WRTDS, and reading the relevant sections of the User Guide at least the
first of these papers. Any use of trade, firm, or product names is for
descriptive purposes only and does not imply endorsement by the U.S.
Government.</p>
</div>
<div class="section level2">
<h2 id="egret-workflow">EGRET Workflow<a class="anchor" aria-label="anchor" href="#egret-workflow"></a>
</h2>
<p>Subsequent sections of this vignette discuss the EGRET workflow steps
in greater detail. This section provides a handy cheat sheet for diving
into an EGRET analysis. The first example is for a flow history
analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">EGRET</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Flow history analysis</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co"># Gather discharge data:</span></span>
<span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span> <span class="co">#Choptank River at Greensboro, MD</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># Get earliest date</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># Get latest date</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="co"># Gather site and parameter information:</span></span>
<span><span class="co"># Here user must input some values for</span></span>
<span><span class="co"># the default (interactive=TRUE)</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Choptank River near Greensboro, MD"</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co"># Check flow history data:</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>, istat<span class="op">=</span><span class="fl">7</span>,qUnit<span class="op">=</span><span class="st">"thousandCfs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSDLogQ.html">plotSDLogQ</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotQTimeDaily.html">plotQTimeDaily</a></span><span class="op">(</span><span class="va">eList</span>, qLower<span class="op">=</span><span class="fl">1</span>,qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFour.html">plotFour</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFourStats.html">plotFourStats</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="co"># modify this for your own computer file structure:</span></span>
<span><span class="va">savePath</span><span class="op">&lt;-</span><span class="st">"/Users/rhirsch/Desktop/"</span> </span>
<span><span class="fu"><a href="../reference/saveResults.html">saveResults</a></span><span class="op">(</span><span class="va">savePath</span>, <span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<p>The second workflow example is for a water quality analysis. It
includes data retrieval, merging of water quality and streamflow data,
running the WRTDS estimation, and various plotting functions available
in the EGRET package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">EGRET</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co"># Gather discharge data:</span></span>
<span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span> <span class="co">#Choptank River near Greensboro, MD</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co">#Gets earliest date</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">"2011-09-30"</span></span>
<span><span class="co"># Gather sample data:</span></span>
<span><span class="va">parameter_cd</span><span class="op">&lt;-</span><span class="st">"00631"</span> <span class="co">#5 digit USGS code</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISSample.html">readNWISSample</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">parameter_cd</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="co">#Gets earliest date from Sample record:</span></span>
<span><span class="co">#This is just one of many ways to assure the Daily record</span></span>
<span><span class="co">#spans the Sample record</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># Gather discharge data:</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="co"># Gather site and parameter information:</span></span>
<span></span>
<span><span class="co"># Here user must input some values:</span></span>
<span><span class="va">INFO</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">parameter_cd</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Choptank River at Greensboro, MD"</span></span>
<span></span>
<span><span class="co"># Merge discharge with sample data:</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mergeReport.html">mergeReport</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="va">Sample</span><span class="op">)</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co"># Check sample data:</span></span>
<span><span class="fu"><a href="../reference/boxConcMonth.html">boxConcMonth</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boxQTwice.html">boxQTwice</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcTime.html">plotConcTime</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/multiPlotDataOverview.html">multiPlotDataOverview</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co"># Run WRTDS model:</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelEstimation.html">modelEstimation</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="co">############################</span></span>
<span><span class="co">#Check model results:</span></span>
<span></span>
<span><span class="co">#Require Sample + INFO:</span></span>
<span><span class="fu"><a href="../reference/plotConcTimeDaily.html">plotConcTimeDaily</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxTimeDaily.html">plotFluxTimeDaily</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcPred.html">plotConcPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxPred.html">plotFluxPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotResidPred.html">plotResidPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotResidQ.html">plotResidQ</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotResidTime.html">plotResidTime</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boxResidMonth.html">boxResidMonth</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boxConcThree.html">boxConcThree</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Require Daily + INFO:</span></span>
<span><span class="fu"><a href="../reference/plotConcHist.html">plotConcHist</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxHist.html">plotFluxHist</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multi-line plots:</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="st">"1985-09-01"</span></span>
<span><span class="va">date2</span> <span class="op">&lt;-</span> <span class="st">"1997-09-0"</span></span>
<span><span class="va">date3</span> <span class="op">&lt;-</span> <span class="st">"2010-09-01"</span></span>
<span><span class="va">qBottom</span><span class="op">&lt;-</span><span class="fl">0.2</span></span>
<span><span class="va">qTop</span><span class="op">&lt;-</span><span class="fl">10</span></span>
<span><span class="fu"><a href="../reference/plotConcQSmooth.html">plotConcQSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">date1</span>, <span class="va">date2</span>, <span class="va">date3</span>, <span class="va">qBottom</span>, <span class="va">qTop</span>, </span>
<span>                   concMax<span class="op">=</span><span class="fl">2</span>,legendTop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">q2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">q3</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">centerDate</span> <span class="op">&lt;-</span> <span class="st">"07-01"</span></span>
<span><span class="va">yearEnd</span> <span class="op">&lt;-</span> <span class="fl">1980</span></span>
<span><span class="va">yearStart</span> <span class="op">&lt;-</span> <span class="fl">2010</span></span>
<span><span class="fu"><a href="../reference/plotConcTimeSmooth.html">plotConcTimeSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">centerDate</span>, <span class="va">yearStart</span>, <span class="va">yearEnd</span>, legendTop <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multi-plots:</span></span>
<span><span class="fu"><a href="../reference/fluxBiasMulti.html">fluxBiasMulti</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Contour plots:</span></span>
<span><span class="va">clevel</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">maxDiff</span><span class="op">&lt;-</span><span class="fl">0.8</span></span>
<span><span class="va">yearStart</span> <span class="op">&lt;-</span> <span class="fl">1980</span></span>
<span><span class="va">yearEnd</span> <span class="op">&lt;-</span> <span class="fl">2010</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotContours.html">plotContours</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">yearStart</span>,<span class="va">yearEnd</span>,<span class="va">qBottom</span>,<span class="va">qTop</span>, </span>
<span>             contourLevels <span class="op">=</span> <span class="va">clevel</span>,qUnit<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotDiffContours.html">plotDiffContours</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">yearStart</span>,<span class="va">yearEnd</span>,</span>
<span>                 <span class="va">qBottom</span>,<span class="va">qTop</span>,<span class="va">maxDiff</span>,qUnit<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># modify this for your own computer file structure:</span></span>
<span><span class="va">savePath</span><span class="op">&lt;-</span><span class="st">"/Users/rhirsch/Desktop/"</span> </span>
<span><span class="fu"><a href="../reference/saveResults.html">saveResults</a></span><span class="op">(</span><span class="va">savePath</span>, <span class="va">eList</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data_frame">EGRET Data Frames and Retrieval Options<a class="anchor" aria-label="anchor" href="#data_frame"></a>
</h2>
<p>The EGRET package uses 3 default data frames throughout the
calculations, analysis, and graphing. These data frames are <a href="#data_frame_Daily">Daily</a>, <a href="#data_frame_Sample">Sample</a>, and <a href="#data_frame_INFO">INFO</a>. The data frames are combined into a
named list for all EGRET functions using the <code>as.egret</code>
function (see <a href="#eList">Merge Report</a>).</p>
<p>A package that EGRET depends on is called dataRetrieval. This package
provides the core functionality to import hydrologic data from USGS and
EPA web services. See the dataRetrieval vignette for more
information.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://code.usgs.gov/water/dataRetrieval" class="external-link">dataRetrieval</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"dataRetrieval"</span><span class="op">)</span></span></code></pre></div>
<p>EGRET uses entirely SI units to store the data, but for purposes of
output, it can report results in a wide variety of units, which will be
discussed in the <a href="#units">Units</a> section. To start our
exploration, you must install the packages, then open EGRET with the
following command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">EGRET</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data_frame_Daily">Daily<a class="anchor" aria-label="anchor" href="#data_frame_Daily"></a>
</h3>
<p>The Daily data frame can be imported into R either from USGS web
services (<code>readNWISDaily</code>) or user-generated files
(<code>readUserDaily</code>). After you run the WRTDS calculations by
using the function <code>modelEstimation</code> (as will be described in
the <a href="#wrtds">WRTDS section</a>, additional columns are
inserted.</p>
<table class="table">
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="left">Type</th>
<th align="right">Description</th>
<th align="right">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Date</td>
<td align="left">Date</td>
<td align="right">Date</td>
<td align="right">date</td>
</tr>
<tr class="even">
<td align="left">Q</td>
<td align="left">number</td>
<td align="right">Discharge in m<sup>3</sup>/s</td>
<td align="right">m<sup>3</sup>/s</td>
</tr>
<tr class="odd">
<td align="left">Julian</td>
<td align="left">number</td>
<td align="right">Number of days since January 1, 1850</td>
<td align="right">days</td>
</tr>
<tr class="even">
<td align="left">Month</td>
<td align="left">integer</td>
<td align="right">Month of the year [1-12]</td>
<td align="right">months</td>
</tr>
<tr class="odd">
<td align="left">Day</td>
<td align="left">integer</td>
<td align="right">Day of the year [1-366]</td>
<td align="right">days</td>
</tr>
<tr class="even">
<td align="left">DecYear</td>
<td align="left">number</td>
<td align="right">Decimal year</td>
<td align="right">years</td>
</tr>
<tr class="odd">
<td align="left">MonthSeq</td>
<td align="left">integer</td>
<td align="right">Number of months since January 1, 1850</td>
<td align="right">months</td>
</tr>
<tr class="even">
<td align="left">Qualifier</td>
<td align="left">character</td>
<td align="right">Qualifying code</td>
<td align="right">string</td>
</tr>
<tr class="odd">
<td align="left">i</td>
<td align="left">integer</td>
<td align="right">Index of days, starting with 1</td>
<td align="right">days</td>
</tr>
<tr class="even">
<td align="left">LogQ</td>
<td align="left">number</td>
<td align="right">Natural logarithm of Q</td>
<td align="right">numeric</td>
</tr>
<tr class="odd">
<td align="left">Q7</td>
<td align="left">number</td>
<td align="right">7 day running average of Q</td>
<td align="right">m<sup>3</sup>/s</td>
</tr>
<tr class="even">
<td align="left">Q30</td>
<td align="left">number</td>
<td align="right">30 day running average of Q</td>
<td align="right">m<sup>3</sup>/s</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Columns added to Daily data frame after running
<code>modelEstimation</code>
</caption>
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="left">Type</th>
<th align="right">Description</th>
<th align="right">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">yHat</td>
<td align="left">number</td>
<td align="right">The WRTDS estimate of the log of concentration</td>
<td align="right">numeric</td>
</tr>
<tr class="even">
<td align="left">SE</td>
<td align="left">number</td>
<td align="right">The WRTDS estimate of the standard error of yHat</td>
<td align="right">numeric</td>
</tr>
<tr class="odd">
<td align="left">ConcDay</td>
<td align="left">number</td>
<td align="right">The WRTDS estimate of concentration</td>
<td align="right">mg/L</td>
</tr>
<tr class="even">
<td align="left">FluxDay</td>
<td align="left">number</td>
<td align="right">The WRTDS estimate of flux</td>
<td align="right">kg/day</td>
</tr>
<tr class="odd">
<td align="left">FNConc</td>
<td align="left">number</td>
<td align="right">Flow-normalized estimate of concentration</td>
<td align="right">mg/L</td>
</tr>
<tr class="even">
<td align="left">FNFlux</td>
<td align="left">number</td>
<td align="right">Flow-normalized estimate of flux</td>
<td align="right">kg/day</td>
</tr>
</tbody>
</table>
<p>Notice that the “Day of the year” column can span from 1 to 366. The
366 accounts for leap years. Every day has a consistent day of the year.
This means, February 28<sup>th</sup> is always the 59<sup>th</sup> day
of the year, Feb. 29<sup>th</sup> is always the 60<sup>th</sup> day of
the year, and March 1<sup>st</sup> is always the 61<sup>st</sup> day of
the year whether or not it is a leap year.</p>
<div class="section level4">
<h4 id="nwisDailyFile">readNWISDaily<a class="anchor" aria-label="anchor" href="#nwisDailyFile"></a>
</h4>
<p>The <code>readNWISDaily</code> function retrieves the daily values
(discharge in this case) from a USGS web service. It requires the inputs
siteNumber, parameterCd, startDate, endDate, interactive, and
convert.</p>
<p>These arguments are described in detail in the
<code>dataRetrieval</code> vignette, however <code>convert</code> is a
new argument (which defaults to TRUE). The convert argument tells the
program to convert the values from cubic feet per second
(ft<sup>3</sup>/s) to cubic meters per second (m<sup>3</sup>/s) as shown
in the example Daily data frame. For EGRET applications with NWIS Web
retrieval, do not use this argument (the default is TRUE), EGRET assumes
that discharge is always stored in units of cubic meters per second. If
you don’t want this conversion and are not using EGRET, set
convert=FALSE in the function call.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">"2000-01-01"</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">"2013-01-01"</span></span>
<span><span class="co"># This call will get NWIS (ft3/s) data , and convert it to m3/s:</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>, <span class="st">"00060"</span>, <span class="va">startDate</span>, <span class="va">endDate</span><span class="op">)</span></span></code></pre></div>
<p>If discharge values are negative or zero, the code will set all of
these values to zero and then add a small constant to all of the daily
discharge values. This constant is 0.001 times the mean discharge. The
code will also report on the number of zero and negative values and the
size of the constant. Use EGRET analysis only if the number of zero
values is a very small fraction of the total days in the record (say
less than 0.1% of the days), and there are no negative discharge values.
Columns Q7 and Q30 are the 7 and 30 day running averages for the 7 or 30
days ending on this specific date.</p>
</div>
<div class="section level4">
<h4 id="DailyFile">readUserDaily<a class="anchor" aria-label="anchor" href="#DailyFile"></a>
</h4>
<p>The <code>readUserDaily</code> function will load a user-supplied
text file and convert it to the Daily data frame. The file should have
two columns, the first dates, the second values. The dates are formatted
either mm/dd/yyyy or yyyy-mm-dd. Using a 4-digit year is required. This
function has the following inputs: filePath, fileName, hasHeader
(TRUE/FALSE), separator, qUnit, and interactive (TRUE/FALSE). filePath
is a character that defines the path to your file, and the character can
either be a full path, or path relative to your R working directory. The
input fileName is a character that defines the file name (including the
extension).</p>
<p>Text files that contain this sort of data require some sort of a
separator, for example, a “csv” file (comma-separated value) file uses a
comma to separate the date and value column. A tab delimited file would
use a tab (<code>"\t"</code>) rather than the comma (<code>","</code>).
Define the type of separator you choose to use in the function call in
the <code>separator</code> argument, the default is <code>","</code>.
Another function input is a logical variable: hasHeader. The default is
TRUE. If your data does not have column names, set this variable to
FALSE.</p>
<p>Finally, qUnit is a numeric argument that defines the discharge units
used in the input file. The default is qUnit = 1 which assumes discharge
is in cubic feet per second. If the discharge in the file is already in
cubic meters per second then set qUnit = 2. If it is in some other units
(like liters per second or acre-feet per day), the user must pre-process
the data with a unit conversion that changes it to either cubic feet per
second or cubic meters per second.</p>
<p>So, if you have a file called “ChoptankRiverFlow.txt” located in a
folder called “RData” on the C drive (this example is for the Windows™
operating systems), and the file is structured as follows
(tab-separated):</p>
<pre><code>date  Qdaily
10/1/1999  107
10/2/1999  85
10/3/1999  76
10/4/1999  76
10/5/1999   113
10/6/1999   98
...</code></pre>
<p>The call to open this file, convert the discharge to cubic meters per
second, and populate the Daily data frame would be:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fileName</span> <span class="op">&lt;-</span> <span class="st">"ChoptankRiverFlow.txt"</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span>  <span class="st">"C:/RData/"</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readUserDaily.html">readUserDaily</a></span><span class="op">(</span><span class="va">filePath</span>,<span class="va">fileName</span>,</span>
<span>                    separator<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
<p>Microsoft™ Excel files can be a bit tricky to import into R directly.
The simplest way to get Excel data into R is to open the Excel file in
Excel, then save it as a .csv file (comma-separated values).</p>
</div>
</div>
<div class="section level3">
<h3 id="data_frame_Sample">Sample<a class="anchor" aria-label="anchor" href="#data_frame_Sample"></a>
</h3>
<p>The Sample data frame initially is populated with columns generated
by either the <code>readNWISSample</code>, <code>readWQPSample</code>,
or <code>readUserSample</code> functions. After you run the WRTDS
calculations using the <code>modelEstimation</code> function (as
described in the <a href="#wrtds">WRTDS</a> section, additional columns
are inserted:</p>
<table class="table">
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="left">Type</th>
<th align="right">Description</th>
<th align="right">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Date</td>
<td align="left">Date</td>
<td align="right">Date</td>
<td align="right">date</td>
</tr>
<tr class="even">
<td align="left">ConcLow</td>
<td align="left">number</td>
<td align="right">Lower limit of concentration</td>
<td align="right">mg/L</td>
</tr>
<tr class="odd">
<td align="left">ConcHigh</td>
<td align="left">number</td>
<td align="right">Upper limit of concentration</td>
<td align="right">mg/L</td>
</tr>
<tr class="even">
<td align="left">Uncen</td>
<td align="left">integer</td>
<td align="right">Uncensored data (1=true, 0=false)</td>
<td align="right">integer</td>
</tr>
<tr class="odd">
<td align="left">ConcAve</td>
<td align="left">number</td>
<td align="right">Average concentration</td>
<td align="right">mg/L</td>
</tr>
<tr class="even">
<td align="left">Julian</td>
<td align="left">number</td>
<td align="right">Number of days since January 1, 1850</td>
<td align="right">days</td>
</tr>
<tr class="odd">
<td align="left">Month</td>
<td align="left">integer</td>
<td align="right">Month of the year [1-12]</td>
<td align="right">months</td>
</tr>
<tr class="even">
<td align="left">Day</td>
<td align="left">integer</td>
<td align="right">Day of the year [1-366]</td>
<td align="right">days</td>
</tr>
<tr class="odd">
<td align="left">DecYear</td>
<td align="left">number</td>
<td align="right">Decimal year</td>
<td align="right">years</td>
</tr>
<tr class="even">
<td align="left">MonthSeq</td>
<td align="left">integer</td>
<td align="right">Number of months since January 1, 1850</td>
<td align="right">months</td>
</tr>
<tr class="odd">
<td align="left">SinDY</td>
<td align="left">number</td>
<td align="right">Sine of DecYear</td>
<td align="right">numeric</td>
</tr>
<tr class="even">
<td align="left">CosDY</td>
<td align="left">number</td>
<td align="right">Cosine of DecYear</td>
<td align="right">numeric</td>
</tr>
<tr class="odd">
<td align="left">Q</td>
<td align="left">number</td>
<td align="right">Discharge</td>
<td align="right">cms</td>
</tr>
<tr class="even">
<td align="left">LogQ</td>
<td align="left">number</td>
<td align="right">Natural logarithm of discharge</td>
<td align="right">numeric</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Columns added to Sample data frame after running
<code>modelEstimation</code>
</caption>
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="left">Type</th>
<th align="right">Description</th>
<th align="right">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">yHat</td>
<td align="left">number</td>
<td align="right">estimate of the log of concentration</td>
<td align="right">numeric</td>
</tr>
<tr class="even">
<td align="left">SE</td>
<td align="left">number</td>
<td align="right">estimate of the standard error of yHat</td>
<td align="right">numeric</td>
</tr>
<tr class="odd">
<td align="left">ConcHat</td>
<td align="left">number</td>
<td align="right">unbiased estimate of concentration</td>
<td align="right">mg/L</td>
</tr>
</tbody>
</table>
<p>As with the Daily data frame, the “Day of the year” column can span
from 1 to 366. The 366 accounts for leap years. Every day has a
consistent day of the year. This means, February 28<sup>th</sup> is
always the 59<sup>th</sup> day of the year, Feb. 29<sup>th</sup> is
always the 60<sup>th</sup> day of the year, and March 1<sup>st</sup> is
always the 61<sup>st</sup> day of the year whether or not it is a leap
year.</p>
<p>The <a href="#cenValues">censored value</a> section is about summing
multiple constituents, including how interval censoring is used. Since
the Sample data frame is structured to only contain one constituent,
when more than one parameter codes are requested, the
<code>readNWISSample</code> function will sum the values of each
constituent as described below.</p>
<div class="section level4">
<h4 id="readNWISSample">readNWISSample<a class="anchor" aria-label="anchor" href="#readNWISSample"></a>
</h4>
<p>The <code>readNWISSample</code> function retrieves USGS sample data
from NWIS. The arguments for this function are also siteNumber,
parameterCd, startDate, endDate, interactive. These are the same inputs
as <code>readNWISDaily</code> as described in the previous section.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span></span>
<span><span class="va">parameterCd</span> <span class="op">&lt;-</span> <span class="st">"00618"</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/readNWISSample.html">readNWISSample</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">parameterCd</span>,</span>
<span>      <span class="va">startDate</span>, <span class="va">endDate</span><span class="op">)</span></span></code></pre></div>
<p>Information on USGS parameter codes can be found here:</p>
<p><a href="https://help.waterdata.usgs.gov/codes-and-parameters/parameters" class="external-link">https://help.waterdata.usgs.gov/codes-and-parameters/parameters</a></p>
</div>
<div class="section level4">
<h4 id="readWQPSample">readWQPSample<a class="anchor" aria-label="anchor" href="#readWQPSample"></a>
</h4>
<p>The <code>readWQPSample</code> function retrieves Water Quality
Portal sample data (STORET, NWIS, STEWARDS). The arguments for this
function are siteNumber, characteristicName, startDate, endDate,
interactive.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span> <span class="op">&lt;-</span> <span class="st">'WIDNR_WQX-10032762'</span></span>
<span><span class="va">characteristicName</span> <span class="op">&lt;-</span> <span class="st">'Specific conductance'</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/readWQPSample.html">readWQPSample</a></span><span class="op">(</span><span class="va">site</span>,<span class="va">characteristicName</span>,</span>
<span>      <span class="va">startDate</span>, <span class="va">endDate</span><span class="op">)</span></span></code></pre></div>
<p>To request USGS data from the Water Quality Portal, the siteNumber
must have “USGS-” pasted before the identification number. For USGS
data, the <code>characteristicName</code> argument can be either a list
of 5-digit parameter codes, or the characteristic name. A table that
describes how USGS parameters relate with the defined characteristic
name can be found here:</p>
<p><a href="https://www.waterqualitydata.us/public_srsnames" class="external-link">https://www.waterqualitydata.us/public_srsnames</a></p>
</div>
<div class="section level4">
<h4 id="SampleFile">readUserSample<a class="anchor" aria-label="anchor" href="#SampleFile"></a>
</h4>
<p>The <code>readUserSample</code> function will import a user-generated
file and populate the Sample data frame. The difference between sample
data and discharge data is that the code requires a third column that
contains a remark code, either blank or <code>"&lt;"</code>, which will
tell the program that the data were “left-censored” (or, below the
detection limit of the sensor). Therefore, the data must be in the form:
date, remark, value. An example of a comma-delimited file is:</p>
<pre><code>cdate;remarkCode;Nitrate
10/7/1999,,1.4
11/4/1999,&lt;,0.99
12/3/1999,,1.42
1/4/2000,,1.59
2/3/2000,,1.54
...</code></pre>
<p>The call to open this file, and populate the Sample data frame
is:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fileName</span> <span class="op">&lt;-</span> <span class="st">"ChoptankRiverNitrate.csv"</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span>  <span class="st">"C:/RData/"</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readUserSample.html">readUserSample</a></span><span class="op">(</span><span class="va">filePath</span>,<span class="va">fileName</span>,</span>
<span>                                separator<span class="op">=</span><span class="st">","</span><span class="op">)</span></span></code></pre></div>
<p>When multiple constituents are to be summed, the format can be date,
remark_A, value_A, remark_b, value_b, etc… A tab-separated example might
look like the file below, where the columns are date, remark dissolved
phosphate (rdp), dissolved phosphate (dp), remark particulate phosphorus
(rpp), particulate phosphorus (pp), remark total phosphate (rtp), and
total phosphate (tp):</p>
<pre><code>date  rdp  dp   rpp pp  rtp tp
2003-02-15      0.020       0.500       
2003-06-30  &lt;   0.010       0.300       
2004-09-15  &lt;   0.005   &lt;   0.200       
2005-01-30                      0.430
2005-05-30                  &lt;   0.050
2005-10-30                  &lt;   0.020
...</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fileName</span> <span class="op">&lt;-</span> <span class="st">"ChoptankPhosphorus.txt"</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span>  <span class="st">"C:/RData/"</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/readUserSample.html">readUserSample</a></span><span class="op">(</span><span class="va">filePath</span>,<span class="va">fileName</span>,</span>
<span>                                separator<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cenValues">Censored Values: Summation Explanation<a class="anchor" aria-label="anchor" href="#cenValues"></a>
</h4>
<p>In the typical case where none of the data are censored (that is, no
values are reported as “less-than” values), the ConcLow = ConcHigh =
ConcAve which are all equal to the reported value, and Uncen = 1 for all
values. For the most common type of censoring, where a value is reported
as less than the reporting limit, then ConcLow = NA, ConcHigh =
reporting limit, ConcAve = 0.5 * reporting limit, and Uncen = 0.</p>
<p>To illustrate how the EGRET package handles a more complex censoring
problem, let us say that in 2004 and earlier, we computed total
phosphorus (tp) as the sum of dissolved phosphorus (dp) and particulate
phosphorus (pp). From 2005 and onward, we have direct measurements of
total phosphorus (tp). A small subset of this fictional data is
provided:</p>
<table class="table">
<caption>Example data</caption>
<thead><tr class="header">
<th align="left">cdate</th>
<th align="left">rdp</th>
<th align="right">dp</th>
<th align="left">rpp</th>
<th align="right">pp</th>
<th align="left">rtp</th>
<th align="right">tp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2003-02-15</td>
<td align="left"></td>
<td align="right">0</td>
<td align="left"></td>
<td align="right">0</td>
<td align="left"></td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">2003-06-30</td>
<td align="left">&lt;</td>
<td align="right">0</td>
<td align="left"></td>
<td align="right">0</td>
<td align="left"></td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">2004-09-15</td>
<td align="left">&lt;</td>
<td align="right">0</td>
<td align="left">&lt;</td>
<td align="right">0</td>
<td align="left"></td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">2005-01-30</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left"></td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2005-05-30</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left">&lt;</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2005-10-30</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="left">&lt;</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>EGRET will “add up” all the values in a given row to form the total
for that sample when using the Sample data frame. Thus, you only want to
enter data that should be added together. If you want a data frame with
multiple constituents that are not summed, do not use
<code>readNWISSample</code>, <code>readWQPSample</code>, or
<code>readUserSample</code>. The raw data functions:
<code>getWQPdata</code>, <code>readNWISqw</code>,
<code>readWQPqw</code>, <code>readWQPdata</code> from the EGRET package
will not sum constituents, but leave them in their individual
columns.</p>
<p>For example, we might know the value for dp on 5/30/2005, but we
don’t want to put it in the table because under the rules of this data
set, we are not supposed to add it in to the values in 2005.</p>
<p>For every sample, the EGRET package requires a pair of numbers to
define an interval in which the true value lies (ConcLow and ConcHigh).
In a simple uncensored case (the reported value is above the detection
limit), ConcLow equals ConcHigh and the interval collapses down to a
single point. In a simple censored case, the value might be reported as
&lt;0.2, then ConcLow=NA and ConcHigh=0.2. We use NA instead of 0 as a
way to elegantly handle future logarithm calculations.</p>
<p>For the more complex example case, let us say dp is reported as
&lt;0.01 and pp is reported as 0.3. We know that the total must be at
least 0.3 and could be as much as 0.31. Therefore, ConcLow=0.3 and
ConcHigh=0.31. Another case would be if dp is reported as &lt;0.005 and
pp is reported &lt;0.2. We know in this case that the true value could
be as low as zero, but could be as high as 0.205. Therefore, in this
case, ConcLow=NA and ConcHigh=0.205. The Sample data frame for the
example data would be:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">Sample</span></span></code></pre></div>
<pre><code><span><span class="co">##         Date ConcLow ConcHigh Uncen ConcAve Julian Month Day  DecYear MonthSeq</span></span>
<span><span class="co">## 1 2003-02-15    0.52    0.520     1  0.5200  55927     2  46 2003.125     1838</span></span>
<span><span class="co">## 2 2003-06-30    0.30    0.310     0  0.3050  56062     6 182 2003.495     1842</span></span>
<span><span class="co">## 3 2004-09-15      NA    0.205     0  0.1025  56505     9 259 2004.706     1857</span></span>
<span><span class="co">## 4 2005-01-30    0.43    0.430     1  0.4300  56642     1  30 2005.081     1861</span></span>
<span><span class="co">## 5 2005-05-30      NA    0.050     0  0.0250  56762     5 151 2005.410     1865</span></span>
<span><span class="co">## 6 2005-10-30      NA    0.020     0  0.0100  56915    10 304 2005.829     1870</span></span>
<span><span class="co">##   waterYear       SinDY      CosDY</span></span>
<span><span class="co">## 1      2003  0.70558361  0.7086267</span></span>
<span><span class="co">## 2      2003  0.03442161 -0.9994074</span></span>
<span><span class="co">## 3      2004 -0.96251346 -0.2712339</span></span>
<span><span class="co">## 4      2005  0.48627271  0.8738071</span></span>
<span><span class="co">## 5      2005  0.53800517 -0.8429415</span></span>
<span><span class="co">## 6      2006 -0.88001220  0.4749511</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="data_frame_INFO">INFO<a class="anchor" aria-label="anchor" href="#data_frame_INFO"></a>
</h3>
<p>The INFO data frame stores information about the measurements, such
as station name, parameter name, drainage area, and so forth. There can
be many additional, optional columns, but the columns in the table below
are required to initiate the EGRET analysis. After you run the WRTDS
calculations (as described in the <a href="#wrtds">WRTDS</a> section,
additional columns are automatically inserted into the INFO data frame
(see the EGRET User Guide for complete description of each term):</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="18%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="right">Type</th>
<th align="right">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">shortName</td>
<td align="right">character</td>
<td align="right">Name of site, suitable for use in graphical
headings</td>
</tr>
<tr class="even">
<td align="left">staAbbrev</td>
<td align="right">character</td>
<td align="right">Abbreviation for station name, used in
saveResults</td>
</tr>
<tr class="odd">
<td align="left">paramShortName</td>
<td align="right">character</td>
<td align="right">Name of constituent, suitable for use in graphical
headings</td>
</tr>
<tr class="even">
<td align="left">constitAbbrev</td>
<td align="right">character</td>
<td align="right">Abbreviation for constituent name, used in
saveResults</td>
</tr>
<tr class="odd">
<td align="left">drainSqKm</td>
<td align="right">numeric</td>
<td align="right">Drainage area in km<sup>2</sup>
</td>
</tr>
<tr class="even">
<td align="left">paStart</td>
<td align="right">integer (1-12)</td>
<td align="right">Starting month of period of analysis</td>
</tr>
<tr class="odd">
<td align="left">paLong</td>
<td align="right">integer (1-12)</td>
<td align="right">Length of period of analysis in months</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>INFO data frame after running
<code>modelEstimation</code>
</caption>
<colgroup>
<col width="20%">
<col width="67%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">ColumnName</th>
<th align="right">Description</th>
<th align="right">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">bottomLogQ</td>
<td align="right">Lowest discharge in prediction surfaces</td>
<td align="right">dimensionless</td>
</tr>
<tr class="even">
<td align="left">stepLogQ</td>
<td align="right">Step size in log discharge in prediction surfaces</td>
<td align="right">dimensionless</td>
</tr>
<tr class="odd">
<td align="left">nVectorLogQ</td>
<td align="right">Number of steps in discharge, prediction surfaces</td>
<td align="right">integer</td>
</tr>
<tr class="even">
<td align="left">bottomYear</td>
<td align="right">Starting year in prediction surfaces</td>
<td align="right">years</td>
</tr>
<tr class="odd">
<td align="left">stepYear</td>
<td align="right">Step size in years in prediction surfaces</td>
<td align="right">years</td>
</tr>
<tr class="even">
<td align="left">nVectorYear</td>
<td align="right">Number of steps in years in prediction surfaces</td>
<td align="right">integer</td>
</tr>
<tr class="odd">
<td align="left">windowY</td>
<td align="right">Half-window width in the time dimension</td>
<td align="right">year</td>
</tr>
<tr class="even">
<td align="left">windowQ</td>
<td align="right">Half-window width in the log discharge dimension</td>
<td align="right">dimensionless</td>
</tr>
<tr class="odd">
<td align="left">windowS</td>
<td align="right">Half-window width in the seasonal dimension</td>
<td align="right">years</td>
</tr>
<tr class="even">
<td align="left">minNumObs</td>
<td align="right">Minimum number of observations for regression</td>
<td align="right">integer</td>
</tr>
<tr class="odd">
<td align="left">minNumUncen</td>
<td align="right">Minimum number of uncensored observations</td>
<td align="right">integer</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="nwisINFO">readNWISInfo<a class="anchor" aria-label="anchor" href="#nwisINFO"></a>
</h4>
<p>The function <code>readNWISInfo</code> combines
<code>readNWISsite</code> and <code>readNWISpCode</code> from the
<code>dataRetrieval</code> package, producing one data frame called
INFO.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameterCd</span> <span class="op">&lt;-</span> <span class="st">"00618"</span></span>
<span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">parameterCd</span>, interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="wqpINFO">readWQPInfo<a class="anchor" aria-label="anchor" href="#wqpINFO"></a>
</h4>
<p>It is also possible to create the INFO data frame using information
from the Water Quality Portal. As with <code>readWQPSample</code>, if
the requested site is a USGS siteNumber, “USGS-” needs to be appended to
the siteNumber.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameterCd</span> <span class="op">&lt;-</span> <span class="st">"00618"</span></span>
<span><span class="va">INFO_WQP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readWQPInfo</a></span><span class="op">(</span><span class="st">"USGS-01491000"</span>,<span class="va">parameterCd</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="userINFO">readUserInfo<a class="anchor" aria-label="anchor" href="#userINFO"></a>
</h4>
<p>The function <code>readUserInfo</code> can be used to convert comma
separated files into an INFO data frame. At a minimum, EGRET analysis
uses columns: param.units, shortName, paramShortName, constitAbbrev, and
drainSqKm. For example, if the following comma-separated file (csv) was
available as a file called “INFO.csv”, located in a folder called
“RData” on the C drive (this examples is for Windows™ operation system),
the function to convert it to an INFO data frame is as follows.</p>
<pre><code>param.units, shortName, paramShortName, constitAbbrev, drainSqKm
mg/l, Choptank River, Inorganic nitrogen, N, 292.67</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fileName</span> <span class="op">&lt;-</span> <span class="st">"INFO.csv"</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span> <span class="st">"C:/RData/"</span></span>
<span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readUserInfo</a></span><span class="op">(</span><span class="va">filePath</span>, <span class="va">fileName</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="addINFO">Inserting Additional Info<a class="anchor" aria-label="anchor" href="#addINFO"></a>
</h4>
<p>Any supplemental column that would be useful can be added to the INFO
data frame.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">INFO</span><span class="op">$</span><span class="va">riverInfo</span> <span class="op">&lt;-</span> <span class="st">"Major tributary of the Chesapeake Bay"</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">GreensboroPopulation</span> <span class="op">&lt;-</span> <span class="fl">1931</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="eList">Merge Report: eList<a class="anchor" aria-label="anchor" href="#eList"></a>
</h3>
<p>Finally, there is a function called <code>mergeReport</code> that
will look at both the Daily and Sample data frame, and populate Q and
LogQ columns into the Sample data frame. Once <code>mergeReport</code>
has been run, the Sample data frame will be augmented with the daily
discharges for all the days with samples, and a named list with all of
the data frames will be created. In this vignette, we will refer to this
named list as <code>eList</code>: it is a list with potentially 3 data
frames: Daily, Sample, and INFO. For flow history analysis, the Sample
data frame can be NA.You can use the function <code>as.egret</code> to
create this “EGRET” object.</p>
<p>None of the water quality functions in EGRET will work without first
having run the <code>mergeReport</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span></span>
<span><span class="va">parameterCd</span> <span class="op">&lt;-</span> <span class="st">"00631"</span>  <span class="co"># Nitrate</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">"2000-01-01"</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">"2013-01-01"</span></span>
<span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>, <span class="st">"00060"</span>, <span class="va">startDate</span>, <span class="va">endDate</span><span class="op">)</span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISSample.html">readNWISSample</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">parameterCd</span>, <span class="va">startDate</span>, <span class="va">endDate</span><span class="op">)</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>, <span class="va">parameterCd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mergeReport.html">mergeReport</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>,<span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<p>Perhaps you already have Daily, Sample, and INFO data frames, and
surfaces matrix (created after running the WRTDS
<code>modelEstimation</code>) that have gone though a deprecated version
of EGRET. You can create and edit an EGRET object as follows:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eListNew</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="va">Sample</span>, <span class="va">surfaces</span><span class="op">)</span></span>
<span><span class="co">#To pull out the INFO data frame:</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getInfo.html">getInfo</a></span><span class="op">(</span><span class="va">eListNew</span><span class="op">)</span></span>
<span><span class="co">#Edit the INFO data frame:</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">importantNews</span> <span class="op">&lt;-</span> <span class="st">"New EGRET workflow started"</span></span>
<span><span class="co">#Put new data frame in eListNew</span></span>
<span><span class="va">eListNew</span><span class="op">$</span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="va">INFO</span></span>
<span><span class="co">#To pull out Daily:</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDaily.html">getDaily</a></span><span class="op">(</span><span class="va">eListNew</span><span class="op">)</span></span>
<span><span class="co">#Edit for some reason:</span></span>
<span><span class="va">DailyNew</span> <span class="op">&lt;-</span> <span class="va">Daily</span><span class="op">[</span><span class="va">Daily</span><span class="op">$</span><span class="va">DecYear</span> <span class="op">&gt;</span> <span class="fl">1985</span>,<span class="op">]</span></span>
<span><span class="co">#Put new Daily data frame back in eListNew:</span></span>
<span><span class="va">eListNew</span><span class="op">$</span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="va">DailyNew</span></span>
<span><span class="co">#To create a whole new egret object:</span></span>
<span><span class="va">eList_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">DailyNew</span>, <span class="fu"><a href="../reference/getSample.html">getSample</a></span><span class="op">(</span><span class="va">eListNew</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="units">Units<a class="anchor" aria-label="anchor" href="#units"></a>
</h2>
<p>EGRET uses entirely SI units to store the data, but for purposes of
output, it can report results in a wide variety of units. The defaults
are mg/L for concentration, cubic meters per second (m<sup>3</sup>/s)
for discharge, kg/day for flux, and km<sup>2</sup> for drainage area.
When discharge values are imported from USGS Web services, they are
automatically converted from cubic feet per second (cfs) to cms unless
the argument <code>convert</code> in function <code>readNWISDaily</code>
is set to FALSE. This can cause confusion if you are not careful. For
all functions that provide output, you can define two arguments to set
the output units: qUnit and fluxUnit. qUnit and fluxUnit are defined by
either a numeric code or name. You can call two functions that can be
called to see the options: <code>printqUnitCheatSheet</code> and
<code>printFluxUnitCheatSheet</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/printqUnitCheatSheet.html">printqUnitCheatSheet</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The following codes apply to the qUnit list:</span></span>
<span><span class="co">## 1 =  cfs  ( Cubic Feet per Second )</span></span>
<span><span class="co">## 2 =  cms  ( Cubic Meters per Second )</span></span>
<span><span class="co">## 3 =  thousandCfs  ( Thousand Cubic Feet per Second )</span></span>
<span><span class="co">## 4 =  thousandCms  ( Thousand Cubic Meters per Second )</span></span></code></pre>
<p>When a function has an input argument qUnit, you can define the
discharge units that will be used in the figure or table that is
generated by the function with the index (1-4) as shown above. Base your
choice on the units that are customary for your intended audience, but
also so that the discharge values don’t have too many digits to the
right or left of the decimal point.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/printFluxUnitCheatSheet.html">printFluxUnitCheatSheet</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The following codes apply to the fluxUnit list:</span></span>
<span><span class="co">## 1 =  poundsDay  ( pounds/day )</span></span>
<span><span class="co">## 2 =  tonsDay  ( tons/day )</span></span>
<span><span class="co">## 3 =  kgDay  ( kg/day )</span></span>
<span><span class="co">## 4 =  thousandKgDay  ( thousands of kg/day )</span></span>
<span><span class="co">## 5 =  tonsYear  ( tons/year )</span></span>
<span><span class="co">## 6 =  thousandTonsYear  ( thousands of tons/year )</span></span>
<span><span class="co">## 7 =  millionTonsYear  ( millions of tons/year )</span></span>
<span><span class="co">## 8 =  thousandKgYear  ( thousands of kg/year )</span></span>
<span><span class="co">## 9 =  millionKgYear  ( millions of kg/year )</span></span>
<span><span class="co">## 10 =  billionKgYear  ( billions of kg/year )</span></span>
<span><span class="co">## 11 =  thousandTonsDay  ( thousands of tons/day )</span></span>
<span><span class="co">## 12 =  millionKgDay  ( millions of kg/day )</span></span>
<span><span class="co">## 13 =  kgYear  ( kg/year )</span></span></code></pre>
<p>When a function has an input argument fluxUnit, you can define the
flux units with the index (1-12) as shown above. Base the choice on the
units that are customary for your intended audience, but also so that
the flux values don’t have too many digits to the right or left of the
decimal point. Tons are always “short tons” and not “metric tons”.</p>
<p>Note that when the analysis being done is for a single month or
season (see discussion of “Period of Analysis” in <a href="#flowHistory">Flow History</a> that the flux values represent a
rate (mass per unit time). Thus, if the period of analysis is the
combination of April and May, then a reported flux of 1000 kg/year
translates to a mass of 1000 * 61 / 365.25 = 167 kg. Thus, in general,
if the flux is reported as a mass per year, then to get a mass for the
season that value should be multiplied by the number of days in the
season and then divided by 365.25.</p>
</div>
<div class="section level2">
<h2 id="flowHistory">Flow History<a class="anchor" aria-label="anchor" href="#flowHistory"></a>
</h2>
<p>This section describes functions included in the EGRET package that
provide a variety of table and graphical outputs for examining discharge
statistics based on time-series smoothing. These functions are designed
for studies of long-term change and work best for daily discharge data
sets of 50 years or longer. This type of analysis might be useful for
studying issues such as the influence of land use change, water
management change, or climate change on discharge conditions. This
includes potential impacts on average discharges, high discharges, and
low discharges, at annual time scales as well as seasonal or monthly
time scales.</p>
<p>Consider this example from Columbia River at The Dalles, OR.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"14105700"</span>  </span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">""</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Columbia River at The Dalles, OR"</span></span>
<span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p>You first must determine the period of analysis to use (PA). What is
the period of analysis? If you want to examine your data set as a time
series of water years, then the period of analysis is October through
September. If you want to examine the data set as calendar years then
the period of analysis is January through December. You might want to
examine the winter season, which you could define as December through
February, then those 3 months become the period of analysis. The only
constraints on the definition of a period of analysis are these: it must
be defined in terms of whole months; it must be a set of contiguous
months (like March-April-May), and have a length that is no less than 1
month and no more than 12 months. Define the PA by using two arguments:
paLong and paStart. paLong is the length of the PA, and paStart is the
first month of the PA.</p>
<table class="table">
<caption>Period of Analysis Information</caption>
<thead><tr class="header">
<th align="left">Period of Analysis</th>
<th align="right">paStart</th>
<th align="right">paLong</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Calendar Year</td>
<td align="right">1</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">Water Year</td>
<td align="right">10</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Winter</td>
<td align="right">12</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">September</td>
<td align="right">9</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>To set a period running from December through February:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPA.html">setPA</a></span><span class="op">(</span><span class="va">eList</span>,paStart<span class="op">=</span><span class="fl">12</span>,paLong<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>To set the default value (water year):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPA.html">setPA</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<p>The next step can be to create the annual series of discharge
statistics. These are returned in a matrix that contain the statistics
described below. The statistics are based on the period of analysis set
with the <code>setPA</code> function.</p>
<table class="table">
<caption>Index of discharge statistics information</caption>
<thead><tr class="header">
<th align="right">istat</th>
<th align="right">Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">minimum 1-day daily mean discharg</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">minimum 7-day mean of the daily mean discharges</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">minimum 30-day mean of the daily mean discharges</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">median of the daily mean discharges</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">mean of the daily mean discharges</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">maximum 30-day mean of the daily mean discharges</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">maximum 7-day mean of the daily mean discharges</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">maximum 1-day daily mean discharge</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="plotOptions">Plotting Options<a class="anchor" aria-label="anchor" href="#plotOptions"></a>
</h3>
<p>This section shows examples of the available plots appropriate for
studying discharge history. The plots here use the default variable
input options. For any function, you can get a complete list of input
variables (as described in the <a href="#flowHistoryVariables">flow
history</a> section) in a help file by typing a ? before the function
name in the R console. The EGRET user guide has more detailed
information for each plot type (<a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">https://pubs.usgs.gov/tm/04/a10/</a>).
Finally, see the <a href="#savingPlots">saving plots</a> section for
information on saving plots.</p>
<p>The simplest way to look at these time series is with the function
<code>plotFlowSingle</code>. The statistic index (istat) must be defined
by the user, but for all other arguments there are default values so the
user isn’t required to specify anything else. To see a list of these
optional arguments and other information about the function, type
<code><a href="../reference/plotFlowSingle.html">?plotFlowSingle</a></code> in the R console. All of the graphs in
<code>plotFlowSingle</code>, <code>plotFourStats</code>, and all but one
of the graphs in plotFour, show both the individual annual values of the
selected discharge statistic (e.g. the annual mean or 7-day minimum),
but they also show a curve that is a smooth fit to those data. The curve
is a LOWESS (locally weighted scatterplot smooth). The algorithm for
computing it is provided in the User Guide (<a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">https://pubs.usgs.gov/tm/04/a10/</a>),
in the section titled “The Smoothing Method Used in Flow History
Analyses.” The default is that the annual values of the selected
discharge statistics are smoothed with a “half-window width” of 20
years. The smoothing window is an optional user-defined option.</p>
<p><code>plotSDLogQ</code> produces a graphic of the running standard
deviation of the log of daily discharge over time to visualize how
variability of daily discharge is changing over time. By using the
standard deviation of the log discharge the statistic becomes
dimensionless. The standard deviation plot is a way of looking at
variability quite aside from average values, so, in the case of a system
where discharge might be increasing over a period of years, this graphic
provides a way of looking at the variability relative to that changing
mean value. The standard deviation of the log discharge is much like a
coefficient of variation, but it has sample properties that make it a
smoother measure of variability. People often comment about how things
like urbanization or enhanced greenhouse gases in the atmosphere are
bringing about an increase in variability, and this analysis is one way
to explore that idea. <code>plotFour</code>, <code>plotFourStats</code>,
and <code>plot15</code> are all designed to plot several graphs from the
other functions in a single figure.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>, istat<span class="op">=</span><span class="fl">5</span>,qUnit<span class="op">=</span><span class="st">"thousandCfs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSDLogQ.html">plotSDLogQ</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotSingleandSD-1.png" alt="Plots of discharge statistics" width="45%"><img src="EGRET_files/figure-html/plotSingleandSD-2.png" alt="Plots of discharge statistics" width="45%"><p class="caption">
Plots of discharge statistics
</p>
</div>
<p>Here is an example of looking at daily mean discharge for the full
water year and then looking at mean daily discharge for the winter
season only for the Merced River at Happy Isles Bridge in Yosemite
National Park in California. First, we look at the mean daily discharge
for the full year (after having read in the data and metadata):</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merced River at Happy Isles Bridge, CA:</span></span>
<span><span class="va">siteNumber</span><span class="op">&lt;-</span><span class="st">"11264500"</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,startDate<span class="op">=</span><span class="st">""</span>,endDate<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">""</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Merced River at Happy Isles Bridge, CA"</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>, istat<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># Then, we can run the same function, but first set </span></span>
<span><span class="co"># the pa to start in December and only run for 3 months.</span></span>
<span><span class="va">eListMerced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPA.html">setPA</a></span><span class="op">(</span><span class="va">eList</span>,paStart<span class="op">=</span><span class="fl">12</span>,paLong<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eListMerced</span>,istat<span class="op">=</span><span class="fl">5</span>,qMax<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/Mercedplot-1.png" alt="Merced River winter trend" width="45%"><img src="EGRET_files/figure-html/Mercedplot-2.png" alt="Merced River winter trend" width="45%"><p class="caption">
Merced River winter trend
</p>
</div>
<p>What these figures show us is that on an annual basis there is very
little indication of a long-term trend in mean discharge, but for the
winter months there is a pretty strong indication of an upward trend.
This could well be related to the climate warming in the Sierra Nevada,
resulting in a general increase in the ratio of rain to snow in the
winter and more thawing events.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotFour.html">plotFour</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotFour-1.png" alt="plotFour(eListMerced, qUnit=3)" width="100%"><p class="caption">
plotFour(eListMerced, qUnit=3)
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotFourStats.html">plotFourStats</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotFourStats-1.png" alt="plotFourStats(eListMerced, qUnit=3)" width="100%"><p class="caption">
plotFourStats(eListMerced, qUnit=3)
</p>
</div>
<p><code>plotQTimeDaily</code> is simply a time series plot of
discharge. But, it is most suited for showing events above some
discharge threshold. In the simplest case, it can plot the entire
record, but given the line weight and use of an arithmetic scale it
primarily provides a visual focus on the higher values.</p>
<p>The Mississippi example illustrates a very long record with a long
gap of more than 60 years with no discharges above 300,000 cfs, followed
by the last followed by the 49 years from 1965 through 2013 with 6
events above that threshold. <code>plotQTimeDaily</code> requires
startYear and endYear, along with some other optional arguements (see
<code><a href="../reference/plotQTimeDaily.html">?plotQTimeDaily</a></code> for more details).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Mississippi River at Keokuk Iowa:</span></span>
<span><span class="va">siteNumber</span><span class="op">&lt;-</span><span class="st">"05474500"</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,startDate<span class="op">=</span><span class="st">""</span>,endDate<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">INFO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">""</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Mississippi River at Keokuk Iowa"</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.egret.html">as.egret</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotQTimeDaily.html">plotQTimeDaily</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">3</span>,qLower<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/MississippiPlot-1.png" alt="Mississippi River at Keokuk Iowa" width="45%"><p class="caption">
Mississippi River at Keokuk Iowa
</p>
</div>
</div>
<div class="section level3">
<h3 id="tableOptions">Table Options<a class="anchor" aria-label="anchor" href="#tableOptions"></a>
</h3>
<p>Sometimes it is easier to consider results in table formats rather
than graphically. Similar to the function <code>plotFlowSingle</code>,
the <code>printSeries</code> will print the requested discharge
statistics (Table <span class="math inline">\(\ref{table:istat}\)</span>), as well as return the
results in a data frame. A small sample of the output is printed
below.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seriesResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/printSeries.html">printSeries</a></span><span class="op">(</span><span class="va">eList</span>, istat<span class="op">=</span><span class="fl">3</span>, qUnit<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>Mississippi River at Keokuk Iowa
 Water Year
    30-day minimum
    Thousand Cubic Feet per Second
   year   annual   smoothed
           value    value
   1879     22.6     30.1
   1880     31.7     28.7
   1881     23.0     27.5
...
   2011     51.0     32.4
   2012     34.3     32.1
   2013     16.2     31.8</code></pre>
<p>Another way to look at the results is to consider how much the
smoothed values change between various pairs of years. These changes can
be represented in four different ways.</p>
<ul>
<li>As a change between the first and last year of the pair, expressed
in the discharge units selected.</li>
<li>As a change between the first and last year of the pair, expressed
as a percentage of the value in the first year</li>
<li>As a slope between the first and last year of the pair, expressed in
terms of the discharge units per year.</li>
<li>As a slope between the first and last year of the pair, expressed as
a percentage change per year (a percentage based on the value in the
first year).</li>
</ul>
<p>Another argument can be very useful in this function: yearPoints. In
the default case, the set of years that are compared are at 5 year
intervals along the whole data set. If the data set was quite long this
can be a daunting number of comparisons. For example, in an 80 year
record, there would be 136 such pairs. Instead, we could look at changes
between only 3 year points: 1890, 1950, and 2010:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tableFlowChange.html">tableFlowChange</a></span><span class="op">(</span><span class="va">eList</span>, istat<span class="op">=</span><span class="fl">3</span>, qUnit<span class="op">=</span><span class="fl">3</span>,yearPoints<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1890</span>,<span class="fl">1950</span>,<span class="fl">2010</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Mississippi River at Keokuk Iowa</span></span>
<span><span class="co">##    Water Year</span></span>
<span><span class="co">##     30-day minimum </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Streamflow Trends</span></span>
<span><span class="co">##    time span          change        slope       change        slope</span></span>
<span><span class="co">##                      10^3 cfs   10^3cfs/yr        %            %/yr</span></span>
<span><span class="co">##  1890  to  1950         0.84        0.014          3.7        0.061</span></span>
<span><span class="co">##  1890  to  2010          9.5         0.08           41         0.35</span></span>
<span><span class="co">##  1950  to  2010          8.7         0.15           36         0.61</span></span></code></pre>
<p>See <a href="#createWordTable">here</a> for instructions on
converting an R data frame to a table in Microsoft™ software. Excel,
Microsoft, PowerPoint, Windows, and Word are registered trademarks of
Microsoft Corporation in the United States and other countries.</p>
</div>
</div>
<div class="section level2">
<h2 id="wqa">Summary of Water Quality Data (without using WRTDS)<a class="anchor" aria-label="anchor" href="#wqa"></a>
</h2>
<p>Before you run the WRTDS model, it is helpful to examine the measured
water quality data graphically to better understand its behavior,
identify possible data errors, and visualize the temporal distribution
of the data (identify gaps). It is always best to clear up these issues
before moving forward.</p>
<p>The examples below use the Choptank River at Greensboro, MD. The
Choptank River is a small tributary of the Chesapeake Bay. Inorganic
nitrogen (nitrate and nitrite) has been measured from 1979 onward.
First, we need to load the discharge and nitrate data into R. Before we
can graph or use it for WRTDS analysis, we must bring the discharge data
into the Sample data frame. We do this by using the
<code>mergeReport</code> function which merges the discharge information
and also provides a compact report about some major features of the data
set.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Choptank River at Greensboro, MD:</span></span>
<span><span class="va">siteNumber</span> <span class="op">&lt;-</span> <span class="st">"01491000"</span> </span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="st">"1979-10-01"</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="st">"2011-09-30"</span></span>
<span><span class="va">param</span><span class="op">&lt;-</span><span class="st">"00631"</span></span>
<span><span class="va">Daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISDaily.html">readNWISDaily</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="st">"00060"</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/INFOdataframe.html">readNWISInfo</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">param</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">INFO</span><span class="op">$</span><span class="va">shortName</span> <span class="op">&lt;-</span> <span class="st">"Choptank River"</span></span>
<span></span>
<span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWISSample.html">readNWISSample</a></span><span class="op">(</span><span class="va">siteNumber</span>,<span class="va">param</span>,<span class="va">startDate</span>,<span class="va">endDate</span><span class="op">)</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mergeReport.html">mergeReport</a></span><span class="op">(</span><span class="va">INFO</span>, <span class="va">Daily</span>, <span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="plotOptionsWQ">Plotting Options<a class="anchor" aria-label="anchor" href="#plotOptionsWQ"></a>
</h3>
<p>This section shows examples of the available plots appropriate for
analyzing data prior to performing a WRTDS analysis. The plots here use
the default variable input options. For any function, you can get a
complete list of input variables in a help file by typing a ? before the
function name in the R console. See <a href="#wqVariables">Water Quality
Plotting Input</a> for information on the available input variables for
these plotting functions.</p>
<p>Note that for any of the plotting functions that show the sample
data, if a value in the data set is a non-detect (censored), it is
displayed on the graph as a vertical line. The top of the line is the
reporting limit and the bottom is either zero, or if the graph is
plotting log concentration values the minimum value on the y-axis. This
line is an “honest” representation of what we know about about that
observation and doesn’t attempt to use a statistical model to make an
estimate below the reporting limit.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/boxConcMonth.html">boxConcMonth</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/boxQTwice.html">boxQTwice</a></span><span class="op">(</span><span class="va">eList</span>,qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotBoxes-1.png" alt="Concentration box plots" width="45%"><img src="EGRET_files/figure-html/plotBoxes-2.png" alt="Concentration box plots" width="45%"><p class="caption">
Concentration box plots
</p>
</div>
<p>Note that the statistics to create the boxplot in
<code>boxQTwice</code> are performed after the data are
log-transformed.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/plotConcTime.html">plotConcTime</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotConcTime-1.png" alt="The relation of concentration vs time or discharge" width="45%"><img src="EGRET_files/figure-html/plotConcTime-2.png" alt="The relation of concentration vs time or discharge" width="45%"><p class="caption">
The relation of concentration vs time or discharge
</p>
</div>
<p>It is interesting to note the change in the convention for rounding
of data values that occurred around 1995.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/plotFluxQ.html">plotFluxQ</a></span><span class="op">(</span><span class="va">eList</span>, fluxUnit<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotFluxQ-1.png" alt="The relation of flux vs discharge" width="45%"><p class="caption">
The relation of flux vs discharge
</p>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/multiPlotDataOverview.html">multiPlotDataOverview</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/multiPlotDataOverview-1.png" alt="multiPlotDataOverview(eList, qUnit=1)" width="100%"><p class="caption">
multiPlotDataOverview(eList, qUnit=1)
</p>
</div>
<p>The <code>multiPlotDataOverview</code> function uses a log scale as
default. To change the concentration axes to an arithmetic scale, use
<code>logScaleConc=FALSE</code> in the
<code>multiPlotDataOverview</code> function call.</p>
</div>
<div class="section level3">
<h3 id="tableOptionsWQ">Table Options<a class="anchor" aria-label="anchor" href="#tableOptionsWQ"></a>
</h3>
<p>Another useful tool for checking the data before running the WRTDS
estimations is <code>flowDuration</code>. This is a utility function
that can help you define the discharge ranges that we want to explore.
It prints out key points on the discharge duration curve. Define the
points for a particular part of the year using the
<code>centerDate</code> and <code>span</code> arguments, although the
points can be defined for the entire year (default).</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flowDuration.html">flowDuration</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Flow Duration for Choptank River </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Flow duration is based on full year</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Discharge units are Cubic Feet per Second</span></span></code></pre>
<pre><code><span><span class="co">##     min      5%     10%     25%     50%     75%     90%     95%     max </span></span>
<span><span class="co">##    0.35   12.00   16.00   33.00   85.00  163.00  290.00  462.00 8700.00</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flowDuration.html">flowDuration</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span>, centerDate<span class="op">=</span><span class="st">"09-30"</span>, span<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Flow Duration for Choptank River </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Flow duration period is centered on September 30 </span></span>
<span><span class="co">## And spans the period from August 31  To October 30</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Discharge units are Cubic Feet per Second</span></span></code></pre>
<pre><code><span><span class="co">##    min     5%    10%    25%    50%    75%    90%    95%    max </span></span>
<span><span class="co">##    2.5    8.8   11.0   15.0   27.0   67.0  138.0  223.0 5600.0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="wrtds">Weighted Regressions on Time, Discharge and Season (WRTDS)<a class="anchor" aria-label="anchor" href="#wrtds"></a>
</h2>
<p>WRTDS creates a model of the behavior of concentration as a function
of three components: time trend, discharge, and season. You can use
WRTDS to estimate annual or seasonal mean concentrations and fluxes as
well as describe long-term trends in the behavior of the system. In this
section, we will step though the process required for a WRTDS analysis.
<a href="#wrtdsResults">WRTDS Results</a> provides details about the
available methods for viewing and evaluating the model results.</p>
<p>Once you have looked at your data using the tools described in <a href="#wqa">Summary of Water Quality Data</a>, and have determined there
are sufficient representative data, it is time to run the WRTDS model.
Assuming you are using the defaults, with data frames called Daily,
Sample, and INFO, the <code>modelEstimation</code> function runs the
WRTDS modeling algorithm:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelEstimation.html">modelEstimation</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<p>Details of the options available when running
<code>modelEstimation</code> can be found in <a href="#wrtdsInputVariables">WRTDS Estimation Input</a>. This function is
slow, and shows the progress in percent complete. See the references and
manual for more information. It’s important to understand that this is
the one function that will globally change your Daily, Sample, and INFO
data frames. It also creates a new matrix <code>surfaces</code>, and a
new data frame <code>AnnualResults</code>.</p>
<p>Finally, it is a good idea to save your results because of the
computational time that has been invested in producing these results.
The workspace is saved to a directory that you designate savePath and
the file name is determined by the abbreviations for station and
constituent that were required entries when the
<code>readNWISInfo</code> function was used. The command for saving the
workspace is:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#An example directory name</span></span>
<span><span class="va">savePath</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/egretUser/WRTDS_Output/"</span> </span>
<span><span class="fu"><a href="../reference/saveResults.html">saveResults</a></span><span class="op">(</span><span class="va">savePath</span>, <span class="va">eList</span><span class="op">)</span> </span></code></pre></div>
<p>This saves all of the objects in your workspace. If you have saved
workspaces from R versions earlier than 3.0, a warning will appear when
you open them in R 3.0 (or later). Re-saving the workspace using R 3.0
(or later) should get rid of the warning.</p>
<p>Using <code>saveResults</code>, the workspace is saved with
<code>INFO$staAbbrev</code> and <code>INFO$constitAbbrev</code> as the
filename (separated by a period), and the extension .RData. So, if
staAbbrev was “Chop” and the constitAbbrev was “NO3” the file name would
be “Chop.NO3.RData”. To load the data in some future session the
commands could be:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loadPath</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/egretUser/WRTDS_Output/"</span></span>
<span><span class="va">staAbbrev</span> <span class="op">&lt;-</span> <span class="st">"Chop"</span></span>
<span><span class="va">constitAbbrev</span> <span class="op">&lt;-</span> <span class="st">"NO3"</span></span>
<span><span class="va">pathToFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">loadPath</span>,<span class="va">staAbbrev</span>,<span class="st">"."</span>,</span>
<span>                    <span class="va">constitAbbrev</span>,<span class="st">".RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">pathToFile</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wrtdsResults">WRTDS Results<a class="anchor" aria-label="anchor" href="#wrtdsResults"></a>
</h2>
<p>At this point (after having run <code>modelEstimation</code>) we can
start considering how to view the annual averages for the variables that
have been calculated. See <a href="#wrtdsOutputVariables">Post-WRTDS
Plotting Input</a> for common input variables for these functions.
Additionally, check the help files (in the R console, type ? followed by
the function name).</p>
<div class="section level3">
<h3 id="wrtdsPlotting">Plotting Options<a class="anchor" aria-label="anchor" href="#wrtdsPlotting"></a>
</h3>
<p>Check the help files or manual for more details on the following
functions. See <a href="#savingPlots">Saving Plots</a> for information
on saving plots. In these examples, we will return to looking at the
data in the water year by using the <code>setPA</code> function. Most
plotting functions will use the period of analysis information in the
INFO data frame to determine what data are plotted. There are only four
graph or table functions that don’t allow the user to specify a Period
of Analysis (PA). These are: <code>plotContour</code>,
<code>plotDiffContour</code>, <code>plotConcTimeSmooth</code>,
<code>plotConcQSmooth</code>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return to water year:</span></span>
<span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPA.html">setPA</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span></span>
<span><span class="va">yearStart</span> <span class="op">&lt;-</span> <span class="fl">2008</span></span>
<span><span class="va">yearEnd</span> <span class="op">&lt;-</span> <span class="fl">2010</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotConcTimeDaily.html">plotConcTimeDaily</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">yearStart</span>, <span class="va">yearEnd</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxTimeDaily.html">plotFluxTimeDaily</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">yearStart</span>, <span class="va">yearEnd</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotConcTimeDaily-1.png" alt="Concentration and flux vs time" width="45%"><img src="EGRET_files/figure-html/plotConcTimeDaily-2.png" alt="Concentration and flux vs time" width="45%"><p class="caption">
Concentration and flux vs time
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotConcPred.html">plotConcPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxPred.html">plotFluxPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotFluxPred-1.png" alt="Concentration and flux predictions" width="45%"><img src="EGRET_files/figure-html/plotFluxPred-2.png" alt="Concentration and flux predictions" width="45%"><p class="caption">
Concentration and flux predictions
</p>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResidPred.html">plotResidPred</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotResidQ.html">plotResidQ</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotResidQ-1.png" alt="Residuals" width="45%"><img src="EGRET_files/figure-html/plotResidQ-2.png" alt="Residuals" width="45%"><p class="caption">
Residuals
</p>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResidTime.html">plotResidTime</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boxResidMonth.html">boxResidMonth</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/boxResidMonth-1.png" alt="Residuals with respect to time" width="45%"><img src="EGRET_files/figure-html/boxResidMonth-2.png" alt="Residuals with respect to time" width="45%"><p class="caption">
Residuals with respect to time
</p>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boxConcThree.html">boxConcThree</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/boxConcThree-1.png" alt="Default boxConcThree(eList)" width="45%"><p class="caption">
Default boxConcThree(eList)
</p>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotConcHist.html">plotConcHist</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxHist.html">plotFluxHist</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotFluxHist-1.png" alt="Concentration and flux history" width="45%"><img src="EGRET_files/figure-html/plotFluxHist-2.png" alt="Concentration and flux history" width="45%"><p class="caption">
Concentration and flux history
</p>
</div>
<p>The placement of the legend is controlled by legendLeft and
legendTop. If both are set to 0 (the default values), the legend is
placed near the lower left corner of the graphic. Otherwise, the value
specified for legendLeft places the left edge of the legend, and
legendTop specifies the top edge of the legend. The units for legendLeft
and legendTop are discharge (in units specified by qUnit) and
concentration, respectively. The legend can also be turned off with
printLegend=FALSE. These are also functions that do not recognize the
period of analysis in the INFO data frame. However, by choosing
centering dates and appropriate half-windows, seasonal behavior can
easily be observed in these plots.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-line plots:</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="st">"1985-09-01"</span></span>
<span><span class="va">date2</span> <span class="op">&lt;-</span> <span class="st">"1997-09-01"</span></span>
<span><span class="va">date3</span> <span class="op">&lt;-</span> <span class="st">"2010-09-01"</span></span>
<span><span class="va">qBottom</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">qTop</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="fu"><a href="../reference/plotConcQSmooth.html">plotConcQSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">date1</span>, <span class="va">date2</span>, <span class="va">date3</span>, <span class="va">qBottom</span>, <span class="va">qTop</span>, </span>
<span>                   concMax<span class="op">=</span><span class="fl">2</span>,legendTop <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotConcQSmooth.html">plotConcQSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">date1</span>, <span class="va">date2</span>, <span class="va">date3</span>,</span>
<span>                <span class="va">qBottom</span>, <span class="va">qTop</span>, legendTop <span class="op">=</span> <span class="fl">0.5</span>,logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotConcQSmooth-1.png" alt="Concentration vs. discharge" width="45%"><img src="EGRET_files/figure-html/plotConcQSmooth-2.png" alt="Concentration vs. discharge" width="45%"><p class="caption">
Concentration vs. discharge
</p>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">q2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">q3</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">centerDate</span> <span class="op">&lt;-</span> <span class="st">"07-01"</span></span>
<span><span class="va">yearEnd</span> <span class="op">&lt;-</span> <span class="fl">1980</span></span>
<span><span class="va">yearStart</span> <span class="op">&lt;-</span> <span class="fl">2010</span></span>
<span><span class="fu"><a href="../reference/plotConcTimeSmooth.html">plotConcTimeSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">centerDate</span>, </span>
<span>                   <span class="va">yearStart</span>, <span class="va">yearEnd</span>, legendTop <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotConcTimeSmooth.html">plotConcTimeSmooth</a></span><span class="op">(</span><span class="va">eList</span>, <span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">centerDate</span>, </span>
<span>                   <span class="va">yearStart</span>, <span class="va">yearEnd</span>, </span>
<span>                   legendTop <span class="op">=</span> <span class="fl">0.4</span>,logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotConcTimeSmooth-1.png" alt="plotConcTimeSmooth(eList)" width="45%"><img src="EGRET_files/figure-html/plotConcTimeSmooth-2.png" alt="plotConcTimeSmooth(eList)" width="45%"><p class="caption">
plotConcTimeSmooth(eList)
</p>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fluxBiasMulti.html">fluxBiasMulti</a></span><span class="op">(</span><span class="va">eList</span>, qUnit<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/fluxBiasMulti-1.png" alt="fluxBiasMulti(eList, qUnit=1)" width="100%"><p class="caption">
fluxBiasMulti(eList, qUnit=1)
</p>
</div>
<p>The contour plot functions also do not recognize the PA from the INFO
data frame. They represent the overall results of the WRTDS analysis. To
specify <code>contourLevels</code> in the contour plots use the
<code>seq</code> function (type <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">?seq</a></code> for details). In
general, use of the <code>seq</code> function would look like this:
<code>contourLevels = seq(from,to,by)</code>. In the example shown above
we are requesting contour levels that run from 0 to 2 in steps of
0.2.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clevel</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotContours.html">plotContours</a></span><span class="op">(</span><span class="va">eList</span>, yearStart<span class="op">=</span><span class="fl">1980</span>,yearEnd<span class="op">=</span><span class="fl">2010</span>,qBottom<span class="op">=</span><span class="fl">0.5</span>,qTop<span class="op">=</span><span class="fl">20</span>, </span>
<span>             contourLevels <span class="op">=</span> <span class="va">clevel</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotContours-1.png" alt="plotContours(eList)" width="100%"><p class="caption">
plotContours(eList)
</p>
</div>
<p>The function <code>plotDiffContours</code> plots the difference
between two selected years (year0 and year1). It can help clarify what
combinations of seasons and flow conditions have been showing increases
and decreases over the period covered.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDiffContours.html">plotDiffContours</a></span><span class="op">(</span><span class="va">eList</span>, year0<span class="op">=</span><span class="fl">1990</span>,year1<span class="op">=</span><span class="fl">2010</span>,</span>
<span>                 qBottom<span class="op">=</span><span class="fl">0.5</span>,qTop<span class="op">=</span><span class="fl">20</span>,maxDiff<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotDiffContours-1.png" alt="plotDiffContours(eList)" width="100%"><p class="caption">
plotDiffContours(eList)
</p>
</div>
</div>
<div class="section level3">
<h3 id="wrtdsTable">Table Options<a class="anchor" aria-label="anchor" href="#wrtdsTable"></a>
</h3>
<p>Sometimes it is easier to consider the results in table form rather
than graphically. The function `tableResults} produces a simple text
table that contains the annual values for the results. Each row of the
output represents a year and includes: year, average discharge, average
concentration, flow-normalized concentration, average flux, and
flow-normalized flux. If paLong != 12 make sure you take note of the
explanation of the seasonal flux values discussed at the end of <a href="#units">Units</a>. A small sample of the output is printed
below.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tableResults.html">tableResults</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="va">returnDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableResults.html">tableResults</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<pre><code>   Choptank River 
   Inorganic nitrogen (nitrate and nitrite)
   Water Year 

   Year   Discharge    Conc    FN_Conc     Flux    FN_Flux
             cms            mg/L             10^6 kg/yr 
   1980      4.25     0.949     1.003    0.1154     0.106
   1981      2.22     1.035     0.999    0.0675     0.108
...
   2010      7.19     1.323     1.438    0.2236     0.149
   2011      5.24     1.438     1.457    0.1554     0.148</code></pre>
<table class="table">
<caption>Table created from <code>head(returnDF)</code>
</caption>
<colgroup>
<col width="5%">
<col width="18%">
<col width="14%">
<col width="17%">
<col width="20%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="right">Year</th>
<th align="right">Discharge [cms]</th>
<th align="right">Conc [mg/L]</th>
<th align="right">FN Conc [mg/L]</th>
<th align="right">Flux [10^6kg/yr]</th>
<th align="right">FN Flux [10^6kg/yr]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1980</td>
<td align="right">4</td>
<td align="right">0.95</td>
<td align="right">1.003</td>
<td align="right">0.115</td>
<td align="right">0.106</td>
</tr>
<tr class="even">
<td align="right">1981</td>
<td align="right">2</td>
<td align="right">1.03</td>
<td align="right">0.999</td>
<td align="right">0.068</td>
<td align="right">0.108</td>
</tr>
<tr class="odd">
<td align="right">1982</td>
<td align="right">3</td>
<td align="right">1.04</td>
<td align="right">0.993</td>
<td align="right">0.098</td>
<td align="right">0.110</td>
</tr>
<tr class="even">
<td align="right">1983</td>
<td align="right">5</td>
<td align="right">1.01</td>
<td align="right">0.993</td>
<td align="right">0.133</td>
<td align="right">0.112</td>
</tr>
<tr class="odd">
<td align="right">1984</td>
<td align="right">6</td>
<td align="right">0.99</td>
<td align="right">1.002</td>
<td align="right">0.160</td>
<td align="right">0.114</td>
</tr>
<tr class="even">
<td align="right">1985</td>
<td align="right">2</td>
<td align="right">1.06</td>
<td align="right">1.017</td>
<td align="right">0.049</td>
<td align="right">0.116</td>
</tr>
</tbody>
</table>
<p>The other table option is <code>tableChange</code>. This is a
function that provides for the computation of changes or slopes between
any selected pairs of time points. These computations are made only on
the flow-normalized results. A detailed explaination of
“flow-normalized” result is in the official EGRET user guide.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tableChange.html">tableChange</a></span><span class="op">(</span><span class="va">eList</span>, yearPoints<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>,<span class="fl">2005</span>,<span class="fl">2010</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Choptank River </span></span>
<span><span class="co">##    Inorganic nitrogen (nitrate and nitrite)</span></span>
<span><span class="co">##    Water Year </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##            Concentration trends</span></span>
<span><span class="co">##    time span       change     slope    change     slope</span></span>
<span><span class="co">##                      mg/L   mg/L/yr        %       %/yr</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  2000  to  2005     0.088     0.018         7       1.4</span></span>
<span><span class="co">##  2000  to  2010      0.19     0.019        15       1.5</span></span>
<span><span class="co">##  2005  to  2010     0.098      0.02       7.3       1.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                  Flux Trends</span></span>
<span><span class="co">##    time span          change        slope       change        slope</span></span>
<span><span class="co">##                   10^6 kg/yr    10^6 kg/yr /yr      %         %/yr</span></span>
<span><span class="co">##  2000  to  2005       0.0065       0.0013          4.7         0.93</span></span>
<span><span class="co">##  2000  to  2010       0.0097      0.00097          6.9         0.69</span></span>
<span><span class="co">##  2005  to  2010       0.0032      0.00063          2.2         0.43</span></span></code></pre>
<p>Finally, <code>tableChangeSingle</code> operates exactly the same as
<code>tableChange</code> except for the addition argument flux. This
function provides either concentration results or flux results, but not
both. This can be useful when you are producing many output tables for a
report that is entirely focused on concentration or one that is entirely
focused on flux. The arguments are identical to those for tableChange,
except for the final two arguments. The argument <code>flux</code>
defaults to TRUE. When flux=TRUE the output is only for flux, and when
flux=FALSE the output is only for concentration. See <a href="#createWordTable">Creating tables</a> for instructions on
converting an R data frame to a table in Microsoft™ software.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">returnDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableChange.html">tableChangeSingle</a></span><span class="op">(</span><span class="va">eList</span>, yearPoints<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>,<span class="fl">2005</span>,<span class="fl">2010</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table created from <code>tableChangeSingle</code>
function</caption>
<thead><tr class="header">
<th align="right">Year1</th>
<th align="right">Year2</th>
<th align="right">change[mg/L]</th>
<th align="right">slope[mg/L/yr]</th>
<th align="right">change[%]</th>
<th align="right">slope [%/yr]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2000</td>
<td align="right">2005</td>
<td align="right">0</td>
<td align="right">0.018</td>
<td align="right">7.0</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="right">2010</td>
<td align="right">0</td>
<td align="right">0.019</td>
<td align="right">15.0</td>
<td align="right">1.5</td>
</tr>
<tr class="odd">
<td align="right">2005</td>
<td align="right">2010</td>
<td align="right">0</td>
<td align="right">0.020</td>
<td align="right">7.3</td>
<td align="right">1.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="extendedPlots">Extending Plots Past Defaults<a class="anchor" aria-label="anchor" href="#extendedPlots"></a>
</h2>
<p>The basic plotting options were shown in the section <a href="#wrtdsResults">WRTDS Results</a>. This section demonstrates some
ways to extend the capabilities of the EGRET plots. EGRET plots use R’s
basic plotting options. You set many of the formatting details of
plotting routines in R by using “Graphical Parameters”. To read about
all of these graphical parameters see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">?par</a></code>. When the
graphical functions in EGRET are coded, a set of default values for many
of these parameters are chosen, but you can override all of these
default values. Additionally, you can add features to a plot after
calling the plot function. To change the plot margins (mar), font, or
other graphical parameters initially assigned, set the argument
customPar to TRUE.</p>
<p>A few of R’s base graphical parameters are especially useful within
the plot functions.</p>
<table class="table">
<caption>Useful plotting parameters to adjust in EGRET plotting
functions. For details of any of these see ?par.</caption>
<colgroup>
<col width="21%">
<col width="56%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Description</th>
<th align="right">Values</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cex</td>
<td align="right">Size of data point symbols, relative to default</td>
<td align="right">decimal number</td>
</tr>
<tr class="even">
<td align="left">cex.main</td>
<td align="right">Size of font for plot title, relative to default</td>
<td align="right">decimal number</td>
</tr>
<tr class="odd">
<td align="left">cex.lab</td>
<td align="right">Size of font for axis label text, relative to
default</td>
<td align="right">decimal number</td>
</tr>
<tr class="even">
<td align="left">cex.axis</td>
<td align="right">Size of font for axis annotation (numbers), relative
to default</td>
<td align="right">decimal number</td>
</tr>
<tr class="odd">
<td align="left">col</td>
<td align="right">Color of data point symbols or lines</td>
<td align="right">color name in <code>"}"</code>
</td>
</tr>
<tr class="even">
<td align="left">lwd</td>
<td align="right">Width of lines, relative to default</td>
<td align="right">decimal number</td>
</tr>
<tr class="odd">
<td align="left">pch</td>
<td align="right">Type of symbol to use for data points</td>
<td align="right">integer values</td>
</tr>
<tr class="even">
<td align="left">lty</td>
<td align="right">Line type number (such as dash or dot)</td>
<td align="right">integer values</td>
</tr>
</tbody>
</table>
<p>After the plot is made, many other functions that might be useful to
call, such as to add text, legend, lines, etc.</p>
<table class="table">
<caption>Useful functions to add on to default plots. Type ? then the
function name to get help on the individual function.</caption>
<thead><tr class="header">
<th align="left">Function</th>
<th align="right">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mtext</td>
<td align="right">add text based on specified side of plot</td>
</tr>
<tr class="even">
<td align="left">text</td>
<td align="right">add text to a specific point on plot</td>
</tr>
<tr class="odd">
<td align="left">legend</td>
<td align="right">add a legend</td>
</tr>
<tr class="even">
<td align="left">grid</td>
<td align="right">add grid</td>
</tr>
<tr class="odd">
<td align="left">abline</td>
<td align="right">add line</td>
</tr>
<tr class="even">
<td align="left">arrows</td>
<td align="right">add arrow</td>
</tr>
</tbody>
</table>
<p>Some basic examples are shown below.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, cex.axis<span class="op">=</span><span class="fl">2</span>,cex.main<span class="op">=</span><span class="fl">1.5</span>,logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, cex.lab<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">2</span>,logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/adjustSize-1.png" alt="Modifying text and point size, as shown using the `plotConcQ` function" width="45%"><img src="EGRET_files/figure-html/adjustSize-2.png" alt="Modifying text and point size, as shown using the `plotConcQ` function" width="45%"><p class="caption">
Modifying text and point size, as shown using the <code>plotConcQ</code>
function
</p>
</div>
<p>First, the margin is adjusted to c(8,8,8,8), requiring customPar set
to TRUE. The margin vector represents the margin spacing of the 4
<code>sides</code> of a plot in the order: bottom, left, top, right.
Next, the text labels were adjusted, color set to <code>"blue"</code>,
point and line size increased, and the point type changed form a solid
circle(pch=20) to solid diamond (pch=18). A grid, legend, arrow, and
text are added after the plot is produced.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">8</span>,<span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, customPar<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="st">"blue"</span>,cex<span class="op">=</span><span class="fl">1.1</span>,</span>
<span>          cex.axis<span class="op">=</span><span class="fl">1.4</span>,cex.main<span class="op">=</span><span class="fl">1.5</span>,cex.lab<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>          pch<span class="op">=</span><span class="fl">18</span>,lwd<span class="op">=</span><span class="fl">2</span>,logScale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">.09</span>,<span class="st">"Choptank Nitrogen"</span>, pch<span class="op">=</span><span class="fl">18</span>, col<span class="op">=</span><span class="st">"blue"</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.14</span>, <span class="fl">1</span>, <span class="fl">.05</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">.14</span>,<span class="st">"Censored Value"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/plotConcQComparison-1.png" alt="Modified `plotConcQ`" width="45%"><img src="EGRET_files/figure-html/plotConcQComparison-2.png" alt="Modified `plotConcQ`" width="45%"><p class="caption">
Modified <code>plotConcQ</code>
</p>
</div>
<p>Only a few fonts are consistent on all operating systems. The
following figure shows how to change to the Serif font, as well as how
to use the mtext function. To see the available fonts for pdf output on
your computer, type <code>names(pdfFonts())</code>.The available fonts
are quite limited in base R. To expand the font choices, a useful R
library, “extrafont” can help.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Switching to serif font:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>family<span class="op">=</span><span class="st">"serif"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxPred.html">plotFluxPred</a></span><span class="op">(</span><span class="va">eList</span>, customPar<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">3</span>,line<span class="op">=</span><span class="op">-</span><span class="fl">3</span>,<span class="st">"Serif font example"</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/easyFontChange-1.png" alt="Serif font" width="45%"><p class="caption">
Serif font
</p>
</div>
<p>You can also extend the contour plots. The default y-axis is
determined from qTop and qBottom. Occasionally, you may need to use a
custom axis by specifying yTicks. It is also nice to be able to adjust
the color scheme of the contour plots. There are some color schemes
built into base R such as heat.colors, topo.colors, terrain.colors, and
cm.colors. Alternatively, you can set colors by using the
<code>colorRampPalette</code> function. For example, a black and white
color scheme might be required. In another example, the
<code>plotDiffContours</code> might make more sense to go from yellow to
white for the negative values, and white to blue for the positive
values. Examples are shown below for modifying a contour plot and
modifying a difference contour plot.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yTicksModified</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotContours.html">plotContours</a></span><span class="op">(</span><span class="va">eList</span>, <span class="fl">2001</span>,<span class="fl">2010</span>,<span class="fl">0.5</span>,<span class="fl">50</span>, </span>
<span>             contourLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2.5</span>,<span class="fl">0.5</span><span class="op">)</span>,qUnit<span class="op">=</span><span class="fl">2</span>,</span>
<span>             yTicks<span class="op">=</span><span class="va">yTicksModified</span>,</span>
<span>             color.palette<span class="op">=</span><span class="va">colors</span>,</span>
<span>             flowDuration<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>             tcl<span class="op">=</span><span class="fl">0.2</span>,tick.lwd<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>  </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/modifiedContour1-1.png" alt="Contour plot with modified axis and color scheme" width="100%"><p class="caption">
Contour plot with modified axis and color scheme
</p>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yellow"</span>,<span class="st">"white"</span>,<span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">maxDiff</span><span class="op">&lt;-</span><span class="fl">0.6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotDiffContours.html">plotDiffContours</a></span><span class="op">(</span><span class="va">eList</span>, year0<span class="op">=</span><span class="fl">2001</span>,year1<span class="op">=</span><span class="fl">2010</span>,qBottom<span class="op">=</span><span class="fl">0.5</span>,qTop<span class="op">=</span><span class="fl">50</span>, </span>
<span>             <span class="va">maxDiff</span>,lwd<span class="op">=</span><span class="fl">2</span>,qUnit<span class="op">=</span><span class="fl">2</span>,</span>
<span>             color.palette<span class="op">=</span><span class="va">colors</span>,</span>
<span>             flowDuration<span class="op">=</span><span class="cn">FALSE</span>, customPar<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/modifiedDiffContour-1.png" alt="Difference contour plot with modified color scheme" width="100%"><p class="caption">
Difference contour plot with modified color scheme
</p>
</div>
<p>It is also possible to create custom multi-panel plots. In the
simplest example, you can use the <code>tinyPlot=TRUE</code> option.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.7</span>, <span class="fl">6</span>, <span class="fl">1.7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotFluxQ.html">plotFluxQ</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>          fluxUnit<span class="op">=</span><span class="fl">9</span>,logScale<span class="op">=</span><span class="cn">TRUE</span>,fluxMax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFluxHist.html">plotFluxHist</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,fluxMax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcHist.html">plotConcHist</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,concMax<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Custom multi-pane graph using tinyPlot=TRUE"</span>, outer<span class="op">=</span><span class="cn">TRUE</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/tinyPlot1-1.png" alt="Custom multipanel plot using tinyPlot" width="100%"><p class="caption">
Custom multipanel plot using tinyPlot
</p>
</div>
<p>Finally, the following figure shows a method to create a panel of
plots with a finer control.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">3.5</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="co"># whitespace around the plots</span></span>
<span>    oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, <span class="co"># outer margin</span></span>
<span>    mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>, <span class="co"># spacing between the label numbers and plots</span></span>
<span>    mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># rows/columns</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotFluxQ.html">plotFluxQ</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>          fluxUnit<span class="op">=</span><span class="fl">9</span>,logScale<span class="op">=</span><span class="cn">TRUE</span>,fluxMax<span class="op">=</span><span class="fl">1</span>,</span>
<span>          showXLabels<span class="op">=</span><span class="cn">FALSE</span>,showXAxis<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>          showYLabels<span class="op">=</span><span class="cn">TRUE</span>,customPar<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotConcQ.html">plotConcQ</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>, customPar<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>          removeLastY<span class="op">=</span><span class="cn">TRUE</span>,removeLastX<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>          showYLabels<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotFluxHist.html">plotFluxHist</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,fluxMax<span class="op">=</span><span class="fl">1</span>,</span>
<span>          showYLabels<span class="op">=</span><span class="cn">FALSE</span>,showYAxis<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>          showXLabels<span class="op">=</span><span class="cn">FALSE</span>,showXAxis<span class="op">=</span><span class="cn">FALSE</span>, customPar<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotConcHist.html">plotConcHist</a></span><span class="op">(</span><span class="va">eList</span>, tinyPlot<span class="op">=</span><span class="cn">TRUE</span>,printTitle<span class="op">=</span><span class="cn">FALSE</span>,concMax<span class="op">=</span><span class="fl">3</span>,</span>
<span>          showYLabels<span class="op">=</span><span class="cn">FALSE</span>, showYAxis<span class="op">=</span><span class="cn">FALSE</span>, customPar<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Custom multi-pane graph using customPar"</span>, outer<span class="op">=</span><span class="cn">TRUE</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="EGRET_files/figure-html/customPanel-1.png" alt="Custom multipanel plot" width="100%"><p class="caption">
Custom multipanel plot
</p>
</div>
</div>
<div class="section level2">
<h2 id="appendix1">Getting Started in R<a class="anchor" aria-label="anchor" href="#appendix1"></a>
</h2>
<p>This section describes the options for installing the EGRET
package.</p>
<div class="section level3">
<h3 id="new-to-r">New to R?<a class="anchor" aria-label="anchor" href="#new-to-r"></a>
</h3>
<p>If you are new to R, you will need to first install the latest
version of R, which can be found here: <a href="https://www.r-project.org/" class="external-link">https://www.r-project.org/</a>.</p>
<p>At any time, you can get information about any function in R by
typing a question mark before the function’s name. This opens a file
that describes the function, the required arguments, and provides
working examples.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">plotConcQ</span></span></code></pre></div>
<p>To see the raw code for a particular function, type the name of the
function, without parentheses:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotConcQ</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="r-user-installing-egret">R User: Installing EGRET<a class="anchor" aria-label="anchor" href="#r-user-installing-egret"></a>
</h3>
<p>To install the EGRET packages and its dependencies:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"EGRET"</span><span class="op">)</span></span></code></pre></div>
<p>After installing the package, you need to open the library each time
you re-start R. This is done with the simple command:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pubs.usgs.gov/tm/04/a10/" class="external-link">EGRET</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="appendixPlot">Common Function Variables<a class="anchor" aria-label="anchor" href="#appendixPlot"></a>
</h2>
<p>This section describes variables that are common for a variety of
function types.</p>
<div class="section level3">
<h3 id="flowHistoryVariables">Flow History Plotting Input<a class="anchor" aria-label="anchor" href="#flowHistoryVariables"></a>
</h3>
<table style="width:100%;" class="table">
<caption>Variables used in flow history plots (<code>plot15</code>,
<code>plotFour</code>, <code>plotFourStats</code>,
<code>plotQTimeDaily</code>, <code>plotSDLogQ</code>)</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">istat</td>
<td align="right">The discharge statistic to be plotted: 1-8. Must be
specified, see Table <span class="math inline">\(\ref{table:istat}\)</span>.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">yearStart</td>
<td align="right">The decimal year (decYear) value where you want the
graph to start</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">yearEnd</td>
<td align="right">The decimal year (decYear) value where you want the
graph to end</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">qMax</td>
<td align="right">User specified upper limit on y axis (can be used when
we want several graphs to all share the same scale). Value is specified
in the discharge units that the user selects.</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">printTitle</td>
<td align="right">can be TRUE or FALSE, you may want FALSE if it is
going to be a figure with a caption or if it is a part of a multipanel
plot.</td>
<td align="right">TRUE</td>
</tr>
<tr class="even">
<td align="left">tinyPlot</td>
<td align="right">Can be TRUE or FALSE, the TRUE option assures that
there will be a small number of tick marks, consistent with printing in
a small space</td>
<td align="right">FALSE</td>
</tr>
<tr class="odd">
<td align="left">runoff</td>
<td align="right">Can be TRUE or FALSE. If true then discharge values
are reported as runoff in mm/day. This can be very useful in multi-site
analyses.</td>
<td align="right">FALSE</td>
</tr>
<tr class="even">
<td align="left">qUnit</td>
<td align="right">An index indicating what discharge units to use.
Options run from 1 to 6 (see section <span class="math inline">\(\ref{#units}\)</span>). The choice should be based
on the units that are customary for the audience but also, the choice
should be made so that the discharge values don’t have too many digits
to the right or left of the decimal point.</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">printStaName</td>
<td align="right">Can be TRUE or FALSE, if TRUE the name of the
streamgage is stated in the plot title.</td>
<td align="right">TRUE</td>
</tr>
<tr class="even">
<td align="left">printPA</td>
<td align="right">Can be TRUE or FALSE, if TRUE the period of analysis
is stated in the plot title.</td>
<td align="right">TRUE</td>
</tr>
<tr class="odd">
<td align="left">printIstat</td>
<td align="right">Can be TRUE or FALSE, if TRUE the name of the
statistic (e.g. 7-day minimum discharge) is stated in the plot
title.</td>
<td align="right">TRUE</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="wqVariables">Water Quality Plotting Input<a class="anchor" aria-label="anchor" href="#wqVariables"></a>
</h3>
<table style="width:100%;" class="table">
<caption>Selected variables used in water quality analysis
plots</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">qUnit</td>
<td align="right">Determines what units will be used for discharge, see
<a href="#units">Units</a>
</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">printTitle</td>
<td align="right">If TRUE the plot has a title. If FALSE no title
(useful for publications where there will be a caption)</td>
<td align="right">TRUE</td>
</tr>
<tr class="odd">
<td align="left">qLower</td>
<td align="right">The lower bound on the discharge on the day of
sampling that will be used in forming a subset of the sample data set
that will be displayed in the graph. It is expressed in the units
specified in qUnit. If qLower = NA, then the lower bound is set to
zero.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">qUpper</td>
<td align="right">The upper bound on the discharge on the day of
sampling that will be used in forming a subset of the sample data set
that will be displayed in the graph. It is expressed in the units
specified in qUnit. If qUpper = NA, then the upper bound is set to
infinity.</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">paLong</td>
<td align="right">The length of the time period that will be used in
forming a subset of the sample data set that will be displayed in the
graph, expressed in months.</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">paStart</td>
<td align="right">The starting month for the time period that will be
used in forming a subset of the sample data set that will be displayed
in the graph. It is expressed in months (calendar months).</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">concMax</td>
<td align="right">The upper limit on the vertical axis of graphs showing
concentration values in mg/L (NA sets value to just above maximum).</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">concMin</td>
<td align="right">The lower limit on the vertical axis of graphs showing
concentration values in mg/L (NA sets value to just below minimum for
log scales, zero for linear).</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">fluxUnit</td>
<td align="right">Determines what units will be used for flux (see
Section <span class="math inline">\(\ref{#units}\)</span>).</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">fluxMax</td>
<td align="right">The upper limit on the vertical axis of graphs showing
flux values.</td>
<td align="right"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="wrtdsInputVariables">WRTDS Estimation Input<a class="anchor" aria-label="anchor" href="#wrtdsInputVariables"></a>
</h3>
<table style="width:100%;" class="table">
<caption>Selected variables in WRTDS</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">windowY</td>
<td align="right">The half window width for the time weighting, measured
in years. Values much shorter than 7 usually result in a good deal of
oscillations in the system that are likely not very realistic</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">windowQ</td>
<td align="right">The half window width for the weighting in terms of
ln(Q). For very large rivers (average discharge values in the range of
many tens of thousands of cfs) a smaller value than 2 may be
appropriate, but probably not less than 1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">windowS</td>
<td align="right">The half window width for the seasonal weighting,
measured in years. Any value &gt;0.5 will make data from all seasons
have some weight. Values should probably not be lower than 0.3</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">minNumObs</td>
<td align="right">This is the minimum number of observations with
non-zero weight that the individual regressions will require before they
will be used. If there too few observations the program will iterate,
making the windows wider until the number increases above this minimum.
The only reason to lower this is in cases where the data set is rather
small. It should always be set to a number at least slightly smaller
than the sample size. Any value less than about 60 is probably in the
“dangerous} range, in terms of the reliability of the regression</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">minNumUncen</td>
<td align="right">This is the minimum number of uncensored observations
with non-zero weight that the individual regressions will require before
they will be used. If there are too few uncensored observations the
program will iterate, making the windows wider until the number
increases above this minimum. The only reason to lower this is in cases
where the number of uncensored values is rather small. The method has
never been tested in situations where there are very few uncensored
values</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="left">edgeAdjust</td>
<td align="right">Specify whether to use the modified method for
calculating the windows at the edge of the record. The modified method
tends to reduce curvature near the start and end of record</td>
<td align="right">TRUE</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="wrtdsOutputVariables">Post-WRTDS Plotting Input<a class="anchor" aria-label="anchor" href="#wrtdsOutputVariables"></a>
</h3>
<table style="width:100%;" class="table">
<caption>Selected variables used in plots for analysis of WRTDS model
results</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">qUnit</td>
<td align="right">Determines what units will be used for discharge, see
section <a href="#units">Units</a>
</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">fluxUnit</td>
<td align="right">An index indicating what flux units will be used , see
section <a href="#units">Units</a>
</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">stdResid</td>
<td align="right">This is an option. If FALSE, it prints the regular
residuals (they are in ln concentration units). If TRUE, it is the
standardized residuals. These are the residuals divided by their
estimated standard error (each residual has its own unique standard
error). In theory, the standardized residuals should have mean zero and
standard deviation of 1</td>
<td align="right">FALSE</td>
</tr>
<tr class="even">
<td align="left">printTitle</td>
<td align="right">If TRUE the plot has a title. If FALSE no title
(useful for publications where there will be a caption)</td>
<td align="right">TRUE</td>
</tr>
<tr class="odd">
<td align="left">startYear</td>
<td align="right">The starting date for the graph, expressed as decimal
years, for example, 1989</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">endYear</td>
<td align="right">The ending date for the graph, expressed as decimal
years, for example, 1996</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">moreTitle</td>
<td align="right">A character variable that adds additional information
to the graphic title. Typically used to indicate the estimation
method.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">fluxMax</td>
<td align="right">The upper limit on the vertical axis of graphs showing
flux values.</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">concMax</td>
<td align="right">The upper limit on the vertical axis of graphs showing
concentration values.</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">plotFlowNorm</td>
<td align="right">If TRUE the graph shows the annual values as circles
and the flow-normalized values as a green curve. If false, it only shows
the annual values.</td>
<td align="right">TRUE</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<caption>Variables used in EGRET contour plots:
<code>plotContours</code> and <code>plotDiffContours</code>
</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Defaults</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">qUnit</td>
<td align="right">Determines what units will be used for discharge, see
section <a href="#units">Units</a>
</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">qBottom</td>
<td align="right">The lower limit of the discharge value for the graphs
in the units specified by qUnit</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">qTop</td>
<td align="right">The upper limit of the discharge value for the graphs
in the units specified by qUnit</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">printTitle</td>
<td align="right">If TRUE the plot has a title. If FALSE no title
(useful for publications where there will be a caption)</td>
<td align="right">TRUE</td>
</tr>
<tr class="odd">
<td align="left">yearStart</td>
<td align="right">The starting date for the graph, expressed as decimal
years, for example, 1989</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">yearEnd</td>
<td align="right">The ending date for the graph, expressed as decimal
years, for example, 1996</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">whatSurface</td>
<td align="right">This should generally be at its default value. At
whatSurface = 3, the plotted surface shows the expected value of
concentration. For whatSurface = 1, it shows the yHat surface (natural
log of concentration). For whatSurface = 2, it shows the SE surface (the
standard error in log concentration).</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">contourLevels</td>
<td align="right">With the default value the contour intervals are set
automatically, which generally will NOT be a very good choice, but they
may provide a starting point. If you want to specify contourLevels, use
the <code>seq</code> function. In general it would look like:
contourLevels = seq(from,to,by).</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">maxDiff</td>
<td align="right">In the <code>plotDiffCountours</code> function instead
of using contourLevels, the contours are set by maxDiff which is the
absolute value of the maximum difference to be plotted. Contour
intervals are set to run from -maxDiff to maxDiff.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">span</td>
<td align="right">Specifies the smoothness of the discharge duration
information that goes on this graph. A larger value will make it
smoother. The default should work well in most cases.</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="left">pval</td>
<td align="right">The probability value for the discharge frequency
information shown on the plot. When flowDuration=TRUE, the plot has two
black curves on it. In the default value case these are at the 5 and 95
percent levels on the seasonal discharge duration curve. pval = 0.01
would place these at the 1 and 99 percent points. pval = 0.1 would place
them at 10 and 90.</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">vert1</td>
<td align="right">This simply plots a vertical black line on the graph
at a particular time (defined in decimal years). It is used to
illustrate the idea of a “vertical slice” through the contour plot,
which might then be shown in a subsequent use of
<code>plotConcQSmooth</code>.</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">vert2</td>
<td align="right">This gives the location of a second vertical black
line on the graph at a particular time (defined in decimal years).</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">horiz</td>
<td align="right">This simply plots a horizontal black line on the graph
at a particular discharge value (defined in the units specified by
qUnit). It is used to illustrate the idea of the seasonal cycle in
concentrations for a given discharge and the long-term change in this
cycle.</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">flowDuration</td>
<td align="right">If TRUE it draws the discharge duration lines at the
specified probabilities. If FALSE, the discharge duration lines are left
off.</td>
<td align="right">TRUE</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<caption>Variables used in EGRET <code>plotConcQSmooth</code> and/or
<code>plotConcTimeSmooth</code> functions</caption>
<colgroup>
<col width="19%">
<col width="69%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="right">Definition</th>
<th align="right">Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">date1</td>
<td align="right">This is the date for the first curve to be shown on
the <code>plotConcQSmooth</code> graph. It must be in the form
<code>"yyyy-mm-dd"</code> (it must be in quotes)</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">date2</td>
<td align="right">This is the date for the second curve to be shown on
the plot (<code>"yyyy-mm-dd"</code>), If you don’t want a second curve
then the argument must be date2=NA</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">date3</td>
<td align="right">This is the date for the third curve to be shown on
the plot (<code>"yyyy-mm-dd"</code>), If you don’t want a third curve
then the argument must be date3=NA</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">q1</td>
<td align="right">This is the discharge for the first curve on the
<code>plotConcTime</code> smooth graph. It is in units specified by
qUnit</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">q2</td>
<td align="right">This is the discharge for the second curve. If you
don’t want a second curve then the argument must be q2=NA</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">q3</td>
<td align="right">This is the discharge for the third curve. If you
don’t want a third curve then the argument must be q3=NA</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">qUnit</td>
<td align="right">Determines what units will be used for discharge, see
<code>printqUnitCheatSheet</code>
</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">qLow</td>
<td align="right">The discharge value that should form the left edge of
the plotConcQSmooth graph in the user-selected discharge units.</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">qHigh</td>
<td align="right">The discharge value that should form the right edge of
the <code>plotConcQSmooth</code> graph in the user-selected discharge
units.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">centerDate</td>
<td align="right">This is the month and day at the center of the time
window for the <code>plotConcTimeSmooth</code> graph. It must be in the
form <code>"mm-dd"</code> in quotes</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">yearStart</td>
<td align="right">The starting year for the
<code>plotConcTimeSmooth</code> graph</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">yearEnd</td>
<td align="right">The ending year for the
<code>plotConcTimeSmooth</code> graph</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">legendLeft</td>
<td align="right">This determines the placement of the legend on the
graph. It establishes the left edge of the legend and is expressed in
the discharge units being used. The default (which is NA) will let it be
placed automatically. The legend can end up conflicting with one or more
of the curves. Once the location of the curves is established then this
can be set in a way that avoids conflict.</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">legendTop</td>
<td align="right">This determines the placement of the legend on the
graph. It establishes the top edge of the legend and is expressed
according to the concentration values on the y-axis. The default (which
is NA) will let it be placed automatically. The legend can end up
conflicting with one or more of the curves. Once the location of the
curves is established then this can be set in a way that avoids
conflict.</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">concMax</td>
<td align="right">Maximum value for the vertical axis of the graph. The
reason to set concMax is if you want to make several plots that have the
same vertical axis.</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">concMin</td>
<td align="right">[This one is only used when logScale=TRUE]. Minimum
value for the vertical axis of the graph. The reason to set concMin is
if you want to make several plots that have the same vertical axis.</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">bw</td>
<td align="right">Default is FALSE, which means we want a color plot. If
bw=TRUE that means it should be black and white.</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">printTitle</td>
<td align="right">If TRUE the plot has a title. If FALSE no title
(useful for publications where there will be a caption).</td>
<td align="right">FALSE</td>
</tr>
<tr class="odd">
<td align="left">printValues</td>
<td align="right">If TRUE the estimated values that make up the plotted
lines are printed on the console. If FALSE they are not printed. This
could be useful if you wanted to compute various comparisons across time
periods.</td>
<td align="right">FALSE</td>
</tr>
<tr class="even">
<td align="left">windowY</td>
<td align="right">This is the half-window width for time in WRTDS. It
has units of years.</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">windowQ</td>
<td align="right">This is the half-window width for discharge in WRTDS.
It has units of ln(discharge).</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">windowS</td>
<td align="right">This is the half-window width for seasons in WRTDS. It
has units of years.</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">edgeAdjust</td>
<td align="right">Specify whether to use the modified method for
calculating the windows at the edge of the record. The modified method
tends to reduce curvature near the start and end of record</td>
<td align="right">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="createWordTable">Creating tables in Microsoft™ software from an R data frame<a class="anchor" aria-label="anchor" href="#createWordTable"></a>
</h2>
<p>A few steps that are required to create a table in Microsoft™
software (Excel, Word, PowerPoint, etc.) from an R data frame. There are
a variety of good methods, one of which is detailed here. The example we
will step through is creation of a table in Microsoft™ Excel based on
the data frame tableData:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableResults.html">tableResults</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Choptank River </span></span>
<span><span class="co">##    Inorganic nitrogen (nitrate and nitrite)</span></span>
<span><span class="co">##    Water Year </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Year   Discharge    Conc    FN_Conc     Flux    FN_Flux</span></span>
<span><span class="co">##              cms            mg/L             10^6 kg/yr </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    1980      4.25     0.949     1.003    0.1154     0.106</span></span>
<span><span class="co">##    1981      2.22     1.035     0.999    0.0675     0.108</span></span>
<span><span class="co">##    1982      3.05     1.036     0.993    0.0985     0.110</span></span>
<span><span class="co">##    1983      4.99     1.007     0.993    0.1329     0.112</span></span>
<span><span class="co">##    1984      5.72     0.990     1.002    0.1597     0.114</span></span>
<span><span class="co">##    1985      1.52     1.057     1.017    0.0489     0.116</span></span>
<span><span class="co">##    1986      2.63     1.062     1.038    0.0903     0.119</span></span>
<span><span class="co">##    1987      3.37     1.079     1.062    0.1142     0.122</span></span>
<span><span class="co">##    1988      1.87     1.120     1.085    0.0660     0.125</span></span>
<span><span class="co">##    1989      5.61     1.055     1.105    0.1638     0.127</span></span>
<span><span class="co">##    1990      4.01     1.115     1.125    0.1349     0.129</span></span>
<span><span class="co">##    1991      2.75     1.172     1.143    0.0980     0.130</span></span>
<span><span class="co">##    1992      2.19     1.203     1.159    0.0810     0.132</span></span>
<span><span class="co">##    1993      3.73     1.215     1.173    0.1306     0.132</span></span>
<span><span class="co">##    1994      5.48     1.144     1.187    0.1634     0.133</span></span>
<span><span class="co">##    1995      2.41     1.266     1.201    0.0928     0.134</span></span>
<span><span class="co">##    1996      6.24     1.134     1.213    0.1980     0.135</span></span>
<span><span class="co">##    1997      5.83     1.180     1.221    0.1884     0.136</span></span>
<span><span class="co">##    1998      4.88     1.236     1.229    0.1593     0.137</span></span>
<span><span class="co">##    1999      2.90     1.277     1.238    0.0919     0.138</span></span>
<span><span class="co">##    2000      4.72     1.213     1.253    0.1627     0.139</span></span>
<span><span class="co">##    2001      4.88     1.251     1.268    0.1655     0.140</span></span>
<span><span class="co">##    2002      1.24     1.321     1.285    0.0483     0.141</span></span>
<span><span class="co">##    2003      8.64     1.140     1.303    0.2664     0.143</span></span>
<span><span class="co">##    2004      5.28     1.274     1.321    0.1832     0.144</span></span>
<span><span class="co">##    2005      3.81     1.360     1.341    0.1444     0.146</span></span>
<span><span class="co">##    2006      3.59     1.382     1.362    0.1409     0.147</span></span>
<span><span class="co">##    2007      4.28     1.408     1.382    0.1593     0.149</span></span>
<span><span class="co">##    2008      2.56     1.477     1.401    0.1008     0.149</span></span>
<span><span class="co">##    2009      3.68     1.409     1.419    0.1328     0.149</span></span>
<span><span class="co">##    2010      7.19     1.323     1.438    0.2236     0.149</span></span>
<span><span class="co">##    2011      5.24     1.438     1.457    0.1554     0.148</span></span></code></pre>
<p>First, save the data frame as a tab delimited file (you don’t want to
use comma delimited because there are commas in some of the data
elements):</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">tableData</span>, file<span class="op">=</span><span class="st">"tableData.tsv"</span>,sep<span class="op">=</span><span class="st">"\t"</span>, </span>
<span>            row.names <span class="op">=</span> <span class="cn">FALSE</span>,quote<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>This will save a file in your working directory called tableData.tsv.
You can see your working directory by typing <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code> in the
R console. Opening the file in a general-purpose text editor, you should
see the following:</p>
<pre><code>Year  Discharge [cms]   Conc [mg/L] FN_Conc [mg/L]  Flux [10^6kg/yr]    FN_Flux [10^6kg/yr]
1980       4.25            0.949          1.003          0.1154             0.106  
1981       2.22            1.035          0.999          0.0675             0.108 
1982       3.05            1.036          0.993          0.0985             0.110 
...</code></pre>
<p>Next, follow the steps below to open this file in Excel:</p>
<ul>
<li>Open Excel</li>
<li>Click on the File tab</li>
<li>Click on the Open option</li>
<li>Navigate to the working directory (as shown in the results of
getwd())</li>
<li>Next to the File name text box, change the dropdown type to All
Files (<em>.</em>)</li>
<li>Double click tableData.tsv</li>
<li>A text import wizard will open up, in the first window, choose the
Delimited radio button if it is not automatically picked, then click on
Next.</li>
<li>In the second window, click on the Tab delimiter if it is not
automatically checked, then click Finished.</li>
<li>Use the many formatting tools within Excel to customize the
table</li>
</ul>
<p>From Excel, it is simple to copy and paste the tables in other word
processing or presentation software products. An example using one of
the default Excel table formats is here.</p>
<p><img src="table1.png" width="45%" style="display: block; margin: auto;"></p>
<p>A simple table produced in Microsoft™ Excel</p>
</div>
<div class="section level2">
<h2 id="savingPlots">Saving Plots<a class="anchor" aria-label="anchor" href="#savingPlots"></a>
</h2>
<p>Plots can be saved from R as JPG, PNG, PDF, and Postscript files. JPG
and PNG are easy to use in any number of programs (Microsoft™ Word or
PowerPoint, for example), but the images cannot be resized later. PDF
and Postscript images are easily re-sizable.</p>
<p>There are three steps to saving plots. The first is to open the
“device” (and declare the output type and file name). The second step is
to execute the function just as you would when plotting to the screen,
but no output will appear. The third step is to turn off the device. It
is also possible to put many plots within the same pdf. Some simple
examples should demonstrate this easily:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="st">"plotFlowSingle.jpg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"plotFlowSingle.png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"plotFlowSingle.pdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/postscript.html" class="external-link">postscript</a></span><span class="op">(</span><span class="st">"plotFlowSingle.ps"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Many plots saved to one pdf:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"manyPlots.pdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotFlowSingle.html">plotFlowSingle</a></span><span class="op">(</span><span class="va">eList</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>There are many additional options for each of these devices. See the
R help files for more information. One useful option for the larger
<code>fluxBiasMulti</code> graph is to adjust the height and width of
the output. The output of <code>fluxBiasMulti</code> is larger than the
default pdf or postscript devices. Therefore, specifying the height and
width eliminates R having to re-size the graphic:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/postscript.html" class="external-link">postscript</a></span><span class="op">(</span><span class="st">"fluxBiasMulti.ps"</span>, height<span class="op">=</span><span class="fl">10</span>,width<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fluxBiasMulti.html">fluxBiasMulti</a></span><span class="op">(</span><span class="va">eList</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>This software has been approved for release by the U.S. Geological
Survey (USGS). Although the software has been subjected to rigorous
review, the USGS reserves the right to update the software as needed
pursuant to further analysis and review. No warranty, expressed or
implied, is made by the USGS or the U.S. Government as to the
functionality of the software and related material nor shall the fact of
release constitute any such warranty. Furthermore, the software is
released on condition that neither the USGS nor the U.S. Government
shall be held liable for any damages resulting from its authorized or
unauthorized use.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-choquette_tracking_2019" class="csl-entry">
Choquette, Anne F, Robert M Hirsch, Jennifer C Murphy, LT Johnson, and
RB Confesor Jr. 2019. <span>“Tracking Changes in Nutrient Delivery to
Western <span>Lake</span> <span>Erie</span>: <span>Approaches</span> to
Compensate for Variability and Trends in Streamflow.”</span> <em>Journal
of Great Lakes Research</em> 45 (1): 21–39.
</div>
<div id="ref-hirsch_bootstrap_2015" class="csl-entry">
Hirsch, Robert M, Stacey A Archfield, and Laura A De Cicco. 2015.
<span>“A Bootstrap Method for Estimating Uncertainty of Water Quality
Trends.”</span> <em>Environmental Modelling &amp; Software</em> 73:
148–66.
</div>
<div id="ref-hirsch_user_2015" class="csl-entry">
Hirsch, Robert M, and Laura A De Cicco. 2015. <span>“User Guide to
<span>Exploration</span> and <span>Graphics</span> for
<span>RivEr</span> <span>Trends</span> (<span>EGRET</span>) and <span class="nocase">dataRetrieval</span>: <span>R</span> Packages for
Hydrologic Data.”</span> 2328-7055. US Geological Survey.
</div>
<div id="ref-hirsch_weighted_2010" class="csl-entry">
Hirsch, Robert M., Douglas L. Moyer, and Stacey A. Archfield. 2010.
<span>“Weighted <span>Regressions</span> on <span>Time</span>,
<span>Discharge</span>, and <span>Season</span> (<span>WRTDS</span>),
with an <span>Application</span> to <span>Chesapeake</span>
<span>Bay</span> <span>River</span> <span>Inputs</span>1.”</span>
<em>JAWRA Journal of the American Water Resources Association</em> 46
(5): 857–80. <a href="https://doi.org/10.1111/j.1752-1688.2010.00482.x" class="external-link">https://doi.org/10.1111/j.1752-1688.2010.00482.x</a>.
</div>
<div id="ref-sprague_nitrate_2011" class="csl-entry">
Sprague, Lori A., Robert M. Hirsch, and Brent T. Aulenbach. 2011.
<span>“Nitrate in the <span>Mississippi</span> <span>River</span> and
<span>Its</span> <span>Tributaries</span>, 1980 to 2008:
<span>Are</span> <span>We</span> <span>Making</span>
<span>Progress</span>?”</span> <em>Environmental Science &amp;
Technology</em> 45 (17): 7209–16. <a href="https://doi.org/10.1021/es201221s" class="external-link">https://doi.org/10.1021/es201221s</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer></footer>
</div> <!-- / div for your main content-->

<!-- BEGIN USGS Footer Template -->

<footer class="footer"><div class="tmp-container">
		<!-- .footer-wrap -->
			<!-- .footer-doi -->
			<div class="footer-doi">
				<!-- footer nav links -->
				<ul class="menu nav">
<li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/privacy" class="external-link">DOI Privacy Policy</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/policies-and-notices" class="external-link">Legal</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/accessibility-and-us-geological-survey" class="external-link">Accessibility</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/sitemap" class="external-link">Site Map</a></li>
					<li class="last leaf menu-links menu-level-1"><a href="https://answers.usgs.gov/" class="external-link">Contact USGS</a></li>
				</ul>
<!--/ footer nav links -->
</div>
			<!-- /.footer-doi -->

			<hr>
<!-- .footer-utl-links --><div class="footer-doi">
			<ul class="menu nav">
<li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/" class="external-link">U.S. Department of the Interior</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doioig.gov/" class="external-link">DOI Inspector General</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/" class="external-link">White House</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/omb/management/egov/" class="external-link">E-gov</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doi.gov/pmb/eeo/no-fear-act" class="external-link">No Fear Act</a></li>
				<li class="last leaf menu-links menu-level-1"><a href="https://www.usgs.gov/about/organization/science-support/foia" class="external-link">FOIA</a></li>
			</ul>
</div>			
		<!-- /.footer-utl-links -->
		<!-- .footer-social-links -->
		<div class="footer-social-links">
			<ul class="social">
<li class="follow">Follow</li>
				<li class="twitter">
					<a href="https://twitter.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-twitter-square"><span class="only">Twitter</span></i>
					</a>
				</li>
				<li class="facebook">
					<a href="https://facebook.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-facebook-square"><span class="only">Facebook</span></i>
					</a>
				</li>
				<li class="github">
					<a href="https://github.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-github"><span class="only">GitHub</span></i>
					</a>
				</li>
				<li class="flickr">
					<a href="https://flickr.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-flickr"><span class="only">Flickr</span></i>
					</a>
				</li>
				<li class="youtube">
					<a href="http://youtube.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-youtube-play"><span class="only">YouTube</span></i>
					</a>
				</li>
				<li class="instagram">
					<a href="https://instagram.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-instagram"><span class="only">Instagram</span></i>
					</a>
				</li>
			</ul>
</div>
		<!-- /.footer-social-links -->
	</div>
		<!-- /.footer-wrap -->	
</footer><!-- END USGS Footer Template- --><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKQR8KP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
  </body>
<!-- closing div for body -->
</html>
