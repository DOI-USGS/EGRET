<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trends by month • EGRET</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Trends by month">
<meta property="og:description" content="EGRET">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRET</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/EGRET.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function Help Pages</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Enhancements.html">Enhancements</a>
    </li>
    <li>
      <a href="../articles/Making%20WRTDS_K%20flux%20estimates.html">WRTDS-K</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running in Parallel</a>
    </li>
    <li>
      <a href="../articles/rResid.html">Random Residuals</a>
    </li>
    <li>
      <a href="../articles/SeasonalFraction.html">Seasonal Analysis</a>
    </li>
    <li>
      <a href="../articles/streamflow_trend.html">Daily Streamflow Trends</a>
    </li>
    <li>
      <a href="../articles/TrendsByMonth.html">Trends by month</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/References_WRTDS.html">Bibliograpy</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/USGS-R/EGRET">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Trends by month</h1>
                        <h4 class="author">Robert M. Hirsch</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/EGRET/blob/master/vignettes/TrendsByMonth.Rmd"><code>vignettes/TrendsByMonth.Rmd</code></a></small>
      <div class="hidden name"><code>TrendsByMonth.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette is about producing a single type of figure. It is designed to examine the trends between a pair of years (using <strong>runPairs</strong> in EGRET terminology) to see what the size of the trend is for each of the twelve months of the year. It was used to make Figure 8 in Choquette et al., 2019. It is very helpful in trying to see if the trend is very specific to a certain part of the year (or even opposite in different parts of the year) versus being fairly similar across all the months.</p>
</div>
<div id="how-to-do-it" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-do-it" class="anchor"></a>How to do it</h2>
<p>You need two functions. One is called <strong>runPairsMonths.R</strong> to do the computations and the other is called <strong>plotOne.R</strong> which makes the plots. These two functions are included below. You should set up a working directory and then you can copy these functions into your working directory. You be you need an EGRET eList in the directory as well. It should be an eList for which modelEstimation has already been run.</p>
<p>Here is the code</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"># This is function called runPairsMonths
# It is virtually identical to the EGRET function runPairs
# To learn the meaning of each of these initial arguments
# The best thing to do is load the EGRET package
# and then do ?runPairs
# the help page you will get defines all of these
runPairsMonths  range(localSample$Date)[2]) {
    stop("year2 is outside the Sample range")
  }
  if (startEndSurface1$endDate &lt; range(localSample$Date)[1]) {
    stop("year1 is outside the Sample range")
  }
  sampleStartDate  as.Date(startEndSurface1[[2]])) {
    stop("Sample start is later than year2")
  }
  if (sampleEndDate &lt; as.Date(startEndSurface2[[1]])) {
    stop("Sample end is earlier than year1")
  }
  localsurfaces  0 &amp; !flowBreak) {
    dateInfo1 = sample1StartDate &amp; 
                           localSample$Date &lt;= sample1EndDate, ]
  Sample2 = sample2StartDate &amp; 
                           localSample$Date &lt;= sample2EndDate, ]
  fractMin  length(Sample1$Date)) 
    check[1]  length(Sample2$Date)) 
    check[2]  sum(Sample1$Uncen)) 
    check[3]  sum(Sample2$Uncen)) 
    check[4] = dateInfo$flowNormStart[1] &amp; 
                         localDaily$Date &lt;= dateInfo$flowNormEnd[1], ]
  Daily2 = dateInfo$flowNormStart[2] &amp; 
                         localDaily$Date &lt;= dateInfo$flowNormEnd[2], ]
  if (oldSurface) {
    checkSurfaceSpan(eList)
    if (all(c("Year", "LogQ", "surfaceIndex") %in% names(attributes(localsurfaces)))) {
      surfaceYear = startDec1 &amp; surfaceYear &lt;= 
                          endDec1)
    surfIndex1 = startDec2 &amp; surfaceYear &lt;= 
                          endDec2)
    surfIndex2 = QStartDate &amp; localDaily$Date &lt;= 
                         QEndDate, ]
  DailyRS1FD0  y0) "red" else "black"
  length </pre></body></html></div>
<p>Now let’s run it</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">library(EGRET)
load("Conowingo.PO4.RData")
# source("runPairsMonths.R")
# source("plotOne.R")
z </pre></body></html></div>
<pre><code>## Sample1 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## Sample2 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## minNumObs has been set to 100 minNumUncen has been set to 50</code></pre>
<pre><code>## Sample1 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## Sample2 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## minNumObs has been set to 100 minNumUncen has been set to 50</code></pre>
<pre><code>## 
##    SUSQUEHANNA RIVER AT CONOWINGO, MD 
##    00671
##    Calendar Year 
## 
##  Change estimates  2017  minus  2006 
## 
##  For concentration: total change is  0.000904 mg/L
##  expressed as Percent Change is  10 %
## 
##  Concentration v. Q Trend Component  10 %
##        Q Trend Component             0 % 
## 
## 
##  For flux: total change is  0.116 million kg/year
##  expressed as Percent Change is  31 %
## 
##  Concentration v. Q Trend Component  31 %
##        Q Trend Component             0 % 
## 
##      TotalChange   CQTC QTC    x10    x11    x20    x22
## Conc      0.0009 0.0009   0 0.0088 0.0088 0.0097 0.0097
## Flux      0.1164 0.1164   0 0.3698 0.3698 0.4862 0.4862</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># z contains the results, they are expressed as yields in kg/month/km^2</span>
<span class="co"># z[1,1:12] are the yields in year 1, by month Jan, Feb, ... Dec</span>
<span class="co"># z[2,1:12] are the yields in year 2, by month Jan, Feb, ... Dec</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">z</span>)</pre></body></html></div>
<pre><code>##            Jan       Feb       Mar       Apr       May       Jun       Jul
## [1,] 0.6273932 0.4739879 0.7075350 0.6380653 0.3619343 0.2097517 0.1878099
## [2,] 0.8347853 0.4960114 0.8392184 0.7795324 0.3860591 0.2166557 0.2252040
##            Aug       Sep       Oct       Nov       Dec
## [1,] 0.1927015 0.3222020 0.3493139 0.4913913 0.7070998
## [2,] 0.2696814 0.5610262 0.5496506 0.7390136 1.0301296</code></pre>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co">#</span>
<span class="fu">plotOne</span>(<span class="no">z</span>)</pre></body></html></div>
<p><img src="TrendsByMonth_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">####
###we might want to make a few changes in the look of the figure, for example

plotOne(z, yMax = 1.2, arrowFactor = 0.6, name = "Change in yield between 2006 and 2017\nPO4 at Conowingo")</pre></body></html></div>
<p><img src="TrendsByMonth_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
</div>
<div id="reference-cited" class="section level1">
<h1 class="hasAnchor">
<a href="#reference-cited" class="anchor"></a>Reference cited</h1>
<p>Choquette, A.F., Hirsch, R.M., Murphy, J.C., Johnson, L.T. and Confesor Jr, R.B., 2019. Tracking changes in nutrient delivery to western Lake Erie: Approaches to compensate for variability and trends in streamflow. Journal of Great Lakes Research, 45(1), pp.21-39.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Hirsch, Laura DeCicco.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
