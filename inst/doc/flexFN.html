<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Robert M. Hirsch" />

<meta name="date" content="2018-01-11" />

<title>WRTDS Flex</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">WRTDS Flex</h1>
<h4 class="author"><em>Robert M. Hirsch</em></h4>
<h4 class="date"><em>2018-01-11</em></h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This new version provides a great deal of flexibility to the basic WRTDS concept and implements in in a new version of <code>EGRET</code> (and <code>EGRETci</code> although at this point <code>EGRETci</code> isn’t changed). This new version of <code>EGRET</code> along with <code>EGRETci</code> should be able to produce exactly the same outputs as the old versions. There are a few major concepts that need to be introduced up front.</p>
</div>
<div id="the-wall" class="section level1">
<h1>The “Wall”</h1>
<p>The idea of the “wall” is to handle events that we believe may result in a sharp discontinuity in the way that concentrations behave as a function of discharge, year, and season (basically the view we see in the contour plots). As you know, WRTDS was designed with a working assumption that changes in water quality are gradual, responding to changes in behavior of many actors in the watershed. These can be changes in population (and hence wasteloads), changes in land use or land use practices by many landowners, or many changes in point source controls over many dischargers. We know that there can be situations that depart from that assumption. Some obvious ones are: upgrades to a single dominant point source discharge, large infrastructure changes in storm-water management (e.g. tunnel projects in big cities that significantly curtail combined sewer overflows), construction or removal of a major dam (causing the pollutant of interest to mix with a large volume of water in the reservoir significantly smoothing out the variability of water quality below the dam). There is another category of abrupt change that could be considered, and that is a “reset” of river conditions that may be the result of an extreme flood or extreme drought. The hypothesis is that the behavior of water quality changes as a result of this extreme event and that this change is not a short term thing (i.e. the duration of the event) but rather is something that persists for a number of years. The new “wall” concept can provide an effective way to perform a hypothesis test that the event in question brought about a lasting change, and the approach allows us to describe the nature of the change that took place.</p>
<p>Operationally the wall idea is this. We will call the moment in time when we think this change happened as “the wall”. We know that it is unlikely to be truly a moment, but for our purposes here we need to define it as a specific day. In the code, this day is called <code>lastDaySample1</code> and the next calendar day becomes <code>firstDaySample2</code> which is computed automatically by the code. What the code does is split our Sample data frame into two non-overlapping data frames: Sample1 and Sample2. Sample1 is all the samples collected before the wall and Sample2 is all the samples collected after it. When we estimate the surfaces object (that describes concentration as a function of time, discharge, and season) that describes the system behavior before the wall we only want to use data from Sample1 and not data from Sample2. And similarly, when we want to estimate the behavior after the wall we only want to use data from Sample2 and not data from Sample1.</p>
<p>All of the workflows described in this document allow the user to specify if they want to use a “wall” and if they do to then specify lastDaySample1. It turns out for programming convenience we actually define a Sample1 and Sample2 whether or not we have a wall. If there is no wall the two data frames are identical to each other and actually identical to the original eList$Sample.</p>
</div>
<div id="flexible-flow-normalization-ffn" class="section level1">
<h1>Flexible Flow Normalization (FFN)</h1>
<p>The idea here is that when we want to flow normalize our Concentration or Flux record we may be concerned that using the entire discharge record for the water quality period of record we are considering, because we believe that the probability distribution of discharge is substantially different over the course this period of record. To put it another way, we use a flow distribution (FD) to integrate the changes in the response surface (RS) and this only makes sense if we believe the FD is approximately stationary over the period of record. This FFN allows us to vary the FD over the period of record, and gives us a chance to see the combined impact of the FD change and the RS change on concentration or flux over the period of record, and also to evaluate the relative influence of the FD change and the RS change on the overall change that has taken place. There are two ways that we might envision this change in the FD taking place: abrupt and gradual.</p>
<div id="abrupt-change" class="section level2">
<h2>Abrupt Change</h2>
<p>This is the situation where there is some singular engineered action that results in a change in the distribution of streamflow. The most obvious examples would be the completion of a dam upstream of the monitoring site. This needs to be a dam that has a rather clear impact on discharges at the monitoring site (e.g. decreasing the peak discharges of high flow or increasing the low flows). Other changes could include: the removal of a dam, the institution of a new operating policy for the dam (e.g. greatly increasing the size of minimum flows to support habitat), or major new diversions of water into or out of the watershed. There is no well-defined criteria for the magnitude of the change that should trigger the use of FFN except to say that it should be big enough that comparisons of flow duration curves before and after it show an easily discernible effect. Having decided that there is an abrupt change in flow, the user must then define an exact day when this change happens. In reality we might not be able to specify the exact date of the change (denoted in the code as <code>lastQDate1</code>), but the modeling approach demands that we pick a single day. In the case of a new dam, it may be better to set this change date after some initial period of reservoir filling, rather than the day the dam construction was done. The new code only allows for a single abrupt change.</p>
</div>
<div id="gradual-change" class="section level2">
<h2>Gradual Change</h2>
<p>This is the typical situation in which the distribution of discharges appears to have changed over the period of record. This might arise because of changes in climate, changes in water use (increased consumptive use or increased groundwater pumping), changes in water imports or exports, or changes in artificial drainage (e.g. more tile drains or the restoration or destruction of wetlands). It may be driven by several of these factors and we don’t really have to understand the causes of these changes for us to use this FFN approach. However, we don’t want to use this approach to deal with natural quasi-periodic climate oscillations that operate on time scales as short as a decade or two. There is no objective test for these changes, it is a matter of judgement whether FFN is appropriate to the case at hand.</p>
<p>There are two ways we might go about characterizing these different FD behaviors. The first is by specifying a moving window for the discharge data. We define the moving window by the parameter called windowSide. For any given year in the middle part of our record the window used to characterize the FD is a set of years centered on the year for which we are making the WRTDS calculations plus windowSide number of years on either side of it. For example if windowSide is equal to 7, and the year being evaluated in WRTDS is 2007, then the whole window runs from 2000 - 2014. When the year being evaluated is close to the start or end of the period of record, then the window will not be centered on the year being evaluated. Rather it will run for a duration of <code>(2 * windowSide) + 1</code> from either the start or end of the record. So, if the year of interest were 2011, and the record ended with 2016, then the period covered would be 2002 - 2016. There are other situations where we might not want to use this approach, but rather define the two periods by some particular date (perhaps for consistency across sites) and this option is available in the software, allowing the user to specify <code>lastQDate1</code> as the last day in the first period.</p>
</div>
</div>
<div id="problem-set-up" class="section level1">
<h1>Problem set up</h1>
<p>here are three distinct types of problem set-ups that are possible in the new formulation and each of them has its own distinct workflow and outputs. They are known as <em>Pairs</em>, <em>Series</em>, and <em>Groups</em>. What do these terms mean here?</p>
<div id="pairs" class="section level2">
<h2>Pairs</h2>
<p>This is the situation where the question is: How do the FFN estimates differ between one specific year and another specific year. These may be the beginning and end of the period of record, or they may be years selected based on an overall study design (a report on water quality change from 1985 - 2015 at many sites). The outputs are a FFN concentration and flux for each of these two years, an apportioning of that change between the RS and FD parts, and a bootstrap estimate of the uncertainty of the change magnitude.</p>
</div>
<div id="series" class="section level2">
<h2>Series</h2>
<p>This is the situation in which we want to produce a graphic that shows the water quality change over time, perhaps showing annual flux, FN flux, and Flexible FN flux. These would be graphs similar to plotConcHist or plotFluxHist. There is also a bootstrap version that would allow for depicting a 90% confidence interval (or some other percential interval) around these annual values.</p>
</div>
<div id="groups" class="section level2">
<h2>Groups</h2>
<p>This is the situation where we might want to answer questions such as: How did the average flow-normalized flux for the period 1997 - 2006 compare to the average flow-normalized flux for the period 2007 - 2016. This approach operates like the Series approach except in this case the emphasis is on the average of some group of years and the uncertainty analysis poses questions like: “What is the likelihood that flux increased from the decade 1997 - 2006 to the decade 2007- 2016?”</p>
</div>
</div>
<div id="other-general-comments" class="section level1">
<h1>Other General Comments</h1>
<p>Note that the idea of the wall and the idea of flexible flow normalization are quite different from each other. The wall deals with some event that suddenly and directly influenced water quality while flexible flow normalization deals with something that influences the probability distribution of discharge. In some cases, the same event could be pivotal to both of these. In particular the completion or removal of a dam, but in most cases they are probably not related to each other, and the time boundaries involved may be quite different. We can have analysis with a wall and not use flexible flow normalization, or we can have flexible flow normalization and not have a wall, or we can have both, or we can have neither. In the latter case only, the original simpler EGRET workflows will provide all of the analyses needed. For any of the others we need to use the WRTDS Flex workflows.</p>
<p>In all of the analyses being introduced here there may be some advantage to having the discharge data set in the Daily data frame extend substantially beyond the period of water quality record being considered. This is in contrast to the guidance given for the standard EGRET application, where we encourage the user to limit the Daily record to being only slightly longer (&lt; 1 year longer) than the extent of the water quality record in the Sample data frame. The user needs to decide how far to take it, but if the windowSide approach is being used, then there is no point in extending the Daily data frame more than windowSide years beyond the range of the Sample data frame.</p>
<p>In all of these problem types, the analysis must start with a standard EGRET eList (containing at least the INFO, Daily, and Sample data frames). In each of the problem types (pairs, series, and group) the functions available include one called “…SetUp” which allows the user to set up their task interactively. It produces an output called “infoFor…RData” which contains the setup information needed by the other two programs. For batch processing, the user can set up an approach to creating this “infoFor…RData”&quot; file in without user interaction (examples will be shown below). There is a function called “run…” that runs the analysis and another called “run…Boot” that does the bootstrap analysis. Both of these produce output files as well as console output. The eList, plus the output files, plus the “infoFor…RData” file provide all the information that will be needed for documentation of the runs, and used as inputs for user-defined functions to produce graphs or tables of output across multiple data sets. To keep these various files organized, it is best to have a single folder devoted to an analysis of a given constituent at a given site.</p>
<p>What follows are a set of instructions for running each of the three types of analyses. (As of January 8, 2018 only the pairs analysis are ready for use).</p>
</div>
<div id="pairs-analysis" class="section level1">
<h1>Pairs analysis</h1>
<p>Many of the general features of <code>EGRET</code> still apply to these flexible flow analyses. For example, use the <code>setPA</code> function to change the period of analysis (by default, the period of analysis is water year). Just as in the original WRTDS analysis (<code>modelEstimation</code>), you can change some parameters such as <code>minNumUncen</code> and <code>minNumObs</code>.</p>
<p>Let’s set up a problem where we want to compare 2 years: 1985 and 2014. We will use all of the Sample data (so no “wall”). We will take advantage of the <code>windowSide</code> argument which will specify a moving window for the discharge data. A typical number for <code>windowSide</code> is 7.</p>
<p>Let’s set up the paired year analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EGRET)
eList &lt;-<span class="st"> </span>Choptank_Phos
year1 &lt;-<span class="st"> </span><span class="dv">1985</span>
year2 &lt;-<span class="st"> </span><span class="dv">2014</span>

pairOut &lt;-<span class="st"> </span><span class="kw">runPairs</span>(eList, year1, year2)</code></pre></div>
<pre><code>## 
##    CHOPTANK RIVER NEAR GREENSBORO, MD 
##    Orthophosphate as P
##    Water Year 
## 
##  Change estimates  2014  minus  1985 
## 
##  For concentration: total change is  0.0217 mg/L
##  expressed as Percent Change is  131 %
##  RS percent of total  92 %,    FD percent of total  8.4 % 
## 
## 
##  For flux: total change is  0.00527 million kg/year
##  expressed as Percent Change is  247 %
##  RS percent of total  60 %,    FD percent of total  40 % 
## 
##       DeltaTotal      RSpart      FDpart         x10         x11
## Conc 0.021733412 0.019915237 0.001818174 0.016995815 0.016621096
## Flux 0.005268323 0.003146884 0.002121439 0.002503698 0.002134729
##              x20         x22
## Conc 0.036911053 0.038354507
## Flux 0.005650582 0.007403052</code></pre>
<p>What we see printed at the bottom of this output is the data frame called <code>pairResults</code> produced from a run of this run of the model. It contains all of the relevant output from the run. There are two rows, the top for concentration (in mg/L) the bottom for flux (in 10^6 kg/yr). The columns have the following meanings.</p>
<p><code>DeltaTotal</code> the difference between <code>year2</code> and <code>year1</code> (combined effect of the change in RS and FD) RSpart the part of DeltaTotal that comes from the change in the RS FDpart the part of DeltaTotal that comes from the change in the FD x10 the average value using RS1 and FD0 x11 the average value using RS1 and FD1 x20 the average value using RS2 and FD0 x22 the average value using RS2 and FD2</p>
<p>RS1 is the response surface estimated for <code>year1</code> (in this case 1985) RS2 is the response surface estimated for <code>year2</code> (in this case 2014) FD0 is the flow distribution based on the span: <code>firstQDate0</code> to <code>lastQDate0</code> FD1 is the flow distribution based on the span: <code>firstQDate1</code> to <code>lastQDate1</code> FD2 is the flow distribution based on the span: <code>firstQDate2</code> to <code>lastQDate2</code></p>
<p>Also note that if you want to report any of these flux values in units of kg/km^2/yr, you can achieve that as follows. We will do it here for the Choptank, which has a drainage area of 292.6687 km^2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multiplier &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1000000</span> <span class="op">/</span><span class="st"> </span>eList<span class="op">$</span>INFO<span class="op">$</span>drainSqKm)

pairResultsKM2 &lt;-<span class="st"> </span>pairOut <span class="op">*</span><span class="st"> </span>multiplier

pairResultsKM2</code></pre></div>
<pre><code>##       DeltaTotal      RSpart      FDpart        x10       x11         x20
## Conc  0.02173341  0.01991524 0.001818174 0.01699582 0.0166211  0.03691105
## Flux 18.00098244 10.75237774 7.248604709 8.55471990 7.2940118 19.30709764
##              x22
## Conc  0.03835451
## Flux 25.29499422</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
