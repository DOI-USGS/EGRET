<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Robert M. Hirsch" />


<title>Trends by month</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Trends by month</h1>
<h4 class="author">Robert M. Hirsch</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette is about producing a single type of figure. It is designed to examine the trends between a pair of years (using <strong>runPairs</strong> in EGRET terminology) to see what the size of the trend is for each of the twelve months of the year. It was used to make Figure 8 in Choquette et al., 2019. It is very helpful in trying to see if the trend is very specific to a certain part of the year (or even opposite in different parts of the year) versus being fairly similar across all the months.</p>
</div>
<div id="how-to-do-it" class="section level2">
<h2>How to do it</h2>
<p>You need two functions. One is called <strong>runPairsMonths.R</strong> to do the computations and the other is called <strong>plotOne.R</strong> which makes the plots. These two functions are included below. You should set up a working directory and then you can copy these functions into your working directory. You be you need an EGRET eList in the directory as well. It should be an eList for which modelEstimation has already been run.</p>
<p>Here is the code</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># This is function called runPairsMonths</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># It is virtually identical to the EGRET function runPairs</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># To learn the meaning of each of these initial arguments</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># The best thing to do is load the EGRET package</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># and then do ?runPairs</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># the help page you will get defines all of these</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>runPairsMonths &lt;-<span class="st"> </span><span class="cf">function</span>(eList, year1, year2, <span class="dt">windowSide =</span> <span class="dv">0</span>, <span class="dt">flowBreak =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>         <span class="dt">Q1EndDate =</span> <span class="ot">NA</span>, <span class="dt">QStartDate =</span> <span class="ot">NA</span>, <span class="dt">QEndDate =</span> <span class="ot">NA</span>, <span class="dt">wall =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>         <span class="dt">oldSurface =</span> <span class="ot">TRUE</span>, <span class="dt">sample1EndDate =</span> <span class="ot">NA</span>, <span class="dt">sampleStartDate =</span> <span class="ot">NA</span>,</span>
<span id="cb1-10"><a href="#cb1-10"></a>         <span class="dt">sampleEndDate =</span> <span class="ot">NA</span>, <span class="dt">minNumObs =</span> <span class="dv">100</span>,</span>
<span id="cb1-11"><a href="#cb1-11"></a>         <span class="dt">minNumUncen =</span> <span class="dv">50</span>, <span class="dt">fractMin =</span> <span class="fl">0.75</span>, <span class="dt">windowY =</span> <span class="dv">7</span>, <span class="dt">windowQ =</span> <span class="dv">2</span>,</span>
<span id="cb1-12"><a href="#cb1-12"></a>         <span class="dt">windowS =</span> <span class="fl">0.5</span>, <span class="dt">edgeAdjust =</span> <span class="ot">TRUE</span>){</span>
<span id="cb1-13"><a href="#cb1-13"></a>paStart &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>paLong &lt;-<span class="st"> </span><span class="dv">12</span> </span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>{</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="cf">if</span> (wall <span class="op">&amp;</span><span class="st"> </span>oldSurface) {</span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="kw">message</span>(<span class="st">&quot;Setting both arguments wall and oldSurfaces to TRUE are not allowed.&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="kw">message</span>(<span class="st">&quot;Re-calculating surface.&quot;</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a>    oldSurface &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  }</span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.egret</span>(eList)) {</span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="kw">stop</span>(<span class="st">&quot;Please check eList argument&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>  }</span>
<span id="cb1-25"><a href="#cb1-25"></a>  localSample &lt;-<span class="st"> </span><span class="kw">getSample</span>(eList)</span>
<span id="cb1-26"><a href="#cb1-26"></a>  startEndSurface1 &lt;-<span class="st"> </span><span class="kw">startEnd</span>(paStart, paLong, year1)</span>
<span id="cb1-27"><a href="#cb1-27"></a>  startEndSurface2 &lt;-<span class="st"> </span><span class="kw">startEnd</span>(paStart, paLong, year2)</span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="cf">if</span> (startEndSurface2<span class="op">$</span>startDate <span class="op">&gt;</span><span class="st"> </span><span class="kw">range</span>(localSample<span class="op">$</span>Date)[<span class="dv">2</span>]) {</span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="kw">stop</span>(<span class="st">&quot;year2 is outside the Sample range&quot;</span>)</span>
<span id="cb1-30"><a href="#cb1-30"></a>  }</span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="cf">if</span> (startEndSurface1<span class="op">$</span>endDate <span class="op">&lt;</span><span class="st"> </span><span class="kw">range</span>(localSample<span class="op">$</span>Date)[<span class="dv">1</span>]) {</span>
<span id="cb1-32"><a href="#cb1-32"></a>    <span class="kw">stop</span>(<span class="st">&quot;year1 is outside the Sample range&quot;</span>)</span>
<span id="cb1-33"><a href="#cb1-33"></a>  }</span>
<span id="cb1-34"><a href="#cb1-34"></a>  sampleStartDate &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.na</span>(sampleStartDate)) </span>
<span id="cb1-35"><a href="#cb1-35"></a>    localSample<span class="op">$</span>Date[<span class="dv">1</span>]</span>
<span id="cb1-36"><a href="#cb1-36"></a>  <span class="cf">else</span> <span class="kw">as.Date</span>(sampleStartDate)</span>
<span id="cb1-37"><a href="#cb1-37"></a>  numSamples &lt;-<span class="st"> </span><span class="kw">length</span>(localSample<span class="op">$</span>Date)</span>
<span id="cb1-38"><a href="#cb1-38"></a>  sampleEndDate &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.na</span>(sampleEndDate)) </span>
<span id="cb1-39"><a href="#cb1-39"></a>    localSample<span class="op">$</span>Date[numSamples]</span>
<span id="cb1-40"><a href="#cb1-40"></a>  <span class="cf">else</span> <span class="kw">as.Date</span>(sampleEndDate)</span>
<span id="cb1-41"><a href="#cb1-41"></a>  localDaily &lt;-<span class="st"> </span><span class="kw">getDaily</span>(eList)</span>
<span id="cb1-42"><a href="#cb1-42"></a>  QStartDate &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.na</span>(QStartDate)) </span>
<span id="cb1-43"><a href="#cb1-43"></a>    localDaily<span class="op">$</span>Date[<span class="dv">1</span>]</span>
<span id="cb1-44"><a href="#cb1-44"></a>  <span class="cf">else</span> <span class="kw">as.Date</span>(QStartDate)</span>
<span id="cb1-45"><a href="#cb1-45"></a>  numQDays &lt;-<span class="st"> </span><span class="kw">length</span>(localDaily<span class="op">$</span>Date)</span>
<span id="cb1-46"><a href="#cb1-46"></a>  QEndDate &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.na</span>(QEndDate)) </span>
<span id="cb1-47"><a href="#cb1-47"></a>    localDaily<span class="op">$</span>Date[numQDays]</span>
<span id="cb1-48"><a href="#cb1-48"></a>  <span class="cf">else</span> <span class="kw">as.Date</span>(QEndDate)</span>
<span id="cb1-49"><a href="#cb1-49"></a>  <span class="cf">if</span> (sampleStartDate <span class="op">&gt;</span><span class="st"> </span><span class="kw">as.Date</span>(startEndSurface1[[<span class="dv">2</span>]])) {</span>
<span id="cb1-50"><a href="#cb1-50"></a>    <span class="kw">stop</span>(<span class="st">&quot;Sample start is later than year2&quot;</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a>  }</span>
<span id="cb1-52"><a href="#cb1-52"></a>  <span class="cf">if</span> (sampleEndDate <span class="op">&lt;</span><span class="st"> </span><span class="kw">as.Date</span>(startEndSurface2[[<span class="dv">1</span>]])) {</span>
<span id="cb1-53"><a href="#cb1-53"></a>    <span class="kw">stop</span>(<span class="st">&quot;Sample end is earlier than year1&quot;</span>)</span>
<span id="cb1-54"><a href="#cb1-54"></a>  }</span>
<span id="cb1-55"><a href="#cb1-55"></a>  localsurfaces &lt;-<span class="st"> </span><span class="kw">getSurfaces</span>(eList)</span>
<span id="cb1-56"><a href="#cb1-56"></a>  <span class="cf">if</span> (oldSurface) {</span>
<span id="cb1-57"><a href="#cb1-57"></a>    <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">is.na</span>(localsurfaces))) {</span>
<span id="cb1-58"><a href="#cb1-58"></a>      <span class="kw">message</span>(<span class="st">&quot;No surface included in eList, running estSurface function&quot;</span>)</span>
<span id="cb1-59"><a href="#cb1-59"></a>      oldSurface &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-60"><a href="#cb1-60"></a>    }</span>
<span id="cb1-61"><a href="#cb1-61"></a>  }</span>
<span id="cb1-62"><a href="#cb1-62"></a>  <span class="cf">if</span> (flowBreak <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.na</span>(Q1EndDate)) </span>
<span id="cb1-63"><a href="#cb1-63"></a>    <span class="kw">stop</span>(<span class="st">&quot;if there is a flowBreak you must provide Q1EndDate&quot;</span>)</span>
<span id="cb1-64"><a href="#cb1-64"></a>  flowNormStartCol &lt;-<span class="st"> &quot;flowNormStart&quot;</span></span>
<span id="cb1-65"><a href="#cb1-65"></a>  flowNormEndCol &lt;-<span class="st"> &quot;flowNormEnd&quot;</span></span>
<span id="cb1-66"><a href="#cb1-66"></a>  flowStartCol &lt;-<span class="st"> &quot;flowStart&quot;</span></span>
<span id="cb1-67"><a href="#cb1-67"></a>  flowEndCol &lt;-<span class="st"> &quot;flowEnd&quot;</span></span>
<span id="cb1-68"><a href="#cb1-68"></a>  <span class="cf">if</span> (windowSide <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span>flowBreak) {</span>
<span id="cb1-69"><a href="#cb1-69"></a>    flowStart &lt;-<span class="st"> </span><span class="kw">c</span>(startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]], startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]])</span>
<span id="cb1-70"><a href="#cb1-70"></a>    flowEnd &lt;-<span class="st"> </span><span class="kw">c</span>(startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]], startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]])</span>
<span id="cb1-71"><a href="#cb1-71"></a>    flowNormStart &lt;-<span class="st"> </span><span class="kw">c</span>(QStartDate, QStartDate)</span>
<span id="cb1-72"><a href="#cb1-72"></a>    flowNormEnd &lt;-<span class="st"> </span><span class="kw">c</span>(QEndDate, QEndDate)</span>
<span id="cb1-73"><a href="#cb1-73"></a>    dateInfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(flowNormStart, flowNormEnd, flowStart, </span>
<span id="cb1-74"><a href="#cb1-74"></a>                           flowEnd, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-75"><a href="#cb1-75"></a>  }</span>
<span id="cb1-76"><a href="#cb1-76"></a>  <span class="cf">else</span> <span class="cf">if</span> (windowSide <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>flowBreak) {</span>
<span id="cb1-77"><a href="#cb1-77"></a>    dateInfo1 &lt;-<span class="st"> </span><span class="kw">makeDateInfo</span>(windowSide, startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-78"><a href="#cb1-78"></a>                              startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]], QStartDate, QEndDate)</span>
<span id="cb1-79"><a href="#cb1-79"></a>    dateInfo2 &lt;-<span class="st"> </span><span class="kw">makeDateInfo</span>(windowSide, startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-80"><a href="#cb1-80"></a>                              startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]], QStartDate, QEndDate)</span>
<span id="cb1-81"><a href="#cb1-81"></a>    dateInfo &lt;-<span class="st"> </span><span class="kw">rbind</span>(dateInfo1, dateInfo2)</span>
<span id="cb1-82"><a href="#cb1-82"></a>  }</span>
<span id="cb1-83"><a href="#cb1-83"></a>  <span class="cf">else</span> <span class="cf">if</span> (windowSide <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>flowBreak) {</span>
<span id="cb1-84"><a href="#cb1-84"></a>    Q1EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(Q1EndDate)</span>
<span id="cb1-85"><a href="#cb1-85"></a>    Q2StartDate &lt;-<span class="st"> </span>Q1EndDate <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-86"><a href="#cb1-86"></a>    flowStart &lt;-<span class="st"> </span><span class="kw">c</span>(startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]], startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]])</span>
<span id="cb1-87"><a href="#cb1-87"></a>    flowEnd &lt;-<span class="st"> </span><span class="kw">c</span>(startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]], startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]])</span>
<span id="cb1-88"><a href="#cb1-88"></a>    flowNormStart &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">as.Date</span>(QStartDate), <span class="kw">as.Date</span>(Q2StartDate))</span>
<span id="cb1-89"><a href="#cb1-89"></a>    flowNormEnd &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">as.Date</span>(Q1EndDate), <span class="kw">as.Date</span>(QEndDate))</span>
<span id="cb1-90"><a href="#cb1-90"></a>    dateInfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(flowNormStart, flowNormEnd, flowStart, </span>
<span id="cb1-91"><a href="#cb1-91"></a>                           flowEnd, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-92"><a href="#cb1-92"></a>  }</span>
<span id="cb1-93"><a href="#cb1-93"></a>  <span class="cf">else</span> {</span>
<span id="cb1-94"><a href="#cb1-94"></a>    Q1EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(Q1EndDate)</span>
<span id="cb1-95"><a href="#cb1-95"></a>    Q2StartDate &lt;-<span class="st"> </span>Q1EndDate <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-96"><a href="#cb1-96"></a>    dateInfo1 &lt;-<span class="st"> </span><span class="kw">makeDateInfo</span>(windowSide, startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-97"><a href="#cb1-97"></a>                              startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]], QStartDate, Q1EndDate)</span>
<span id="cb1-98"><a href="#cb1-98"></a>    dateInfo2 &lt;-<span class="st"> </span><span class="kw">makeDateInfo</span>(windowSide, startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-99"><a href="#cb1-99"></a>                              startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]], Q2StartDate, QEndDate)</span>
<span id="cb1-100"><a href="#cb1-100"></a>    dateInfo &lt;-<span class="st"> </span><span class="kw">rbind</span>(dateInfo1, dateInfo2)</span>
<span id="cb1-101"><a href="#cb1-101"></a>  }</span>
<span id="cb1-102"><a href="#cb1-102"></a>  <span class="cf">if</span> (wall) {</span>
<span id="cb1-103"><a href="#cb1-103"></a>    <span class="cf">if</span> (<span class="kw">is.na</span>(sample1EndDate)) {</span>
<span id="cb1-104"><a href="#cb1-104"></a>      <span class="kw">stop</span>(<span class="st">&quot;When using the wall option, please specify sample1EndDate&quot;</span>)</span>
<span id="cb1-105"><a href="#cb1-105"></a>    }</span>
<span id="cb1-106"><a href="#cb1-106"></a>    sample1EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sample1EndDate)</span>
<span id="cb1-107"><a href="#cb1-107"></a>    sample2StartDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sample1EndDate) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-108"><a href="#cb1-108"></a>    sample1StartDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleStartDate)</span>
<span id="cb1-109"><a href="#cb1-109"></a>    sample2EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleEndDate)</span>
<span id="cb1-110"><a href="#cb1-110"></a>  }</span>
<span id="cb1-111"><a href="#cb1-111"></a>  <span class="cf">else</span> {</span>
<span id="cb1-112"><a href="#cb1-112"></a>    sample1StartDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleStartDate)</span>
<span id="cb1-113"><a href="#cb1-113"></a>    sample2StartDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleStartDate)</span>
<span id="cb1-114"><a href="#cb1-114"></a>    sample1EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleEndDate)</span>
<span id="cb1-115"><a href="#cb1-115"></a>    sample2EndDate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sampleEndDate)</span>
<span id="cb1-116"><a href="#cb1-116"></a>  }</span>
<span id="cb1-117"><a href="#cb1-117"></a>  Sample1 &lt;-<span class="st"> </span>localSample[localSample<span class="op">$</span>Date <span class="op">&gt;=</span><span class="st"> </span>sample1StartDate <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb1-118"><a href="#cb1-118"></a><span class="st">                           </span>localSample<span class="op">$</span>Date <span class="op">&lt;=</span><span class="st"> </span>sample1EndDate, ]</span>
<span id="cb1-119"><a href="#cb1-119"></a>  Sample2 &lt;-<span class="st"> </span>localSample[localSample<span class="op">$</span>Date <span class="op">&gt;=</span><span class="st"> </span>sample2StartDate <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb1-120"><a href="#cb1-120"></a><span class="st">                           </span>localSample<span class="op">$</span>Date <span class="op">&lt;=</span><span class="st"> </span>sample2EndDate, ]</span>
<span id="cb1-121"><a href="#cb1-121"></a>  fractMin &lt;-<span class="st"> </span><span class="kw">min</span>(fractMin, <span class="dv">1</span>)</span>
<span id="cb1-122"><a href="#cb1-122"></a>  minNumObs &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">min</span>(minNumObs, fractMin <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(Sample1<span class="op">$</span>Date), </span>
<span id="cb1-123"><a href="#cb1-123"></a>                           fractMin <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(Sample2<span class="op">$</span>Date)))</span>
<span id="cb1-124"><a href="#cb1-124"></a>  minNumUncen &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">min</span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>minNumObs, minNumUncen))</span>
<span id="cb1-125"><a href="#cb1-125"></a>  <span class="kw">message</span>(<span class="st">&quot;Sample1 has &quot;</span>, <span class="kw">length</span>(Sample1<span class="op">$</span>Date), <span class="st">&quot; Samples and &quot;</span>, </span>
<span id="cb1-126"><a href="#cb1-126"></a>          <span class="kw">sum</span>(Sample1<span class="op">$</span>Uncen), <span class="st">&quot; are uncensored&quot;</span>)</span>
<span id="cb1-127"><a href="#cb1-127"></a>  <span class="kw">message</span>(<span class="st">&quot;Sample2 has &quot;</span>, <span class="kw">length</span>(Sample2<span class="op">$</span>Date), <span class="st">&quot; Samples and &quot;</span>, </span>
<span id="cb1-128"><a href="#cb1-128"></a>          <span class="kw">sum</span>(Sample2<span class="op">$</span>Uncen), <span class="st">&quot; are uncensored&quot;</span>)</span>
<span id="cb1-129"><a href="#cb1-129"></a>  <span class="kw">message</span>(<span class="st">&quot;minNumObs has been set to &quot;</span>, minNumObs, <span class="st">&quot; minNumUncen has been set to &quot;</span>, </span>
<span id="cb1-130"><a href="#cb1-130"></a>          minNumUncen)</span>
<span id="cb1-131"><a href="#cb1-131"></a>  check &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb1-132"><a href="#cb1-132"></a>  <span class="cf">if</span> (minNumObs <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(Sample1<span class="op">$</span>Date)) </span>
<span id="cb1-133"><a href="#cb1-133"></a>    check[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-134"><a href="#cb1-134"></a>  <span class="cf">if</span> (minNumObs <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(Sample2<span class="op">$</span>Date)) </span>
<span id="cb1-135"><a href="#cb1-135"></a>    check[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-136"><a href="#cb1-136"></a>  <span class="cf">if</span> (minNumUncen <span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(Sample1<span class="op">$</span>Uncen)) </span>
<span id="cb1-137"><a href="#cb1-137"></a>    check[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-138"><a href="#cb1-138"></a>  <span class="cf">if</span> (minNumUncen <span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(Sample2<span class="op">$</span>Uncen)) </span>
<span id="cb1-139"><a href="#cb1-139"></a>    check[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-140"><a href="#cb1-140"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(check) <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>) {</span>
<span id="cb1-141"><a href="#cb1-141"></a>    <span class="kw">stop</span>(<span class="st">&quot;Data set too small for minNumObs or minNumUncen&quot;</span>)</span>
<span id="cb1-142"><a href="#cb1-142"></a>  }</span>
<span id="cb1-143"><a href="#cb1-143"></a>  <span class="kw">message</span>(<span class="st">&quot;Sample1 has &quot;</span>, <span class="kw">length</span>(Sample1<span class="op">$</span>Date), <span class="st">&quot; Samples and &quot;</span>, </span>
<span id="cb1-144"><a href="#cb1-144"></a>          <span class="kw">sum</span>(Sample1<span class="op">$</span>Uncen), <span class="st">&quot; are uncensored&quot;</span>)</span>
<span id="cb1-145"><a href="#cb1-145"></a>  <span class="kw">message</span>(<span class="st">&quot;Sample2 has &quot;</span>, <span class="kw">length</span>(Sample2<span class="op">$</span>Date), <span class="st">&quot; Samples and &quot;</span>, </span>
<span id="cb1-146"><a href="#cb1-146"></a>          <span class="kw">sum</span>(Sample2<span class="op">$</span>Uncen), <span class="st">&quot; are uncensored&quot;</span>)</span>
<span id="cb1-147"><a href="#cb1-147"></a>  <span class="kw">message</span>(<span class="st">&quot;minNumObs has been set to &quot;</span>, minNumObs, <span class="st">&quot; minNumUncen has been set to &quot;</span>, </span>
<span id="cb1-148"><a href="#cb1-148"></a>          minNumUncen)</span>
<span id="cb1-149"><a href="#cb1-149"></a>  Daily1 &lt;-<span class="st"> </span>localDaily[localDaily<span class="op">$</span>Date <span class="op">&gt;=</span><span class="st"> </span>dateInfo<span class="op">$</span>flowNormStart[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb1-150"><a href="#cb1-150"></a><span class="st">                         </span>localDaily<span class="op">$</span>Date <span class="op">&lt;=</span><span class="st"> </span>dateInfo<span class="op">$</span>flowNormEnd[<span class="dv">1</span>], ]</span>
<span id="cb1-151"><a href="#cb1-151"></a>  Daily2 &lt;-<span class="st"> </span>localDaily[localDaily<span class="op">$</span>Date <span class="op">&gt;=</span><span class="st"> </span>dateInfo<span class="op">$</span>flowNormStart[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb1-152"><a href="#cb1-152"></a><span class="st">                         </span>localDaily<span class="op">$</span>Date <span class="op">&lt;=</span><span class="st"> </span>dateInfo<span class="op">$</span>flowNormEnd[<span class="dv">2</span>], ]</span>
<span id="cb1-153"><a href="#cb1-153"></a>  <span class="cf">if</span> (oldSurface) {</span>
<span id="cb1-154"><a href="#cb1-154"></a>    <span class="kw">checkSurfaceSpan</span>(eList)</span>
<span id="cb1-155"><a href="#cb1-155"></a>    <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;LogQ&quot;</span>, <span class="st">&quot;surfaceIndex&quot;</span>) <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(<span class="kw">attributes</span>(localsurfaces)))) {</span>
<span id="cb1-156"><a href="#cb1-156"></a>      surfaceYear &lt;-<span class="st"> </span><span class="kw">attr</span>(localsurfaces, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb1-157"><a href="#cb1-157"></a>      LogQ &lt;-<span class="st"> </span><span class="kw">attr</span>(localsurfaces, <span class="st">&quot;LogQ&quot;</span>)</span>
<span id="cb1-158"><a href="#cb1-158"></a>    }</span>
<span id="cb1-159"><a href="#cb1-159"></a>    <span class="cf">else</span> {</span>
<span id="cb1-160"><a href="#cb1-160"></a>      localINFO &lt;-<span class="st"> </span><span class="kw">getInfo</span>(eList)</span>
<span id="cb1-161"><a href="#cb1-161"></a>      LogQ &lt;-<span class="st"> </span><span class="kw">seq</span>(localINFO<span class="op">$</span>bottomLogQ, <span class="dt">by =</span> localINFO<span class="op">$</span>stepLogQ, </span>
<span id="cb1-162"><a href="#cb1-162"></a>                  <span class="dt">length.out =</span> localINFO<span class="op">$</span>nVectorLogQ)</span>
<span id="cb1-163"><a href="#cb1-163"></a>      surfaceYear &lt;-<span class="st"> </span><span class="kw">seq</span>(localINFO<span class="op">$</span>bottomYear, <span class="dt">by =</span> localINFO<span class="op">$</span>stepYear, </span>
<span id="cb1-164"><a href="#cb1-164"></a>                         <span class="dt">length.out =</span> localINFO<span class="op">$</span>nVectorYear)</span>
<span id="cb1-165"><a href="#cb1-165"></a>    }</span>
<span id="cb1-166"><a href="#cb1-166"></a>    startDec1 &lt;-<span class="st"> </span><span class="kw">decimalDate</span>(startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]])</span>
<span id="cb1-167"><a href="#cb1-167"></a>    endDec1 &lt;-<span class="st"> </span><span class="kw">decimalDate</span>(startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]])</span>
<span id="cb1-168"><a href="#cb1-168"></a>    startDec2 &lt;-<span class="st"> </span><span class="kw">decimalDate</span>(startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]])</span>
<span id="cb1-169"><a href="#cb1-169"></a>    endDec2 &lt;-<span class="st"> </span><span class="kw">decimalDate</span>(startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]])</span>
<span id="cb1-170"><a href="#cb1-170"></a>    surfIndex1 &lt;-<span class="st"> </span><span class="kw">which</span>(surfaceYear <span class="op">&gt;=</span><span class="st"> </span>startDec1 <span class="op">&amp;</span><span class="st"> </span>surfaceYear <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-171"><a href="#cb1-171"></a><span class="st">                          </span>endDec1)</span>
<span id="cb1-172"><a href="#cb1-172"></a>    surfIndex1 &lt;-<span class="st"> </span><span class="kw">c</span>(surfIndex1[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, surfIndex1, surfIndex1[<span class="kw">length</span>(surfIndex1)] <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-173"><a href="#cb1-173"></a><span class="st">                      </span><span class="dv">1</span>)</span>
<span id="cb1-174"><a href="#cb1-174"></a>    surfIndex2 &lt;-<span class="st"> </span><span class="kw">which</span>(surfaceYear <span class="op">&gt;=</span><span class="st"> </span>startDec2 <span class="op">&amp;</span><span class="st"> </span>surfaceYear <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-175"><a href="#cb1-175"></a><span class="st">                          </span>endDec2)</span>
<span id="cb1-176"><a href="#cb1-176"></a>    surfIndex2 &lt;-<span class="st"> </span><span class="kw">c</span>(surfIndex2[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, surfIndex2, surfIndex2[<span class="kw">length</span>(surfIndex2)] <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-177"><a href="#cb1-177"></a><span class="st">                      </span><span class="dv">1</span>)</span>
<span id="cb1-178"><a href="#cb1-178"></a>    surfaces1 &lt;-<span class="st"> </span>localsurfaces[, surfIndex1, ]</span>
<span id="cb1-179"><a href="#cb1-179"></a>    surfaces2 &lt;-<span class="st"> </span>localsurfaces[, surfIndex2, ]</span>
<span id="cb1-180"><a href="#cb1-180"></a>    <span class="kw">attr</span>(surfaces1, <span class="st">&quot;LogQ&quot;</span>) &lt;-<span class="st"> </span>LogQ</span>
<span id="cb1-181"><a href="#cb1-181"></a>    <span class="kw">attr</span>(surfaces1, <span class="st">&quot;Year&quot;</span>) &lt;-<span class="st"> </span>surfaceYear[surfIndex1]</span>
<span id="cb1-182"><a href="#cb1-182"></a>    <span class="kw">attr</span>(surfaces2, <span class="st">&quot;LogQ&quot;</span>) &lt;-<span class="st"> </span>LogQ</span>
<span id="cb1-183"><a href="#cb1-183"></a>    <span class="kw">attr</span>(surfaces2, <span class="st">&quot;Year&quot;</span>) &lt;-<span class="st"> </span>surfaceYear[surfIndex2]</span>
<span id="cb1-184"><a href="#cb1-184"></a>  }</span>
<span id="cb1-185"><a href="#cb1-185"></a>  <span class="cf">else</span> {</span>
<span id="cb1-186"><a href="#cb1-186"></a>    surfaces1 &lt;-<span class="st"> </span><span class="kw">estSurfaces</span>(eList, <span class="dt">surfaceStart =</span> startEndSurface1[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-187"><a href="#cb1-187"></a>                             <span class="dt">surfaceEnd =</span> startEndSurface1[[<span class="st">&quot;endDate&quot;</span>]], <span class="dt">localSample =</span> Sample1, </span>
<span id="cb1-188"><a href="#cb1-188"></a>                             <span class="dt">minNumObs =</span> minNumObs, <span class="dt">minNumUncen =</span> minNumUncen, </span>
<span id="cb1-189"><a href="#cb1-189"></a>                             <span class="dt">windowY =</span> windowY, <span class="dt">windowQ =</span> windowQ, <span class="dt">windowS =</span> windowS, </span>
<span id="cb1-190"><a href="#cb1-190"></a>                             <span class="dt">edgeAdjust =</span> edgeAdjust, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-191"><a href="#cb1-191"></a>    surfaces2 &lt;-<span class="st"> </span><span class="kw">estSurfaces</span>(eList, <span class="dt">surfaceStart =</span> startEndSurface2[[<span class="st">&quot;startDate&quot;</span>]], </span>
<span id="cb1-192"><a href="#cb1-192"></a>                             <span class="dt">surfaceEnd =</span> startEndSurface2[[<span class="st">&quot;endDate&quot;</span>]], <span class="dt">localSample =</span> Sample2, </span>
<span id="cb1-193"><a href="#cb1-193"></a>                             <span class="dt">minNumObs =</span> minNumObs, <span class="dt">minNumUncen =</span> minNumUncen, </span>
<span id="cb1-194"><a href="#cb1-194"></a>                             <span class="dt">windowY =</span> windowY, <span class="dt">windowQ =</span> windowQ, <span class="dt">windowS =</span> windowS, </span>
<span id="cb1-195"><a href="#cb1-195"></a>                             <span class="dt">edgeAdjust =</span> edgeAdjust, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-196"><a href="#cb1-196"></a>  }</span>
<span id="cb1-197"><a href="#cb1-197"></a>  DailyRS1FD1 &lt;-<span class="st"> </span><span class="kw">estDailyFromSurfaces</span>(eList, <span class="dt">localsurfaces =</span> surfaces1, </span>
<span id="cb1-198"><a href="#cb1-198"></a>                                      <span class="dt">localDaily =</span> Daily1)</span>
<span id="cb1-199"><a href="#cb1-199"></a>  annualFlex &lt;-<span class="st"> </span><span class="kw">setupYears</span>(DailyRS1FD1, <span class="dt">paLong =</span> paLong, <span class="dt">paStart =</span> paStart)</span>
<span id="cb1-200"><a href="#cb1-200"></a>  c11 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNConc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-201"><a href="#cb1-201"></a>  f11 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNFlux, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-202"><a href="#cb1-202"></a>  DailyRS2FD2 &lt;-<span class="st"> </span><span class="kw">estDailyFromSurfaces</span>(eList, <span class="dt">localsurfaces =</span> surfaces2, </span>
<span id="cb1-203"><a href="#cb1-203"></a>                                      <span class="dt">localDaily =</span> Daily2)</span>
<span id="cb1-204"><a href="#cb1-204"></a>  annualFlex &lt;-<span class="st"> </span><span class="kw">setupYears</span>(DailyRS2FD2, <span class="dt">paLong =</span> paLong, <span class="dt">paStart =</span> paStart)</span>
<span id="cb1-205"><a href="#cb1-205"></a>  c22 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNConc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-206"><a href="#cb1-206"></a>  f22 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNFlux, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-207"><a href="#cb1-207"></a>  Daily0 &lt;-<span class="st"> </span>localDaily[localDaily<span class="op">$</span>Date <span class="op">&gt;=</span><span class="st"> </span>QStartDate <span class="op">&amp;</span><span class="st"> </span>localDaily<span class="op">$</span>Date <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-208"><a href="#cb1-208"></a><span class="st">                         </span>QEndDate, ]</span>
<span id="cb1-209"><a href="#cb1-209"></a>  DailyRS1FD0 &lt;-<span class="st"> </span><span class="kw">estDailyFromSurfaces</span>(eList, <span class="dt">localsurfaces =</span> surfaces1, </span>
<span id="cb1-210"><a href="#cb1-210"></a>                                      <span class="dt">localDaily =</span> Daily0)</span>
<span id="cb1-211"><a href="#cb1-211"></a>  annualFlex &lt;-<span class="st"> </span><span class="kw">setupYears</span>(DailyRS1FD0, <span class="dt">paLong =</span> paLong, <span class="dt">paStart =</span> paStart)</span>
<span id="cb1-212"><a href="#cb1-212"></a>  c10 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNConc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-213"><a href="#cb1-213"></a>  f10 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNFlux, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-214"><a href="#cb1-214"></a>  DailyRS2FD0 &lt;-<span class="st"> </span><span class="kw">estDailyFromSurfaces</span>(eList, <span class="dt">localsurfaces =</span> surfaces2, </span>
<span id="cb1-215"><a href="#cb1-215"></a>                                      <span class="dt">localDaily =</span> Daily0)</span>
<span id="cb1-216"><a href="#cb1-216"></a>  annualFlex &lt;-<span class="st"> </span><span class="kw">setupYears</span>(DailyRS2FD0, <span class="dt">paLong =</span> paLong, <span class="dt">paStart =</span> paStart)</span>
<span id="cb1-217"><a href="#cb1-217"></a>  c20 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNConc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-218"><a href="#cb1-218"></a>  f20 &lt;-<span class="st"> </span><span class="kw">mean</span>(annualFlex<span class="op">$</span>FNFlux, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-219"><a href="#cb1-219"></a>  cDeltaTotal &lt;-<span class="st"> </span>c22 <span class="op">-</span><span class="st"> </span>c11</span>
<span id="cb1-220"><a href="#cb1-220"></a>  cRSpart &lt;-<span class="st"> </span>c20 <span class="op">-</span><span class="st"> </span>c10</span>
<span id="cb1-221"><a href="#cb1-221"></a>  cFDpart &lt;-<span class="st"> </span>cDeltaTotal <span class="op">-</span><span class="st"> </span>cRSpart</span>
<span id="cb1-222"><a href="#cb1-222"></a>  fDeltaTotal &lt;-<span class="st"> </span>f22 <span class="op">-</span><span class="st"> </span>f11</span>
<span id="cb1-223"><a href="#cb1-223"></a>  fRSpart &lt;-<span class="st"> </span>f20 <span class="op">-</span><span class="st"> </span>f10</span>
<span id="cb1-224"><a href="#cb1-224"></a>  fFDpart &lt;-<span class="st"> </span>fDeltaTotal <span class="op">-</span><span class="st"> </span>fRSpart</span>
<span id="cb1-225"><a href="#cb1-225"></a>  totChangePct_conc &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>cDeltaTotal<span class="op">/</span>c11</span>
<span id="cb1-226"><a href="#cb1-226"></a>  totChangePct_flux &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>fDeltaTotal<span class="op">/</span>f11</span>
<span id="cb1-227"><a href="#cb1-227"></a>  CQTC_percent_conc &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>cRSpart<span class="op">/</span>c11</span>
<span id="cb1-228"><a href="#cb1-228"></a>  QTC_percent_conc &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>cFDpart<span class="op">/</span>c11</span>
<span id="cb1-229"><a href="#cb1-229"></a>  CQTC_percent_flux &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>fRSpart<span class="op">/</span>f11</span>
<span id="cb1-230"><a href="#cb1-230"></a>  QTC_percent_flux &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>fFDpart<span class="op">/</span>f11</span>
<span id="cb1-231"><a href="#cb1-231"></a>  pairResults &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">nrow =</span> <span class="dv">2</span>))</span>
<span id="cb1-232"><a href="#cb1-232"></a>  <span class="kw">colnames</span>(pairResults) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TotalChange&quot;</span>, <span class="st">&quot;CQTC&quot;</span>, <span class="st">&quot;QTC&quot;</span>, </span>
<span id="cb1-233"><a href="#cb1-233"></a>                             <span class="st">&quot;x10&quot;</span>, <span class="st">&quot;x11&quot;</span>, <span class="st">&quot;x20&quot;</span>, <span class="st">&quot;x22&quot;</span>)</span>
<span id="cb1-234"><a href="#cb1-234"></a>  <span class="kw">rownames</span>(pairResults) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conc&quot;</span>, <span class="st">&quot;Flux&quot;</span>)</span>
<span id="cb1-235"><a href="#cb1-235"></a>  pairResults[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(cDeltaTotal, cRSpart, cFDpart, c10, </span>
<span id="cb1-236"><a href="#cb1-236"></a>                        c11, c20, c22)</span>
<span id="cb1-237"><a href="#cb1-237"></a>  pairResults[<span class="dv">2</span>, ] &lt;-<span class="st"> </span><span class="fl">0.00036525</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(fDeltaTotal, fRSpart, </span>
<span id="cb1-238"><a href="#cb1-238"></a>                                     fFDpart, f10, f11, f20, f22)</span>
<span id="cb1-239"><a href="#cb1-239"></a>  yearPairInfo &lt;-<span class="st"> </span><span class="kw">c</span>(paStart, paLong, year1, year2)</span>
<span id="cb1-240"><a href="#cb1-240"></a>  <span class="kw">names</span>(yearPairInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;paStart&quot;</span>, <span class="st">&quot;paLong&quot;</span>, <span class="st">&quot;year1&quot;</span>, <span class="st">&quot;year2&quot;</span>)</span>
<span id="cb1-241"><a href="#cb1-241"></a>  <span class="kw">attr</span>(pairResults, <span class="st">&quot;yearPair&quot;</span>) &lt;-<span class="st"> </span>yearPairInfo</span>
<span id="cb1-242"><a href="#cb1-242"></a>  <span class="kw">attr</span>(pairResults, <span class="st">&quot;dateInfo&quot;</span>) &lt;-<span class="st"> </span>dateInfo</span>
<span id="cb1-243"><a href="#cb1-243"></a>  SampleBlocks &lt;-<span class="st"> </span><span class="kw">c</span>(sample1StartDate, sample1EndDate, sample2StartDate, </span>
<span id="cb1-244"><a href="#cb1-244"></a>                    sample2EndDate)</span>
<span id="cb1-245"><a href="#cb1-245"></a>  <span class="kw">names</span>(SampleBlocks) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample1StartDate&quot;</span>, <span class="st">&quot;sample1EndDate&quot;</span>, </span>
<span id="cb1-246"><a href="#cb1-246"></a>                           <span class="st">&quot;sample2StartDate&quot;</span>, <span class="st">&quot;sample2EndDate&quot;</span>)</span>
<span id="cb1-247"><a href="#cb1-247"></a>  <span class="kw">attr</span>(pairResults, <span class="st">&quot;SampleBlocks&quot;</span>) &lt;-<span class="st"> </span>SampleBlocks</span>
<span id="cb1-248"><a href="#cb1-248"></a>  Other &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">minNumObs =</span> minNumObs, <span class="dt">minNumUncen =</span> minNumUncen, </span>
<span id="cb1-249"><a href="#cb1-249"></a>                <span class="dt">windowY =</span> windowY, <span class="dt">windowQ =</span> windowQ, <span class="dt">windowS =</span> windowS, </span>
<span id="cb1-250"><a href="#cb1-250"></a>                <span class="dt">wall =</span> wall, <span class="dt">edgeAdjust =</span> edgeAdjust, <span class="dt">QStartDate =</span> <span class="kw">as.Date</span>(QStartDate), </span>
<span id="cb1-251"><a href="#cb1-251"></a>                <span class="dt">QEndDate =</span> <span class="kw">as.Date</span>(QEndDate), <span class="dt">PercentChangeConc =</span> <span class="kw">c</span>(<span class="st">`</span><span class="dt">Total Percent Change</span><span class="st">`</span> =<span class="st"> </span>totChangePct_conc, </span>
<span id="cb1-252"><a href="#cb1-252"></a>                                                                    <span class="st">`</span><span class="dt">CQTC Percent</span><span class="st">`</span> =<span class="st"> </span>CQTC_percent_conc, <span class="st">`</span><span class="dt">QTC Percent</span><span class="st">`</span> =<span class="st"> </span>QTC_percent_conc), </span>
<span id="cb1-253"><a href="#cb1-253"></a>                <span class="dt">PercentChangeFlux =</span> <span class="kw">c</span>(<span class="st">`</span><span class="dt">Total Percent Change</span><span class="st">`</span> =<span class="st"> </span>totChangePct_flux, </span>
<span id="cb1-254"><a href="#cb1-254"></a>                                      <span class="st">`</span><span class="dt">CQTC Percent</span><span class="st">`</span> =<span class="st"> </span>CQTC_percent_flux, <span class="st">`</span><span class="dt">QTC Percent</span><span class="st">`</span> =<span class="st"> </span>QTC_percent_flux))</span>
<span id="cb1-255"><a href="#cb1-255"></a>  <span class="kw">attr</span>(pairResults, <span class="st">&quot;Other&quot;</span>) &lt;-<span class="st"> </span>Other</span>
<span id="cb1-256"><a href="#cb1-256"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">  &quot;</span>, eList<span class="op">$</span>INFO<span class="op">$</span>shortName, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">  &quot;</span>, eList<span class="op">$</span>INFO<span class="op">$</span>paramShortName)</span>
<span id="cb1-257"><a href="#cb1-257"></a>  periodName &lt;-<span class="st"> </span><span class="kw">setSeasonLabelByUser</span>(paStart, paLong)</span>
<span id="cb1-258"><a href="#cb1-258"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">  &quot;</span>, periodName, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-259"><a href="#cb1-259"></a>  <span class="cf">if</span> (wall) </span>
<span id="cb1-260"><a href="#cb1-260"></a>    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Sample data set was partitioned with a wall right after &quot;</span>, </span>
<span id="cb1-261"><a href="#cb1-261"></a>        <span class="kw">as.character</span>(sample1EndDate), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-262"><a href="#cb1-262"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Change estimates &quot;</span>, year2, <span class="st">&quot; minus &quot;</span>, year1, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-263"><a href="#cb1-263"></a>  totChange &lt;-<span class="st"> </span><span class="kw">format</span>(pairResults[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb1-264"><a href="#cb1-264"></a>  totChangePct_conc_f &lt;-<span class="st"> </span><span class="kw">format</span>(totChangePct_conc, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-265"><a href="#cb1-265"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> For concentration: total change is &quot;</span>, totChange, </span>
<span id="cb1-266"><a href="#cb1-266"></a>      <span class="st">&quot;mg/L&quot;</span>)</span>
<span id="cb1-267"><a href="#cb1-267"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> expressed as Percent Change is &quot;</span>, totChangePct_conc_f, </span>
<span id="cb1-268"><a href="#cb1-268"></a>      <span class="st">&quot;%&quot;</span>)</span>
<span id="cb1-269"><a href="#cb1-269"></a>  pctRS &lt;-<span class="st"> </span><span class="kw">format</span>(CQTC_percent_conc, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-270"><a href="#cb1-270"></a>  pctFD &lt;-<span class="st"> </span><span class="kw">format</span>(QTC_percent_conc, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-271"><a href="#cb1-271"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st"> Concentration v. Q Trend Component &quot;</span>, pctRS, <span class="st">&quot;%</span><span class="ch">\n</span><span class="st">       Q Trend Component            &quot;</span>, </span>
<span id="cb1-272"><a href="#cb1-272"></a>      pctFD, <span class="st">&quot;% </span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-273"><a href="#cb1-273"></a>  totChange &lt;-<span class="st"> </span><span class="kw">format</span>(pairResults[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb1-274"><a href="#cb1-274"></a>  totChangePct_flux_f &lt;-<span class="st"> </span><span class="kw">format</span>((totChangePct_flux), <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-275"><a href="#cb1-275"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> For flux: total change is &quot;</span>, totChange, <span class="st">&quot;million kg/year&quot;</span>)</span>
<span id="cb1-276"><a href="#cb1-276"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> expressed as Percent Change is &quot;</span>, totChangePct_flux_f, </span>
<span id="cb1-277"><a href="#cb1-277"></a>      <span class="st">&quot;%&quot;</span>)</span>
<span id="cb1-278"><a href="#cb1-278"></a>  pctRS &lt;-<span class="st"> </span><span class="kw">format</span>(CQTC_percent_flux, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-279"><a href="#cb1-279"></a>  pctFD &lt;-<span class="st"> </span><span class="kw">format</span>(QTC_percent_flux, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-280"><a href="#cb1-280"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st"> Concentration v. Q Trend Component &quot;</span>, pctRS, <span class="st">&quot;%</span><span class="ch">\n</span><span class="st">       Q Trend Component            &quot;</span>, </span>
<span id="cb1-281"><a href="#cb1-281"></a>      pctFD, <span class="st">&quot;% </span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-282"><a href="#cb1-282"></a>  <span class="kw">print</span>(pairResults[, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-283"><a href="#cb1-283"></a>  z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1-284"><a href="#cb1-284"></a>  <span class="kw">colnames</span>(z) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>,<span class="st">&quot;Feb&quot;</span>,<span class="st">&quot;Mar&quot;</span>,<span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)</span>
<span id="cb1-285"><a href="#cb1-285"></a>  k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="fl">28.25</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>) <span class="op">/</span><span class="st"> </span>eList<span class="op">$</span>INFO<span class="op">$</span>drainSqKm</span>
<span id="cb1-286"><a href="#cb1-286"></a>  eList1 &lt;-<span class="st"> </span><span class="kw">as.egret</span>(eList<span class="op">$</span>INFO, DailyRS1FD1, eList<span class="op">$</span>Sample)</span>
<span id="cb1-287"><a href="#cb1-287"></a>  monthlyResults1 &lt;-<span class="st"> </span><span class="kw">calculateMonthlyResults</span>(eList1)</span>
<span id="cb1-288"><a href="#cb1-288"></a>  monthlyResults1 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(monthlyResults1)</span>
<span id="cb1-289"><a href="#cb1-289"></a>  eList2 &lt;-<span class="st"> </span><span class="kw">as.egret</span>(eList<span class="op">$</span>INFO, DailyRS2FD2, eList<span class="op">$</span>Sample)</span>
<span id="cb1-290"><a href="#cb1-290"></a>  monthlyResults2 &lt;-<span class="st"> </span><span class="kw">calculateMonthlyResults</span>(eList2)</span>
<span id="cb1-291"><a href="#cb1-291"></a>  monthlyResults2 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(monthlyResults2)</span>
<span id="cb1-292"><a href="#cb1-292"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>){</span>
<span id="cb1-293"><a href="#cb1-293"></a>    m1 &lt;-<span class="st"> </span>monthlyResults1[monthlyResults1[,<span class="dv">1</span>]<span class="op">==</span>i,]</span>
<span id="cb1-294"><a href="#cb1-294"></a>    z[<span class="dv">1</span>,i] &lt;-<span class="st"> </span>m1[<span class="dv">1</span>,<span class="dv">8</span>] <span class="op">*</span><span class="st"> </span>k[i]</span>
<span id="cb1-295"><a href="#cb1-295"></a>    m2 &lt;-<span class="st"> </span>monthlyResults2[monthlyResults2[,<span class="dv">1</span>]<span class="op">==</span>i,]</span>
<span id="cb1-296"><a href="#cb1-296"></a>    z[<span class="dv">2</span>,i] &lt;-<span class="st"> </span>m2[<span class="dv">1</span>,<span class="dv">8</span>] <span class="op">*</span><span class="st"> </span>k[i]  </span>
<span id="cb1-297"><a href="#cb1-297"></a>  }</span>
<span id="cb1-298"><a href="#cb1-298"></a>}</span>
<span id="cb1-299"><a href="#cb1-299"></a><span class="kw">return</span>(z)</span>
<span id="cb1-300"><a href="#cb1-300"></a>}</span>
<span id="cb1-301"><a href="#cb1-301"></a><span class="co">#</span></span>
<span id="cb1-302"><a href="#cb1-302"></a><span class="co">#</span></span>
<span id="cb1-303"><a href="#cb1-303"></a><span class="co"># this is written for kg/month/km^2</span></span>
<span id="cb1-304"><a href="#cb1-304"></a><span class="co"># the arguments yMax, arrowFactor, and name can all be</span></span>
<span id="cb1-305"><a href="#cb1-305"></a><span class="co"># adjusted to make some changes in the figure</span></span>
<span id="cb1-306"><a href="#cb1-306"></a>plotOne &lt;-<span class="st"> </span><span class="cf">function</span>(z, <span class="dt">yMax =</span> <span class="ot">NA</span>, <span class="dt">arrowFactor =</span> <span class="fl">0.4</span>, </span>
<span id="cb1-307"><a href="#cb1-307"></a>                    <span class="dt">name =</span> <span class="st">&quot;Change in yield, by month&quot;</span>){</span>
<span id="cb1-308"><a href="#cb1-308"></a>zMax &lt;-<span class="st"> </span><span class="kw">max</span>(z)</span>
<span id="cb1-309"><a href="#cb1-309"></a>yMax &lt;-<span class="st"> </span><span class="cf">if</span>(<span class="kw">is.na</span>(yMax)) zMax <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span> <span class="cf">else</span> yMax</span>
<span id="cb1-310"><a href="#cb1-310"></a>monthAbb &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;J&quot;</span>,<span class="st">&quot;J&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb1-311"><a href="#cb1-311"></a><span class="kw">par</span>(<span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">tck =</span> <span class="fl">0.02</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>)</span>
<span id="cb1-312"><a href="#cb1-312"></a><span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>),z[<span class="dv">1</span>,],<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">12.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, yMax),</span>
<span id="cb1-313"><a href="#cb1-313"></a>      <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Change in yield, kg / month / km^2&quot;</span>,</span>
<span id="cb1-314"><a href="#cb1-314"></a>     <span class="dt">main =</span> name, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">cex.lab =</span> <span class="fl">0.95</span>)</span>
<span id="cb1-315"><a href="#cb1-315"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">12</span>), <span class="dt">labels =</span> monthAbb, <span class="dt">tick =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-316"><a href="#cb1-316"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="ot">NULL</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">tick =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-317"><a href="#cb1-317"></a><span class="kw">axis</span>(<span class="dv">3</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">12</span>), <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">tick =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-318"><a href="#cb1-318"></a><span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">at =</span> <span class="ot">NULL</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">tick =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-319"><a href="#cb1-319"></a><span class="kw">box</span>()</span>
<span id="cb1-320"><a href="#cb1-320"></a><span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-321"><a href="#cb1-321"></a><span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>),z[<span class="dv">2</span>,],<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">12.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, yMax),</span>
<span id="cb1-322"><a href="#cb1-322"></a>     <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1-323"><a href="#cb1-323"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-324"><a href="#cb1-324"></a><span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">12</span>){</span>
<span id="cb1-325"><a href="#cb1-325"></a>  x0 &lt;-<span class="st"> </span>m</span>
<span id="cb1-326"><a href="#cb1-326"></a>  x1 &lt;-<span class="st"> </span>m</span>
<span id="cb1-327"><a href="#cb1-327"></a>  y0 &lt;-<span class="st"> </span>z[<span class="dv">1</span>,m]</span>
<span id="cb1-328"><a href="#cb1-328"></a>  y1 &lt;-<span class="st"> </span>z[<span class="dv">2</span>,m]</span>
<span id="cb1-329"><a href="#cb1-329"></a>  col &lt;-<span class="st"> </span><span class="cf">if</span>(y1 <span class="op">&gt;</span><span class="st"> </span>y0) <span class="st">&quot;red&quot;</span> <span class="cf">else</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb1-330"><a href="#cb1-330"></a>  length &lt;-<span class="st"> </span>arrowFactor <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(y1 <span class="op">-</span><span class="st"> </span>y0) </span>
<span id="cb1-331"><a href="#cb1-331"></a>  angle &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb1-332"><a href="#cb1-332"></a>  lwd &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb1-333"><a href="#cb1-333"></a>  <span class="kw">arrows</span>(x0, y0, x1, y1, <span class="dt">length =</span> length, <span class="dt">angle =</span> angle, <span class="dt">col =</span> col, <span class="dt">lwd =</span> lwd)</span>
<span id="cb1-334"><a href="#cb1-334"></a>}</span>
<span id="cb1-335"><a href="#cb1-335"></a>}</span></code></pre></div>
<p>Now let’s run it</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(EGRET)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">load</span>(<span class="st">&quot;Conowingo.PO4.RData&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># source(&quot;runPairsMonths.R&quot;)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># source(&quot;plotOne.R&quot;)</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>z &lt;-<span class="st"> </span><span class="kw">runPairsMonths</span>(eList, <span class="dt">year1 =</span> <span class="dv">2006</span>, <span class="dt">year2 =</span> <span class="dv">2017</span>)</span></code></pre></div>
<pre><code>## Sample1 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## Sample2 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## minNumObs has been set to 100 minNumUncen has been set to 50</code></pre>
<pre><code>## Sample1 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## Sample2 has 925 Samples and 769 are uncensored</code></pre>
<pre><code>## minNumObs has been set to 100 minNumUncen has been set to 50</code></pre>
<pre><code>## 
##    SUSQUEHANNA RIVER AT CONOWINGO, MD 
##    00671
##    Calendar Year 
## 
##  Change estimates  2017  minus  2006 
## 
##  For concentration: total change is  0.000904 mg/L
##  expressed as Percent Change is  10 %
## 
##  Concentration v. Q Trend Component  10 %
##        Q Trend Component             0 % 
## 
## 
##  For flux: total change is  0.116 million kg/year
##  expressed as Percent Change is  31 %
## 
##  Concentration v. Q Trend Component  31 %
##        Q Trend Component             0 % 
## 
##      TotalChange   CQTC QTC    x10    x11    x20    x22
## Conc      0.0009 0.0009   0 0.0088 0.0088 0.0097 0.0097
## Flux      0.1164 0.1164   0 0.3698 0.3698 0.4862 0.4862</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># z contains the results, they are expressed as yields in kg/month/km^2</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># z[1,1:12] are the yields in year 1, by month Jan, Feb, ... Dec</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># z[2,1:12] are the yields in year 2, by month Jan, Feb, ... Dec</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">print</span>(z)</span></code></pre></div>
<pre><code>##            Jan       Feb       Mar       Apr       May       Jun       Jul
## [1,] 0.6273932 0.4739879 0.7075350 0.6380653 0.3619343 0.2097517 0.1878099
## [2,] 0.8347853 0.4960114 0.8392184 0.7795324 0.3860591 0.2166557 0.2252040
##            Aug       Sep       Oct       Nov       Dec
## [1,] 0.1927015 0.3222020 0.3493139 0.4913913 0.7070998
## [2,] 0.2696814 0.5610262 0.5496506 0.7390136 1.0301296</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">plotOne</span>(z)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">####</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">###we might want to make a few changes in the look of the figure, for example</span></span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">plotOne</span>(z, <span class="dt">yMax =</span> <span class="fl">1.2</span>, <span class="dt">arrowFactor =</span> <span class="fl">0.6</span>, <span class="dt">name =</span> <span class="st">&quot;Change in yield between 2006 and 2017</span><span class="ch">\n</span><span class="st">PO4 at Conowingo&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="reference-cited" class="section level1">
<h1>Reference cited</h1>
<p>Choquette, A.F., Hirsch, R.M., Murphy, J.C., Johnson, L.T. and Confesor Jr, R.B., 2019. Tracking changes in nutrient delivery to western Lake Erie: Approaches to compensate for variability and trends in streamflow. Journal of Great Lakes Research, 45(1), pp.21-39.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
