<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Annual series of flow-normalized concentration and flow-normalzed flux — runSeries • EGRET</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Annual series of flow-normalized concentration and flow-normalzed flux — runSeries" />

<meta property="og:description" content="runSeries provides annual series of flow-normalized concentration and flow-normalzed flux for the water quality record.  
Computations could involve the use of the &quot;wall&quot; and/or use of &quot;generalized flow 
normalization&quot;.  These two concepts are described in detail in the vignette 
[need a simple name for it here]." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRET</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Enhancements.html">Guide to EGRET 3.0 enhancements</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Running WRTDS in parallel</a>
    </li>
    <li>
      <a href="../articles/rResid.html">Using Random Residuals for Censored Data in EGRET</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/EGRET">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Annual series of flow-normalized concentration and flow-normalzed flux</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/EGRET/blob/master/R/runSeries.R'><code>R/runSeries.R</code></a></small>
    <div class="hidden name"><code>runSeries.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>runSeries</code> provides annual series of flow-normalized concentration and flow-normalzed flux for the water quality record.  
Computations could involve the use of the "wall" and/or use of "generalized flow 
normalization".  These two concepts are described in detail in the vignette 
[need a simple name for it here].</p>
    
    </div>

    <pre class="usage"><span class='fu'>runSeries</span>(<span class='no'>eList</span>, <span class='no'>windowSide</span>, <span class='kw'>surfaceStart</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>surfaceEnd</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>flowBreak</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>Q1EndDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>QStartDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>QEndDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>wall</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>oldSurface</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sample1EndDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>sampleStartDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>sampleEndDate</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>paStart</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>paLong</span> <span class='kw'>=</span> <span class='fl'>12</span>, <span class='kw'>fractMin</span> <span class='kw'>=</span> <span class='fl'>0.75</span>, <span class='kw'>minNumObs</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>minNumUncen</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>windowY</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>windowQ</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>windowS</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>edgeAdjust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eList</th>
      <td><p>named list with at least the Daily, Sample, and INFO dataframes</p></td>
    </tr>
    <tr>
      <th>windowSide</th>
      <td><p>integer The width of the flow normalization window on each side of the year being estimated.  A common value is 7, but no default is specified.  If stationary flow normalization is to be used, then windowSide = 0 (this means that flow-normalization period for all years is the same).</p></td>
    </tr>
    <tr>
      <th>surfaceStart</th>
      <td><p>The Date (or character in YYYY-MM-DD) that is the start of the WRTDS model to be estimated and the first of the 
daily outputs to be generated.  Default is NA, which means that the surfaceStart is based on the date of the first sample.</p></td>
    </tr>
    <tr>
      <th>surfaceEnd</th>
      <td><p>The Date (or character in YYYY-MM-DD) that is the end of the WRTDS model to be estimated and the last of the daily outputs 
to be generated.  Default is NA, which means that the surfaceEnd is based on the date of the last sample.</p></td>
    </tr>
    <tr>
      <th>flowBreak</th>
      <td><p>logical, is there an abrupt break in the discharge record, default is FALSE.</p></td>
    </tr>
    <tr>
      <th>Q1EndDate</th>
      <td><p>The Date (as character in YYYY-MM-DD format) which is the last day, just before the flowBreak. Required if flowBreak = TRUE.</p></td>
    </tr>
    <tr>
      <th>QStartDate</th>
      <td><p>The first Date (as character in YYYY-MM-DD format) used in the flow normalization.  Default is NA, which makes the QStartDate become the first Date in eList$Daily.</p></td>
    </tr>
    <tr>
      <th>QEndDate</th>
      <td><p>The last Date (as character in YYYY-MM-DD format) used in the flow normalization.  Default is NA, which makes the QEndDate become the last Date in eList$Daily.</p></td>
    </tr>
    <tr>
      <th>wall</th>
      <td><p>logical, there is an abrupt break in concentration versus discharge relationship.  Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>oldSurface</th>
      <td><p>logical, if TRUE, use surface previously estimated using modelEstimation.  Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>sample1EndDate</th>
      <td><p>The Date (as character in YYYY-MM-DD format) of the last day just before the wall.  Default = NA.  A date must be specified if wall = TRUE.</p></td>
    </tr>
    <tr>
      <th>sampleStartDate</th>
      <td><p>The Date (as character in YYYY-MM-DD format) of the first sample to be used.  Default is NA which sets it to the first Date in eList$Sample.</p></td>
    </tr>
    <tr>
      <th>sampleEndDate</th>
      <td><p>The Date (as character in YYYY-MM-DD format) of the last sample to be used. Default is NA which sets it to the last Date in eList$Sample.</p></td>
    </tr>
    <tr>
      <th>paStart</th>
      <td><p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12, default is 10 (used when period is water year).</p></td>
    </tr>
    <tr>
      <th>paLong</th>
      <td><p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12, default is 12.</p></td>
    </tr>
    <tr>
      <th>fractMin</th>
      <td><p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p></td>
    </tr>
    <tr>
      <th>minNumObs</th>
      <td><p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p></td>
    </tr>
    <tr>
      <th>minNumUncen</th>
      <td><p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p></td>
    </tr>
    <tr>
      <th>windowY</th>
      <td><p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p></td>
    </tr>
    <tr>
      <th>windowQ</th>
      <td><p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p></td>
    </tr>
    <tr>
      <th>windowS</th>
      <td><p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p></td>
    </tr>
    <tr>
      <th>edgeAdjust</th>
      <td><p>logical specifying whether to use the modified method for calculating the windows at the edge of the record. The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical specifying whether to output status messages.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>eList named list with INFO, Daily, and Sample dataframes, along with the surfaces matrix.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>eList</span> <span class='kw'>&lt;-</span> <span class='no'>Choptank_eList</span></div><span class='co'># NOT RUN {</span>
<span class='co'># Automatic calculations based on windowSide=7</span>
<span class='co'># four possible ways to do generalized flow normalization</span>

<span class='co'>#Option 1:  Use all years for flow normalization.</span>
<span class='no'>seriesOut_1</span> <span class='kw'>&lt;-</span> <span class='fu'>runSeries</span>(<span class='no'>eList</span>,  <span class='kw'>windowSide</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='fu'><a href='plotConcHist.html'>plotConcHist</a></span>(<span class='no'>seriesOut_1</span>)
<span class='fu'><a href='plotFluxHist.html'>plotFluxHist</a></span>(<span class='no'>seriesOut_1</span>)

<span class='co'># Option 2: Use sliding window throughout the whole flow normalization process.</span>
<span class='co'>#                In each case it is a 15 year window (15 = 1 + 2*7)</span>
<span class='no'>seriesOut_2</span> <span class='kw'>&lt;-</span> <span class='fu'>runSeries</span>(<span class='no'>eList</span>, <span class='kw'>windowSide</span> <span class='kw'>=</span> <span class='fl'>7</span>)

<span class='fu'><a href='plotConcHist.html'>plotConcHist</a></span>(<span class='no'>seriesOut_2</span>)
<span class='fu'><a href='plotFluxHist.html'>plotFluxHist</a></span>(<span class='no'>seriesOut_2</span>)

<span class='co'># Option 3: Flow normalization is based on splitting the flow record at 1990-09-30</span>
<span class='co'>#                But in years before the break it uses all flow data from before the break, </span>
<span class='co'>#                and years after the break uses all flow data after the break</span>
<span class='no'>seriesOut_3</span> <span class='kw'>&lt;-</span> <span class='fu'>runSeries</span>(<span class='no'>eList</span>,
                       <span class='kw'>windowSide</span> <span class='kw'>=</span> <span class='fl'>0</span>,
                       <span class='kw'>flowBreak</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                       <span class='kw'>Q1EndDate</span> <span class='kw'>=</span> <span class='st'>"1990-09-30"</span>)

<span class='fu'><a href='plotConcHist.html'>plotConcHist</a></span>(<span class='no'>seriesOut_3</span>)
<span class='fu'><a href='plotFluxHist.html'>plotFluxHist</a></span>(<span class='no'>seriesOut_3</span>)

<span class='co'># Option 4: Flow normalization is based on splitting the flow record at 1990-09-30</span>
<span class='co'>#                but before the break uses a 15 year window of years before the break</span>
<span class='co'>#                after the break uses a 15 year window of years after the break</span>
<span class='no'>seriesOut_4</span> <span class='kw'>&lt;-</span> <span class='fu'>runSeries</span>(<span class='no'>eList</span>,
                      <span class='kw'>windowSide</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>flowBreak</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                      <span class='kw'>Q1EndDate</span> <span class='kw'>=</span> <span class='st'>"1990-09-30"</span>)

<span class='fu'><a href='plotConcHist.html'>plotConcHist</a></span>(<span class='no'>seriesOut_4</span>)
<span class='fu'><a href='plotFluxHist.html'>plotFluxHist</a></span>(<span class='no'>seriesOut_4</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Robert Hirsch, Laura DeCicco.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

